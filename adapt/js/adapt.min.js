function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _readOnlyError(name){throw new Error("\""+name+"\" is read-only")}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _newArrowCheck(innerThis,boundThis){if(innerThis!==boundThis){throw new TypeError("Cannot instantiate an arrow function")}}define("core/js/wait",[],function(){var Wait=Backbone.Controller.extend({initialize:function initialize(){_.bindAll(this,"begin","end")},_waitCount:0,_callbackHandle:null,_timeoutHandlerId:null,_timeoutInSeconds:7,isWaiting:function isWaiting(){return this._waitCount!==0},startTimer:function startTimer(){this.stopTimer();this._timeoutHandlerId=setInterval(function(){while(this._waitCount>0){this.end()}if(this._waitCount===0){this.stopTimer()}}.bind(this),this._timeoutInSeconds*1000)},stopTimer:function stopTimer(){if(this._timeoutHandlerId){clearInterval(this._timeoutHandlerId)}},begin:function begin(){if(!this.isWaiting()){this.trigger("wait")}this._waitCount++;if(this._callbackHandle){clearTimeout(this._callbackHandle);this._callbackHandle=null}this.startTimer();return this},end:function end(){if(!this.isWaiting()){return this}this._waitCount--;if(this._waitCount===0){this.stopTimer()}if(this.isWaiting()){return this}if(this._callbackHandle){return this}this._callbackHandle=setTimeout(function(){this._callbackHandle=null;this.trigger("ready")}.bind(this),0);return this},queue:function queue(callback){var _this=this;if(!callback){this.begin();return new Promise(function(resolve){_newArrowCheck(this,_this);this.once("ready",resolve);this.end()}.bind(this))}this.begin();this.once("ready",callback);this.end();return this},for:function _for(callback){this.begin();_.defer(function(){callback(_.once(this.end))}.bind(this));return this}});return Wait});define("core/js/models/lockingModel",[],function(){var _set=Backbone.Model.prototype.set;Object.assign(Backbone.Model.prototype,{set:function set(attrName,attrVal){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var stopProcessing=_typeof(attrName)==="object"||typeof attrVal!=="boolean"||!this.isLocking(attrName);if(stopProcessing)return _set.apply(this,arguments);var isSettingValueForSpecificPlugin=options&&options.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to change a locked attribute");options.pluginName="compatibility"}var pluginName=options.pluginName;if(this.defaults[attrName]!==undefined){this._lockedAttributes[attrName]=!this.defaults[attrName]}var lockingValue=this._lockedAttributes[attrName];var isAttemptingToLock=lockingValue===attrVal;if(isAttemptingToLock){this.setLockState(attrName,true,{pluginName:pluginName,skipcheck:true});return _set.call(this,attrName,lockingValue)}this.setLockState(attrName,false,{pluginName:pluginName,skipcheck:true});var totalLockValue=this.getLockCount(attrName,{skipcheck:true});if(totalLockValue===0){return _set.call(this,attrName,!lockingValue)}return this},setLocking:function setLocking(attrName,defaultLockValue){if(this.isLocking(attrName))return;if(!this._lockedAttributes)this._lockedAttributes={};this._lockedAttributes[attrName]=defaultLockValue},unsetLocking:function unsetLocking(attrName){if(!this.isLocking(attrName))return;if(!this._lockedAttributes)return;delete this._lockedAttributes[attrName];delete this._lockedAttributesValues[attrName];if(Object.keys(this._lockedAttributes).length===0){delete this._lockedAttributes;delete this._lockedAttributesValues}},isLocking:function isLocking(attrName){var isCheckingGeneralLockingState=attrName===undefined;var isUsingLockedAttributes=Boolean(this.lockedAttributes||this._lockedAttributes);if(isCheckingGeneralLockingState){return isUsingLockedAttributes}if(!isUsingLockedAttributes)return false;if(!this._lockedAttributes){this._lockedAttributes=_.result(this,"lockedAttributes")}var isAttributeALockingAttribute=this._lockedAttributes.hasOwnProperty(attrName);if(!isAttributeALockingAttribute)return false;if(!this._lockedAttributesValues){this._lockedAttributesValues={}}if(!this._lockedAttributesValues[attrName]){this._lockedAttributesValues[attrName]={}}return true},isLocked:function isLocked(attrName,options){var shouldSkipCheck=options&&options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}return this.getLockCount(attrName)>0},getLockCount:function getLockCount(attrName,options){var _this2=this;var shouldSkipCheck=options&&options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}var isGettingValueForSpecificPlugin=options&&options.pluginName;if(isGettingValueForSpecificPlugin){return this._lockedAttributesValues[attrName][options.pluginName]?1:0}var lockingAttributeValues=Object.values(this._lockedAttributesValues[attrName]);var lockingAttributeValuesSum=lockingAttributeValues.reduce(function(sum,value){_newArrowCheck(this,_this2);return sum+(value?1:0)}.bind(this),0);return lockingAttributeValuesSum},setLockState:function setLockState(attrName,value,options){var shouldSkipCheck=options&&options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return this}var isSettingValueForSpecificPlugin=options&&options.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to set a locked attribute lock value");options.pluginName="compatibility"}if(value){this._lockedAttributesValues[attrName][options.pluginName]=value}else{delete this._lockedAttributesValues[attrName][options.pluginName]}return this}})});define("core/js/adapt",["core/js/wait","core/js/models/lockingModel"],function(Wait){var Adapt=function(_Backbone$Model){"use strict";_inherits(Adapt,_Backbone$Model);var _super=_createSuper(Adapt);function Adapt(){_classCallCheck(this,Adapt);return _super.apply(this,arguments)}_createClass(Adapt,[{key:"initialize",value:function initialize(){this.loadScript=window.__loadScript;this.location={};this.store={};this.setupWait()}},{key:"defaults",value:function defaults(){return{_canScroll:true,_outstandingCompletionChecks:0,_pluginWaitCount:0,_isStarted:false,_shouldDestroyContentObjects:true}}},{key:"lockedAttributes",value:function lockedAttributes(){return{_canScroll:false}}},{key:"init",value:function init(){var _this3=this;this.addDirection();this.disableAnimation();this.trigger("adapt:preInitialize");this.deferUntilCompletionChecked(function(){_newArrowCheck(this,_this3);this.trigger("adapt:start");if(!Backbone.History.started){Backbone.history.start()}this.set("_isStarted",true);this.trigger("adapt:initialize")}.bind(this))}},{key:"checkingCompletion",value:function checkingCompletion(){var outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks+1)}},{key:"checkedCompletion",value:function checkedCompletion(){var outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks-1)}},{key:"deferUntilCompletionChecked",value:function deferUntilCompletionChecked(callback){var _this4=this;if(this.get("_outstandingCompletionChecks")===0)return callback();var _checkIfAnyChecksOutstanding=function checkIfAnyChecksOutstanding(model,outstandingChecks){_newArrowCheck(this,_this4);if(outstandingChecks!==0)return;this.off("change:_outstandingCompletionChecks",_checkIfAnyChecksOutstanding);callback()}.bind(this);this.on("change:_outstandingCompletionChecks",_checkIfAnyChecksOutstanding)}},{key:"setupWait",value:function setupWait(){var _this5=this;this.wait=new Wait;var beginWait=function beginWait(){_newArrowCheck(this,_this5);this.log.deprecated("Use Adapt.wait.begin() as Adapt.trigger('plugin:beginWait') may be removed in the future");this.wait.begin()}.bind(this);var endWait=function endWait(){_newArrowCheck(this,_this5);this.log.deprecated("Use Adapt.wait.end() as Adapt.trigger('plugin:endWait') may be removed in the future");this.wait.end()}.bind(this);var ready=function ready(){_newArrowCheck(this,_this5);if(this.wait.isWaiting()){return}var isEventListening=this._events["plugins:ready"];if(!isEventListening){return}this.log.deprecated("Use Adapt.wait.queue(callback) as Adapt.on('plugins:ready', callback) may be removed in the future");this.trigger("plugins:ready")}.bind(this);this.listenTo(this.wait,"ready",ready);this.listenTo(this,{"plugin:beginWait":beginWait,"plugin:endWait":endWait})}},{key:"isWaitingForPlugins",value:function isWaitingForPlugins(){this.log.deprecated("Use Adapt.wait.isWaiting() as Adapt.isWaitingForPlugins() may be removed in the future");return this.wait.isWaiting()}},{key:"checkPluginsReady",value:function checkPluginsReady(){this.log.deprecated("Use Adapt.wait.isWaiting() as Adapt.checkPluginsReady() may be removed in the future");if(this.isWaitingForPlugins()){return}this.trigger("plugins:ready")}},{key:"navigateToElement",value:function navigateToElement(){}},{key:"scrollTo",value:function scrollTo(){}},{key:"register",value:function register(name,object){var _this6=this;if(Array.isArray(name)){name.forEach(function(name){_newArrowCheck(this,_this6);return this.register(name,object)}.bind(this));return object}if(name.split(" ").length>1){this.register(name.split(" "),object);return object}if(!object.view&&!object.model||object instanceof Backbone.View){this.log&&this.log.deprecated("View-only registrations are no longer supported");object={view:object}}if(object.view&&!object.view.template){object.view.template=name}var isModelSetAndInvalid=object.model&&!(object.model.prototype instanceof Backbone.Model)&&!(object.model instanceof Function);if(isModelSetAndInvalid){throw new Error("The registered model is not a Backbone.Model or Function")}var isViewSetAndInvalid=object.view&&!(object.view.prototype instanceof Backbone.View)&&!(object.view instanceof Function);if(isViewSetAndInvalid){throw new Error("The registered view is not a Backbone.View or Function")}this.store[name]=Object.assign({},this.store[name],object);return object}},{key:"getViewName",value:function getViewName(nameModelViewOrData){var _this7=this;if(typeof nameModelViewOrData==="string"){return nameModelViewOrData}if(nameModelViewOrData instanceof Backbone.Model){nameModelViewOrData=nameModelViewOrData.toJSON()}if(nameModelViewOrData instanceof Backbone.View){var foundName;_.find(this.store,function(entry,name){_newArrowCheck(this,_this7);if(!entry||!entry.view)return;if(!(nameModelViewOrData instanceof entry.view))return;foundName=name;return true}.bind(this));return foundName}if(nameModelViewOrData instanceof Object){var names=[typeof nameModelViewOrData._view==="string"&&nameModelViewOrData._view,typeof nameModelViewOrData._component==="string"&&nameModelViewOrData._component,typeof nameModelViewOrData._type==="string"&&nameModelViewOrData._type].filter(Boolean);if(names.length){var name=names.find(function(name){_newArrowCheck(this,_this7);return this.store[name]&&this.store[name].view}.bind(this));return name||names.pop()}}throw new Error("Cannot derive view class name from input")}},{key:"getViewClass",value:function getViewClass(nameModelViewOrData){var name=this.getViewName(nameModelViewOrData);var object=this.store[name];if(!object){this.log.warnOnce("A view for '".concat(name,"' isn't registered in your project"));return}var isBackboneView=object.view&&object.view.prototype instanceof Backbone.View;if(!isBackboneView&&object.view instanceof Function){return object.view()}return object.view}},{key:"getModelName",value:function getModelName(nameModelOrData){var _this8=this;if(typeof nameModelOrData==="string"){return nameModelOrData}if(nameModelOrData instanceof Backbone.Model){nameModelOrData=nameModelOrData.toJSON()}if(nameModelOrData instanceof Object){var names=[typeof nameModelOrData._model==="string"&&nameModelOrData._model,typeof nameModelOrData._component==="string"&&nameModelOrData._component,typeof nameModelOrData._type==="string"&&nameModelOrData._type].filter(Boolean);if(names.length){var name=names.find(function(name){_newArrowCheck(this,_this8);return this.store[name]&&this.store[name].model}.bind(this));return name||names.pop()}}throw new Error("Cannot derive model class name from input")}},{key:"getModelClass",value:function getModelClass(nameModelOrData){var name=this.getModelName(nameModelOrData);var object=this.store[name];if(!object){this.log.warnOnce("A model for '".concat(name,"' isn't registered in your project"));return}var isBackboneModel=object.model&&object.model.prototype instanceof Backbone.Model;if(!isBackboneModel&&object.model instanceof Function){return object.model()}return object.model}},{key:"mapById",value:function mapById(id){return this.data.mapById(id)}},{key:"findById",value:function findById(id){return this.data.findById(id)}},{key:"findViewByModelId",value:function findViewByModelId(id){var _this9=this;var model=this.data.findById(id);if(!model)return;if(model===this.parentView.model)return this.parentView;var idPathToView=[id];var currentLocationId=this.location._currentId;var currentLocationModel=model.getAncestorModels().find(function(model){_newArrowCheck(this,_this9);var modelId=model.get("_id");if(modelId===currentLocationId)return true;idPathToView.unshift(modelId)}.bind(this));if(!currentLocationModel){return console.warn("Adapt.findViewByModelId() unable to find view for model id: ".concat(id))}var foundView=idPathToView.reduce(function(view,currentId){_newArrowCheck(this,_this9);return view&&view.childViews&&view.childViews[currentId]}.bind(this),this.parentView);return foundView}},{key:"parseRelativeString",value:function parseRelativeString(relativeString){var splitIndex=relativeString.search(/[ +\-\d]{1}/);var type=relativeString.slice(0,splitIndex).replace(/^@/,"");var offset=parseInt(relativeString.slice(splitIndex).trim()||0);return{type:type,offset:offset}}},{key:"addDirection",value:function addDirection(){var defaultDirection=this.config.get("_defaultDirection");$("html").addClass("dir-"+defaultDirection).attr("dir",defaultDirection)}},{key:"disableAnimation",value:function disableAnimation(){var disableAnimationArray=this.config.get("_disableAnimationFor");var disableAnimation=this.config.get("_disableAnimation");if(disableAnimationArray){for(var _i=0,l=disableAnimationArray.length;_i<l;_i++){if(!$("html").is(disableAnimationArray[_i]))continue;this.config.set("_disableAnimation",true);$("html").addClass("disable-animation");console.log("Animation disabled.")}return}$("html").toggleClass("disable-animation",disableAnimation===true)}},{key:"remove",value:function(){var _remove=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var currentView;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:currentView=this.parentView;if(currentView){currentView.model.setOnChildren("_isReady",false);currentView.model.set("_isReady",false)}this.trigger("preRemove",currentView);_context.next=5;return this.wait.queue();case 5:if(currentView&&this.get("_shouldDestroyContentObjects")){currentView.destroy()}this.trigger("remove",currentView);_.defer(this.trigger.bind(this),"postRemove",currentView);case 8:case"end":return _context.stop();}}},_callee,this)}));function remove(){return _remove.apply(this,arguments)}return remove}()},{key:"componentStore",get:function get(){this.log&&this.log.deprecated("Adapt.componentStore, please use Adapt.store instead");return this.store}}]);return Adapt}(Backbone.Model);return new Adapt});define("core/js/templateRenderEvent",[],function(){var TemplateRenderEvent=function(_Backbone$Controller){"use strict";_inherits(TemplateRenderEvent,_Backbone$Controller);var _super2=_createSuper(TemplateRenderEvent);function TemplateRenderEvent(){_classCallCheck(this,TemplateRenderEvent);return _super2.apply(this,arguments)}_createClass(TemplateRenderEvent,[{key:"initialize",value:function initialize(type,name,mode,value,args){this.type=type;this.name=name;this.mode=mode;this.value=value;this.args=args}}]);return TemplateRenderEvent}(Backbone.Controller);return TemplateRenderEvent});define("core/js/templates",["core/js/adapt","handlebars","./templateRenderEvent"],function(Adapt,Handlebars,TemplateRenderEvent){function onRender(cb){var _this10=this;var intercept=function intercept(object,name,mode,cb){_newArrowCheck(this,_this10);return object[name]=cb.bind(object,object[name],name,mode)}.bind(this);Object.keys(Handlebars.templates).forEach(function(name){_newArrowCheck(this,_this10);intercept(Handlebars.templates,name,"template",cb)}.bind(this));Object.keys(Handlebars.partials).forEach(function(name){_newArrowCheck(this,_this10);intercept(Handlebars.partials,name,"partial",cb)}.bind(this))}onRender(function(template,name,mode){for(var _len=arguments.length,args=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){args[_key-3]=arguments[_key]}var preRenderEvent=new TemplateRenderEvent("".concat(mode,":preRender"),name,mode,null,args);Adapt.trigger(preRenderEvent.type,preRenderEvent);var value=template.apply(void 0,_toConsumableArray(preRenderEvent.args));var postRenderEvent=new TemplateRenderEvent("".concat(mode,":postRender"),name,mode,value,preRenderEvent.args);Adapt.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value})});define("core/js/fixes/img.lazyload",["core/js/adapt","../templates"],function(Adapt){Adapt.on("app:dataReady",function(){var config=Adapt.config.get("_fixes");if(config&&config._imgLazyLoad===false)return;applyImgLoadingFix()});function applyImgLoadingFix(){var findImgTag=/<img([^>]*)>/gi;var hasLoadingAttr=/ loading=/gi;Adapt.on("template:postRender partial:postRender",function(event){var _this11=this;var imgTagsFound=event.value.match(findImgTag);if(!imgTagsFound){return}event.value=imgTagsFound.reduce(function(value,img){_newArrowCheck(this,_this11);if(hasLoadingAttr.test(img)){return value}return value.replace(img,img.replace(findImgTag,"<img loading=\"eager\"$1>"))}.bind(this),event.value)})}});define("core/js/fixes",["./fixes/img.lazyload"],function(){});define("core/js/a11y/browserFocus",["core/js/adapt"],function(Adapt){var BrowserFocus=Backbone.Controller.extend({initialize:function initialize(){_.bindAll(this,"_onBlur","_onClick");this.$body=$("body");this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})},_attachEventListeners:function _attachEventListeners(){this.$body.on("blur","*",this._onBlur).on("blur",this._onBlur);this.$body[0].addEventListener("click",this._onClick,true)},_onBlur:function _onBlur(event){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isFocusNextOnDisabled){return}var $element=$(event.target);if($element.is("[data-a11y-force-focus]")){_.defer(function(){$element.removeAttr("tabindex data-a11y-force-focus")})}if(event.target!==event.currentTarget){return}if(!$element.is("[disabled]")){return}Adapt.a11y.focusNext($element)},_onClick:function _onClick(event){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isFocusOnClickEnabled){return}var $element=$(event.target);var $stack=$().add($element).add($element.parents());var $focusable=$stack.filter(config._options._tabbableElements);if(!$focusable.length){return}$focusable[0].focus()}});return BrowserFocus});define("core/js/a11y/focusOptions",[],function(){var FocusOptions=function FocusOptions(options){_.defaults(this,options,{preventScroll:true,defer:false})};return FocusOptions});define("core/js/a11y/keyboardFocusOutline",["core/js/adapt"],function(Adapt){var KeyboardFocusOutline=Backbone.Controller.extend({initialize:function initialize(){_.bindAll(this,"_onKeyDown");this.$html=$("html");this.showOnKeys={9:true,13:true,32:true,37:true,38:true,39:true,40:true};this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})},_attachEventListeners:function _attachEventListeners(){document.addEventListener("keydown",this._onKeyDown);this._start()},_start:function _start(){var config=Adapt.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled){return}this.$html.addClass("a11y-disable-focusoutline")},_onKeyDown:function _onKeyDown(event){var config=Adapt.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled||!this.showOnKeys[event.keyCode]){return}var $element=$(event.target);if(!$element.is(config._options._tabbableElements)||$element.is(config._options._focusOutlineKeyboardOnlyIgnore)){return}this.$html.removeClass("a11y-disable-focusoutline")}});return KeyboardFocusOutline});define("core/js/a11y/log",["core/js/adapt"],function(Adapt){var Log=function(_Backbone$Controller2){"use strict";_inherits(Log,_Backbone$Controller2);var _super3=_createSuper(Log);function Log(){_classCallCheck(this,Log);return _super3.apply(this,arguments)}_createClass(Log,[{key:"initialize",value:function initialize(){this._warned={}}},{key:"_hasWarned",value:function _hasWarned(args){var config=Adapt.a11y.config;if(!config._options._warnFirstOnly){return false}var hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}},{key:"_canWarn",value:function _canWarn(){var config=Adapt.a11y.config;return Boolean(config._options._warn)}},{key:"removed",value:function removed(){var _Adapt$log;for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}(_Adapt$log=Adapt.log).removed.apply(_Adapt$log,_toConsumableArray(args));return this}},{key:"deprecated",value:function deprecated(){var _Adapt$log2;for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}(_Adapt$log2=Adapt.log).deprecated.apply(_Adapt$log2,_toConsumableArray(args));return this}}]);return Log}(Backbone.Controller);return Log});define("core/js/a11y/scroll",[],function(){var Scroll=Backbone.Controller.extend({initialize:function initialize(){_.bindAll(this,"_onTouchStart","_onTouchEnd","_onScrollEvent","_onKeyDown");this._scrollDisabledElements=$([]);this.$window=$(window);this.$body=$("body");this._preventScrollOnKeys={37:true,38:true,39:true,40:true};this._ignoreKeysOnElementsMatching="textarea, input, select";this._isRunning=false;this._touchStartEventObject=null},disable:function disable($elements){$elements=$($elements);this._scrollDisabledElements=this._scrollDisabledElements.add($elements);this._checkRunning();return this},enable:function enable($elements){$elements=$($elements);if(!$elements||!$elements.length){this.clear();return this}this._scrollDisabledElements=this._scrollDisabledElements.not($elements);this._checkRunning();return this},clear:function clear(){this._scrollDisabledElements=$([]);this._checkRunning();return this},_checkRunning:function _checkRunning(){if(!this._scrollDisabledElements.length){this._stop();return}this._start()},_start:function _start(){if(this._isRunning){return}this._isRunning=true;window.addEventListener("touchstart",this._onTouchStart);window.addEventListener("touchend",this._onTouchEnd);window.addEventListener("touchmove",this._onScrollEvent,{passive:false});window.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("keydown",this._onKeyDown)},_onTouchStart:function _onTouchStart(event){event=$.event.fix(event);this._touchStartEventObject=event;return true},_onTouchEnd:function _onTouchEnd(){this._touchStartEventObject=null;return true},_onScrollEvent:function _onScrollEvent(event){event=$.event.fix(event);return this._preventScroll(event)},_onKeyDown:function _onKeyDown(event){event=$.event.fix(event);if(!this._preventScrollOnKeys[event.keyCode]){return}var $target=$(event.target);if($target.is(this._ignoreKeysOnElementsMatching)){return}return this._preventScroll(event)},_preventScroll:function _preventScroll(event){var isGesture=event.touches&&event.touches.length>1;if(isGesture){return}var $target=$(event.target);if(this._scrollDisabledElements.length){var scrollingParent=this._getScrollingParent(event,$target);if(scrollingParent.filter(this._scrollDisabledElements).length===0){this.$window.scroll();return}}event.preventDefault();return false},_getScrollingParent:function _getScrollingParent(event,$target){var isTouchEvent=event.type==="touchmove";var hasTouchStartEvent=this._touchStartEventObject&&this._touchStartEventObject.originalEvent;if(isTouchEvent&&!hasTouchStartEvent){return $target}var directionY=this._getScrollDirection(event);if(directionY==="none"){return this.$body}var parents=$target.parents();for(var i=0,l=parents.length;i<l;i++){var $parent=$(parents[i]);if($parent.is("body")){return this.$body}if(!this._isScrollable($parent)){continue}if(!this._isScrolling($parent,directionY)){continue}return $parent}return this.$body},_isScrollable:function _isScrollable($target){var scrollType=$target.css("overflow-y");if(scrollType!=="auto"&&scrollType!=="scroll"){return false}var pointerEvents=$target.css("pointer-events");if(pointerEvents==="none"){return false}return true},_isScrolling:function _isScrolling($target,directionY){var scrollTop=Math.ceil($target.scrollTop());var innerHeight=$target.outerHeight();var scrollHeight=$target[0].scrollHeight;var hasScrollingSpace=false;switch(directionY){case"down":hasScrollingSpace=scrollTop+innerHeight<scrollHeight;if(hasScrollingSpace){return true}break;case"up":hasScrollingSpace=scrollTop>0;if(hasScrollingSpace){return true}break;}return false},_getScrollDirection:function _getScrollDirection(event){var deltaY=this._getScrollDelta(event);if(deltaY===0){return"none"}return deltaY>0?"up":"down"},_getScrollDelta:function _getScrollDelta(event){var deltaY=0;var isTouchEvent=event.type==="touchmove";var originalEvent=event.originalEvent;if(isTouchEvent){var startOriginalEvent=this._touchStartEventObject.originalEvent;var currentY=originalEvent.pageY;var previousY=startOriginalEvent.pageY;if(currentY===0||currentY===previousY){currentY=originalEvent.touches[0].pageY;previousY=startOriginalEvent.touches[0].pageY}deltaY=currentY-previousY}else{var hasDeltaY=originalEvent.wheelDeltaY||originalEvent.deltaY!==undefined;if(hasDeltaY){deltaY=-originalEvent.deltaY}else{deltaY=originalEvent.wheelDelta||0}}return deltaY},_stop:function _stop(){if(!this._isRunning){return}this._isRunning=false;window.removeEventListener("touchstart",this._onTouchStart);window.removeEventListener("touchend",this._onTouchEnd);window.removeEventListener("touchmove",this._onScrollEvent,{passive:false});window.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("keydown",this._onKeyDown)}});return Scroll});define("core/js/a11y/wrapFocus",["core/js/adapt"],function(Adapt){var WrapFocus=Backbone.Controller.extend({initialize:function initialize(){_.bindAll(this,"_onWrapAround");this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})},_attachEventListeners:function _attachEventListeners(){var config=Adapt.a11y.config;$("body").on("click focus",config._options._focusguard,this._onWrapAround)},_onWrapAround:function _onWrapAround(event){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupWrapFocusEnabled){return}event.preventDefault();event.stopPropagation();Adapt.a11y.focusFirst("body",{defer:false})}});return WrapFocus});define("core/js/a11y/popup",["core/js/adapt"],function(Adapt){var Popup=Backbone.Controller.extend({_floorStack:[$("body")],_focusStack:[],_tabIndexes:{},_ariaHiddens:{},_elementUIDIndex:0,initialize:function initialize(){this.listenTo(Adapt,{"popup:opened":function popupOpened($element,ignoreInternalTrigger){if(ignoreInternalTrigger){return}Adapt.a11y.log.deprecated("Adapt.trigger(\"popup:opened\", $element) is replaced with Adapt.a11y.popupOpened($element);");this.opened($element,true)},"popup:closed":function popupClosed($target,ignoreInternalTrigger){if(ignoreInternalTrigger){return}Adapt.a11y.log.deprecated("Adapt.trigger(\"popup:closed\", $target) is replaced with Adapt.a11y.popupClosed($target);");this.closed($target,true)}})},opened:function opened($popupElement,silent){$popupElement=$popupElement||$(document.activeElement);this._addPopupLayer($popupElement);if(!silent){Adapt.trigger("popup:opened",$popupElement,true)}return this},_addPopupLayer:function _addPopupLayer($popupElement){$popupElement=$($popupElement);var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled||$popupElement.length===0){return $popupElement}this._floorStack.push($popupElement);this._focusStack.push($(document.activeElement));var $elements=$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);var $branch=$popupElement.add($popupElement.parents());var $siblings=$branch.siblings().filter(config._options._tabbableElementsExcludes);$elements=$elements.add($siblings);$elements.each(function(index,item){var $item=$(item);var elementUID;if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]===undefined){this._tabIndexes[elementUID]=[]}if(this._ariaHiddens[elementUID]===undefined){this._ariaHiddens[elementUID]=[]}var tabindex=$item.attr("tabindex");var ariaHidden=$item.attr("aria-hidden");this._tabIndexes[elementUID].push(tabindex===undefined?"":tabindex);this._ariaHiddens[elementUID].push(ariaHidden===undefined?"":ariaHidden);if(config._options._isPopupTabIndexManagementEnabled){$item.attr("tabindex",-1)}if(config._options._isPopupAriaHiddenManagementEnabled){$item.attr("aria-hidden",true)}}.bind(this));var $items=$popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);if(config._options._isPopupTabIndexManagementEnabled){$items.attr("tabindex",0)}if(config._options._isPopupAriaHiddenManagementEnabled){$items.removeAttr("aria-hidden").removeClass("aria-hidden").parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}},closed:function closed($focusElement,silent){var $previousFocusElement=this._removeLastPopupLayer();$focusElement=$focusElement||$previousFocusElement||$("body");if(!silent){Adapt.trigger("popup:closed",$focusElement,true)}Adapt.a11y.focusFirst($($focusElement));return this},_removeLastPopupLayer:function _removeLastPopupLayer(){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled){return $(document.activeElement)}if(this._floorStack.length<=1){return}this._floorStack.pop();$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each(function(index,item){var $item=$(item);var previousTabIndex="";var previousAriaHidden="";var elementUID;if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]!==undefined&&this._tabIndexes[elementUID].length!==0){previousTabIndex=this._tabIndexes[elementUID].pop();previousAriaHidden=this._ariaHiddens[elementUID].pop()}if(this._tabIndexes[elementUID]!==undefined&&this._tabIndexes[elementUID].length===0){delete this._tabIndexes[elementUID];delete this._ariaHiddens[elementUID]}if(config._options._isPopupTabIndexManagementEnabled){if(previousTabIndex===""){$item.removeAttr("tabindex")}else{$item.attr({"tabindex":previousTabIndex})}}if(config._options._isPopupAriaHiddenManagementEnabled){if(previousAriaHidden===""){$item.removeAttr("aria-hidden")}else{$item.attr({"aria-hidden":previousAriaHidden})}}}.bind(this));return document.activeElement=this._focusStack.pop()},setCloseTo:function setCloseTo($focusElement){var $original=this._focusStack.pop();this._focusStack.push($focusElement);return $original}});return Popup});define("core/js/a11y/deprecated",["core/js/adapt"],function(Adapt){_.extend($.fn,{isFixedPostion:function isFixedPostion(){Adapt.a11y.log.removed("$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.");return false},a11y_aria_label:function a11y_aria_label(){Adapt.a11y.log.removed("$(\"..\").a11y_aria_label was incorrect behaviour.");return this},limitedScrollTo:function limitedScrollTo(){Adapt.a11y.log.removed("$.limitedScrollTo had no impact on the screen reader cursor.");return this},a11y_text:function a11y_text(){Adapt.a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return this},a11y_selected:function a11y_selected(){Adapt.a11y.log.removed("$(\"..\").a11y_selected is removed. Please use aria-live instead.");return this},a11y_on:function a11y_on(isOn){Adapt.a11y.log.deprecated("$(\"..\").a11y_on, use Adapt.a11y.findTabbable($element); and Adapt.a11y.toggleAccessible($elements, isAccessible); instead.");var $tabbable=Adapt.a11y.findTabbable(this);Adapt.a11y.toggleAccessible($tabbable,isOn);return this},a11y_only:function a11y_only(){Adapt.a11y.log.removed("$(\"..\").a11y_only, use Adapt.a11y.popupOpened($popupElement); instead.");return this},scrollDisable:function scrollDisable(){if(Adapt.a11y.config._options._isScrollDisableEnabled===false){return this}Adapt.a11y.log.deprecated("$(\"..\").scrollDisable, use Adapt.a11y.scrollDisable($elements); instead.");Adapt.a11y.scrollDisable(this);return this},scrollEnable:function scrollEnable(){if(Adapt.a11y.config._options._isScrollDisableEnabled===false){return this}Adapt.a11y.log.deprecated("$(\"..\").scrollEnable, use Adapt.a11y.scrollEnable($elements); instead.");Adapt.a11y.scrollEnable(this);return this},a11y_popup:function a11y_popup(){Adapt.a11y.log.deprecated("$(\"..\").a11y_popup, use Adapt.a11y.popupOpened($popupElement); instead.");return Adapt.a11y.popupOpened(this)},a11y_cntrl:function a11y_cntrl(isOn,withDisabled){Adapt.a11y.log.deprecated("$(\"..\").a11y_cntrl, use Adapt.a11y.toggleAccessible($elements, isAccessible); and if needed Adapt.a11y.toggleEnabled($elements, isEnabled); instead.");Adapt.a11y.toggleAccessible(this,isOn);if(withDisabled)Adapt.a11y.toggleEnabled(this,isOn);return this},a11y_cntrl_enabled:function a11y_cntrl_enabled(isOn){Adapt.a11y.log.deprecated("$(\"..\").a11y_cntrl_enabled, use Adapt.a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.");Adapt.a11y.toggleAccessibleEnabled(this,isOn);return this},isReadable:function isReadable(){Adapt.a11y.log.deprecated("$(\"..\").isReadable, use Adapt.a11y.isReadable($element); instead.");return Adapt.a11y.isReadable(this)},findForward:function findForward(selector){Adapt.a11y.log.removed("$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.");return Adapt.a11y._findFirstForward(this,selector)},findWalk:function findWalk(selector){Adapt.a11y.log.removed("$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.");return Adapt.a11y._findFindForwardDescendant(this,selector)},focusNoScroll:function focusNoScroll(){Adapt.a11y.log.deprecated("$(\"..\").focusNoScroll, use Adapt.a11y.focus($element); instead.");return Adapt.a11y.focus(this)},focusNext:function focusNext(returnOnly){Adapt.a11y.log.deprecated("$(\"..\").focusNext, use Adapt.a11y.focusNext($element); or if needed Adapt.a11y.findFirstReadable($element); instead.");if(returnOnly){return Adapt.a11y.findFirstReadable(this)}return Adapt.a11y.focusNext(this)},focusOrNext:function focusOrNext(returnOnly){Adapt.a11y.log.deprecated("$(\"..\").focusOrNext, use Adapt.a11y.focusFirst($element); or if needed Adapt.a11y.findFirstReadable($element); or Adapt.a11y.isReadable($element); instead.");if(returnOnly){if(Adapt.a11y.isReadable(this))return this;return Adapt.a11y.findFirstReadable(this)}return Adapt.a11y.focusFirst(this)},a11y_focus:function a11y_focus(dontDefer){Adapt.a11y.log.deprecated("$(\"..\").a11y_focus, use Adapt.a11y.focusFirst($element, { defer: true }); instead.");Adapt.a11y.focusFirst(this,{defer:!dontDefer});return this}});_.extend($,{a11y_alert:function a11y_alert(){Adapt.a11y.log.removed("$.a11y_alert is removed. Please use aria-live instead.");return this},a11y_update:function a11y_update(){Adapt.a11y.log.removed("a11y_update is no longer required.");return this},a11y_text:function a11y_text(text){Adapt.a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_on:function a11y_on(isOn,selector){Adapt.a11y.log.deprecated("$(\"..\").a11y_on, use Adapt.a11y.toggleHidden($elements, isHidden); instead.");return Adapt.a11y.toggleHidden(selector,!isOn)},a11y_popdown:function a11y_popdown($focusTarget){Adapt.a11y.log.removed("$.a11y_popdown, use Adapt.a11y.popupClosed($focusTarget); instead.");return Adapt.a11y.popupClosed($focusTarget)},a11y_focus:function a11y_focus(dontDefer){Adapt.a11y.log.deprecated("$.a11y_focus, use Adapt.a11y.focusFirst(\"body\", { defer: true }); instead.");Adapt.a11y.focusFirst("body",{defer:!dontDefer});return this},a11y_normalize:function a11y_normalize(html){Adapt.a11y.log.deprecated("$.a11y_normalize, use Adapt.a11y.normalize(\"html\"); instead.");return Adapt.a11y.normalize(html)},a11y_remove_breaks:function a11y_remove_breaks(html){Adapt.a11y.log.deprecated("$.a11y_remove_breaks, use Adapt.a11y.removeBreaks(\"html\"); instead.");return Adapt.a11y.removeBreaks(html)}})});define("core/js/a11y",["core/js/adapt","./a11y/browserFocus","./a11y/focusOptions","./a11y/keyboardFocusOutline","./a11y/log","./a11y/scroll","./a11y/wrapFocus","./a11y/popup","./a11y/deprecated"],function(Adapt,BrowserFocus,FocusOptions,KeyboardFocusOutline,Log,Scroll,WrapFocus,Popup){var A11y=Backbone.Controller.extend({$html:$("html"),_htmlCharRegex:/&.*;/g,config:null,defaults:{_isFocusOutlineKeyboardOnlyEnabled:true,_isFocusOutlineDisabled:false,_isFocusAssignmentEnabled:true,_isFocusOnClickEnabled:true,_isFocusNextOnDisabled:true,_isScrollDisableEnabled:true,_isAriaHiddenManagementEnabled:true,_isPopupManagementEnabled:true,_isPopupWrapFocusEnabled:true,_isPopupAriaHiddenManagementEnabled:true,_isPopupTabIndexManagementEnabled:true,_ariaHiddenExcludes:":not(#wrapper):not(body)",_tabbableElements:"a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])",_focusOutlineKeyboardOnlyIgnore:"input,textarea",_tabbableElementsExcludes:":not(.a11y-ignore):not([data-a11y-force-focus])",_focusableElements:"a,button,input,select,textarea,[tabindex],label",_readableElements:"[role=heading],[aria-label],[aria-labelledby],[alt]",_focusguard:".a11y-focusguard",_wrapStyleElements:"b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb",_warnFirstOnly:true,_warn:true},_browserFocus:new BrowserFocus,_keyboardFocusOutline:new KeyboardFocusOutline,_wrapFocus:new WrapFocus,_popup:new Popup,_scroll:new Scroll,log:new Log,initialize:function initialize(){this._removeLegacyElements();this.listenToOnce(Adapt,{"app:dataLoaded":this._onDataLoaded,"navigationView:postRender":this._removeLegacyElements},this);Adapt.on("device:changed",this._setupNoSelect);this.listenTo(Adapt,{"router:location":this._onNavigationStart,"contentObjectView:ready router:plugin":this._onNavigationEnd})},_onDataLoaded:function _onDataLoaded(){this.config=Adapt.config.get("_accessibility");this.config._isActive=false;this.config._options=_.defaults(this.config._options||{},this.defaults);Adapt.offlineStorage.set("a11y",false);this.$html.toggleClass("has-accessibility",this.isEnabled());this._setupNoSelect();this._addFocuserDiv();if(this._isReady){return}this._isReady=true;Adapt.trigger("accessibility:ready")},_setupNoSelect:function _setupNoSelect(){if(!this.config||!this.config._disableTextSelectOnClasses){return}var classes=this.config._disableTextSelectOnClasses.split(" ");var isMatch=false;for(var i=0,item;item=classes[i++];){if(this.$html.is(item)){isMatch=true;break}}this.$html.toggleClass("u-no-select",isMatch)},_addFocuserDiv:function _addFocuserDiv(){if($("#a11y-focuser").length){return}$("body").append($("<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\" role=\"presentation\">&nbsp;</div>"))},_removeLegacyElements:function _removeLegacyElements(){var $legacyElements=$("body").children("#accessibility-toggle, #accessibility-instructions");var $navigationElements=$(".nav").find("#accessibility-toggle, #accessibility-instructions");if(!$legacyElements.length&&!$navigationElements.length){return}Adapt.log.warn("REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.");$legacyElements.remove();$navigationElements.remove()},_onNavigationStart:function _onNavigationStart(){if(!this.isEnabled()){return}_.defer(function(){Adapt.a11y.toggleHidden(".contentobject",true)})},_onNavigationEnd:function _onNavigationEnd(view){if(view&&view.model&&view.model.get("_id")!==Adapt.location._currentId||!this.isEnabled()){return}Adapt.a11y.toggleHidden(".contentobject",false)},isActive:function isActive(){this.log.removed("Accessibility is now always active when enabled. Please unify your user experiences.");return false},isEnabled:function isEnabled(){return this.config&&this.config._isEnabled},toggleHidden:function toggleHidden($elements,isHidden){$elements=$($elements);var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled){return this}isHidden=isHidden===undefined?true:isHidden;if(isHidden===true){$elements.attr("aria-hidden",true)}else{$elements.removeAttr("aria-hidden")}return this},toggleAccessibleEnabled:function toggleAccessibleEnabled($elements,isAccessibleEnabled){this.toggleAccessible($elements,isAccessibleEnabled);this.toggleEnabled($elements,isAccessibleEnabled);return this},toggleAccessible:function toggleAccessible($elements,isReadable){$elements=$($elements);var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled||$elements.length===0){return this}isReadable=isReadable===undefined?true:isReadable;if(!isReadable){$elements.attr({tabindex:"-1","aria-hidden":"true"}).addClass("aria-hidden")}else{$elements.removeAttr("aria-hidden tabindex").removeClass("aria-hidden");$elements.parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}return this},toggleEnabled:function toggleEnabled($elements,isEnabled){$elements=$($elements);if($elements.length===0){return this}isEnabled=isEnabled===undefined?true:isEnabled;if(!isEnabled){$elements.attr("disabled","disabled").addClass("is-disabled")}else{$elements.removeAttr("disabled").removeClass("is-disabled")}return this},findFirstTabbable:function findFirstTabbable($element){$element=$($element).first();return this._findFirstForward($element,this.isTabbable)},findFirstReadable:function findFirstReadable($element){$element=$($element).first();return this._findFirstForward($element,this.isReadable)},findTabbable:function findTabbable($element){var config=Adapt.a11y.config;return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes)},findReadable:function findReadable($element){return $($element).find("*").filter(function(index,element){return this.isReadable(element)}.bind(this))},isTabbable:function isTabbable($element){var config=Adapt.a11y.config;var value=$($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);if(!value){return undefined}return value},isReadable:function isReadable($element,checkParents){var config=Adapt.a11y.config;$element=$($element).first();checkParents=checkParents===undefined;var $branch=checkParents?$element.add($element.parents()):$element;var isNotVisible=_.find($branch.toArray(),function(item){var $item=$(item);var isNotVisible=$item.css("display")==="none"||$item.css("visibility")==="hidden"||$item.attr("aria-hidden")==="true";if(isNotVisible){return true}});if(isNotVisible){return false}var hasNativeFocusOrIsScreenReadable=$element.is(config._options._focusableElements)||$element.is(config._options._readableElements);if(hasNativeFocusOrIsScreenReadable){return true}var childNodes=$element[0].childNodes;for(var c=0,cl=childNodes.length;c<cl;c++){var childNode=childNodes[c];var isTextNode=childNode.nodeType===3;if(!isTextNode){continue}var isOnlyWhiteSpace=/^\s*$/.test(childNode.nodeValue);if(isOnlyWhiteSpace){continue}return true}return undefined},_findFirstForward:function _findFirstForward($element,selector){$element=$($element).first();var iterator;switch(_typeof(selector)){case"string":iterator=function iterator($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}if($element.length===0){return $element.not("*")}var $found=this._findFirstForwardDescendant($element,iterator);if($found&&$found.length){return $found}var $nextSiblings=$element.nextAll().toArray();_.find($nextSiblings,function(sibling){var $sibling=$(sibling);var value=iterator($sibling);if(value===false){return}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);if($found&&$found.length)return true}.bind(this));if($found&&$found.length){return $found}var $branch=$element.add($element.parents()).toArray().reverse();_.find($branch,function(parent){var $parent=$(parent);if(iterator($parent)===false){return false}var $siblings=$parent.nextAll().toArray();return _.find($siblings,function(sibling){var $sibling=$(sibling);var value=iterator($sibling);if(value===false){return}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);if($found&&$found.length){return true}}.bind(this))}.bind(this));if(!$found||!$found.length){return $element.not("*")}return $found},_findFirstForwardDescendant:function _findFirstForwardDescendant($element,selector){$element=$($element).first();var iterator;switch(_typeof(selector)){case"string":iterator=function iterator($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}var $notFound=$element.not("*");if($element.length===0){return $notFound}var stack=[{item:$element[0],value:undefined}];var stackIndexPosition=0;var childIndexPosition=stackIndexPosition+1;do{var stackEntry=stack[stackIndexPosition];var $stackItem=$(stackEntry.item);switch(stackEntry.value){case true:return $stackItem;case false:return $notFound;}var $children=$stackItem.children().toArray();_.find($children,function(item){var $item=$(item);var value=iterator($item);if(value===false){return false}stack.splice(childIndexPosition++,0,{item:item,value:value})});stackIndexPosition++;childIndexPosition=stackIndexPosition+1}while(stackIndexPosition<stack.length);return $notFound},focusNext:function focusNext($element,options){options=new FocusOptions(options);$element=$($element).first();$element=Adapt.a11y.findFirstReadable($element);this.focus($element,options);return this},focusFirst:function focusFirst($element,options){options=new FocusOptions(options);$element=$($element).first();if(Adapt.a11y.isReadable($element)){this.focus($element,options);return $element}$element=Adapt.a11y.findFirstReadable($element);this.focus($element,options);return $element},focus:function focus($element,options){options=new FocusOptions(options);$element=$($element).first();var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isFocusAssignmentEnabled||$element.length===0){return this}function perform(){if(options.preventScroll){var y=$(window).scrollTop();try{if($element.attr("tabindex")===undefined){$element.attr({"tabindex":"-1","data-a11y-force-focus":"true"})}$element[0].focus({preventScroll:true})}catch(e){}window.scrollTo(null,y)}else{$element[0].focus()}}if(options.defer){_.defer(function(){perform()})}else{perform()}return this},normalize:function normalize(htmls){var values=Array.prototype.slice.call(arguments,0);values=values.filter(Boolean);values=values.filter(_.isString);htmls=values.join(" ");var text=$("<div>"+htmls+"</div>").text();return text.replace(this._htmlCharRegex,"")},removeBreaks:function removeBreaks(htmls){var values=Array.prototype.slice.call(arguments,0);values=values.filter(Boolean);values=values.filter(_.isString);htmls=values.join(" ");var $div=$("<div>"+htmls+"</div>");var stack=[$div[0]];var stackIndex=0;var outputs=[];do{if(stack[stackIndex].childNodes.length){var nodes=stack[stackIndex].childNodes;var usable=_.filter(nodes,function(node){var isTextNode=node.nodeType===3;if(isTextNode){return true}var isStyleElement=$(node).is(Adapt.a11y.config._options._wrapStyleElements);if(isStyleElement){return true}return false});outputs.push.apply(outputs,usable);stack.push.apply(stack,nodes)}stackIndex++}while(stackIndex<stack.length);var rtnText="";outputs.forEach(function(item){rtnText+=item.outerHTML||item.textContent});return rtnText},scrollEnable:function scrollEnable($elements){this._scroll.enable($elements);return this},scrollDisable:function scrollDisable($elements){this._scroll.disable($elements);return this},popupOpened:function popupOpened($popupElement){this._popup.opened($popupElement);return this},popupClosed:function popupClosed($focusElement){this._popup.closed($focusElement);return this},setPopupCloseTo:function setPopupCloseTo($focusElement){return this._popup.setCloseTo($focusElement)}});return Adapt.a11y=new A11y});define("core/js/accessibility",["core/js/adapt","./a11y"],function(Adapt,a11y){Object.defineProperty(Adapt,"accessibility",{get:function get(){a11y.log.deprecated("Adapt.accessibility has moved to Adapt.a11y");return Adapt.accessibility=a11y}})});define("core/js/collections/adaptCollection",["core/js/adapt"],function(Adapt){var AdaptCollection=function(_Backbone$Collection){"use strict";_inherits(AdaptCollection,_Backbone$Collection);var _super4=_createSuper(AdaptCollection);function AdaptCollection(){_classCallCheck(this,AdaptCollection);return _super4.apply(this,arguments)}_createClass(AdaptCollection,[{key:"initialize",value:function initialize(models,options){this.once("reset",this.loadedData,this)}},{key:"loadedData",value:function loadedData(){Adapt.trigger("adaptCollection:dataLoaded")}}]);return AdaptCollection}(Backbone.Collection);return AdaptCollection});define("core/js/enums/logLevelEnum",[],function(){var LOG_LEVEL=ENUM(["DEBUG","INFO","WARN","ERROR","FATAL"]);return LOG_LEVEL});define("core/js/logging",["core/js/adapt","core/js/enums/logLevelEnum"],function(Adapt,LOG_LEVEL){var Logging=function(_Backbone$Controller3){"use strict";_inherits(Logging,_Backbone$Controller3);var _super5=_createSuper(Logging);function Logging(){_classCallCheck(this,Logging);return _super5.apply(this,arguments)}_createClass(Logging,[{key:"initialize",value:function initialize(){this._config={_isEnabled:true,_level:LOG_LEVEL.INFO.asLowerCase,_console:true,_warnFirstOnly:true};this._warned={};this.listenToOnce(Adapt,"configModel:dataLoaded",this.onLoadConfigData)}},{key:"onLoadConfigData",value:function onLoadConfigData(){this.loadConfig();this.debug("Logging config loaded");this.trigger("log:ready")}},{key:"loadConfig",value:function loadConfig(){if(Adapt.config.has("_logging")){this._config=Adapt.config.get("_logging")}this.checkQueryStringOverride()}},{key:"checkQueryStringOverride",value:function checkQueryStringOverride(){var matches=window.location.search.match(/[?&]loglevel=([a-z]*)/i);if(!matches||matches.length<2)return;var override=LOG_LEVEL(matches[1].toUpperCase());if(!override)return;this._config._level=override.asLowerCase;this.debug("Loglevel override in query string:",this._config._level)}},{key:"debug",value:function debug(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}this._log(LOG_LEVEL.DEBUG,args)}},{key:"info",value:function info(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}this._log(LOG_LEVEL.INFO,args)}},{key:"warn",value:function warn(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}this._log(LOG_LEVEL.WARN,args)}},{key:"error",value:function error(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}this._log(LOG_LEVEL.ERROR,args)}},{key:"fatal",value:function fatal(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}this._log(LOG_LEVEL.FATAL,args)}},{key:"removed",value:function removed(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++){args[_key9]=arguments[_key9]}args=["REMOVED"].concat(args);this.warnOnce.apply(this,_toConsumableArray(args))}},{key:"deprecated",value:function deprecated(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++){args[_key10]=arguments[_key10]}args=["DEPRECATED"].concat(args);this.warnOnce.apply(this,_toConsumableArray(args))}},{key:"warnOnce",value:function warnOnce(){for(var _len11=arguments.length,args=new Array(_len11),_key11=0;_key11<_len11;_key11++){args[_key11]=arguments[_key11]}if(this._hasWarned(args)){return}this._log(LOG_LEVEL.WARN,args)}},{key:"_log",value:function _log(level,data){var isEnabled=this._config._isEnabled;if(!isEnabled)return;var configLevel=LOG_LEVEL(this._config._level.toUpperCase());var isLogLevelAllowed=level>=configLevel;if(!isLogLevelAllowed)return;this._logToConsole(level,data);this.trigger("log",level,data);this.trigger("log:"+level.asLowerCase,level,data)}},{key:"_logToConsole",value:function _logToConsole(level,data){var shouldLogToConsole=this._config._console;if(!shouldLogToConsole)return;var log=[level.asUpperCase+":"];data&&log.push.apply(log,_toConsumableArray(data));if(console[level.asLowerCase]){var _console;(_console=console)[level.asLowerCase].apply(_console,log)}else{var _console2;(_console2=console).log.apply(_console2,log)}}},{key:"_hasWarned",value:function _hasWarned(args){if(!this._config._warnFirstOnly){return false}var hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}}]);return Logging}(Backbone.Controller);return Adapt.log=new Logging});define("core/js/models/buildModel",["core/js/adapt","core/js/logging"],function(Adapt){var BuildModel=function(_Backbone$Model2){"use strict";_inherits(BuildModel,_Backbone$Model2);var _super6=_createSuper(BuildModel);function BuildModel(){_classCallCheck(this,BuildModel);return _super6.apply(this,arguments)}_createClass(BuildModel,[{key:"defaults",value:function defaults(){return{jsonext:"json"}}},{key:"initialize",value:function initialize(attrs,options){var _this12=this;this.url=options.url;this.fetch({success:function success(){_newArrowCheck(this,_this12);this.isLoaded=true;Adapt.trigger("buildModel:dataLoaded")}.bind(this),error:function error(){_newArrowCheck(this,_this12);console.log("Unable to load adapt/js/build.js");Adapt.trigger("buildModel:dataLoaded")}.bind(this)})}},{key:"whenReady",value:function whenReady(){var _this13=this;if(this.isLoaded)return Promise.resolve();return new Promise(function(resolve){_newArrowCheck(this,_this13);Adapt.once("buildModel:dataLoaded",resolve)}.bind(this))}}]);return BuildModel}(Backbone.Model);return BuildModel});define("core/js/models/configModel",["core/js/adapt"],function(Adapt){var ConfigModel=function(_Backbone$Model3){"use strict";_inherits(ConfigModel,_Backbone$Model3);var _super7=_createSuper(ConfigModel);function ConfigModel(){_classCallCheck(this,ConfigModel);return _super7.apply(this,arguments)}_createClass(ConfigModel,[{key:"defaults",value:function defaults(){return{screenSize:{large:900,medium:760,small:520},_forceRouteLocking:false,_canLoadData:true,_disableAnimation:false}}},{key:"initialize",value:function initialize(attrs,options){var _this14=this;this.url=options.url;this.fetch({success:function success(){var _this15=this;_newArrowCheck(this,_this14);Adapt.trigger("offlineStorage:prepare");Adapt.wait.queue(function(){_newArrowCheck(this,_this15);Adapt.trigger("configModel:dataLoaded");if(!this.get("_canLoadData"))return;Adapt.trigger("configModel:loadCourseData")}.bind(this))}.bind(this),error:function error(){_newArrowCheck(this,_this14);return console.log("Unable to load course/config.json")}.bind(this)})}},{key:"loadData",value:function loadData(){}}]);return ConfigModel}(Backbone.Model);return ConfigModel});define("core/js/modelEvent",[],function(){var ModelEvent=Backbone.Controller.extend({type:null,target:null,value:null,canBubble:true,deepPath:null,timeStamp:null,initialize:function initialize(type,target,value){this.type=type;this.target=target;this.value=value;this.deepPath=[target]},stopPropagation:function stopPropagation(){this.canBubble=false},addPath:function addPath(target){this.deepPath.unshift(target)}});return ModelEvent});define("core/js/models/adaptModel",["core/js/adapt","core/js/modelEvent","core/js/logging"],function(Adapt,ModelEvent){var AdaptModel=function(_Backbone$Model4){"use strict";_inherits(AdaptModel,_Backbone$Model4);var _super8=_createSuper(AdaptModel);function AdaptModel(){_classCallCheck(this,AdaptModel);return _super8.apply(this,arguments)}_createClass(AdaptModel,[{key:"toJSON",value:function toJSON(){var json=_.clone(this.attributes);delete json._children;delete json._parent;return $.extend(true,{},json)}},{key:"get",value:function get(name){switch(name){case"_parent":case"_children":Adapt.log.deprecated("Use model.getChildren() or model.getParent() instead of model.get('_children') or model.get('_parent')");}return _get(_getPrototypeOf(AdaptModel.prototype),"get",this).call(this,name)}},{key:"defaults",value:function defaults(){return{_canShowFeedback:true,_classes:"",_canReset:false,_isComplete:false,_isInteractionComplete:false,_isA11yRegionEnabled:false,_isA11yCompletionDescriptionEnabled:true,_requireCompletionOf:-1,_isEnabled:true,_isResetOnRevisit:false,_isAvailable:true,_isOptional:false,_isReady:false,_isVisible:true,_isLocked:false,_isHidden:false}}},{key:"trackable",value:function trackable(){return["_id","_isComplete","_isInteractionComplete"]}},{key:"bubblingEvents",value:function bubblingEvents(){return["change:_isComplete","change:_isInteractionComplete","change:_isActive"]}},{key:"initialize",value:function initialize(){this.listenToOnce(Adapt,"app:dataLoaded",this.setupModel)}},{key:"setupModel",value:function setupModel(){var _this16=this;if(this.hasManagedChildren){this.setupChildListeners()}this.init();_.defer(function(){_newArrowCheck(this,_this16);if(this.hasManagedChildren){this.checkCompletionStatus();this.checkInteractionCompletionStatus();this.checkLocking()}this.setupTrackables()}.bind(this))}},{key:"setupTrackables",value:function setupTrackables(){var _this17=this;var originalTrackableStateFunction=this.triggerTrackableState;this.triggerTrackableState=_.compose(function(){_newArrowCheck(this,_this17);this.triggerTrackableState.isQueued=true}.bind(this),_.debounce(function(){_newArrowCheck(this,_this17);originalTrackableStateFunction.apply(this);this.triggerTrackableState.isQueued=false}.bind(this),17));this.listenTo(this,"change",function(_ref){var _this18=this;_newArrowCheck(this,_this17);var changed=_ref.changed;if(this.triggerTrackableState.isQueued||!Adapt.attributes._isStarted){return}var trackablePropertyNames=_.result(this,"trackable",[]);var changedPropertyNames=Object.keys(changed);var isTrackable=changedPropertyNames.find(function(item){_newArrowCheck(this,_this18);return trackablePropertyNames.includes(item)}.bind(this));if(isTrackable){this.triggerTrackableState()}}.bind(this))}},{key:"setupChildListeners",value:function setupChildListeners(){var children=this.getChildren();if(!children.length){return}this.listenTo(children,{"all":this.onAll,"bubble":this.bubble,"change:_isReady":this.checkReadyStatus,"change:_isComplete":this.onIsComplete,"change:_isInteractionComplete":this.checkInteractionCompletionStatus})}},{key:"init",value:function init(){}},{key:"getTrackableState",value:function getTrackableState(){var _ref2;var trackable=this.resultExtend("trackable",[]);var json=this.toJSON();var args=trackable;args.unshift(json);return(_ref2=_).pick.apply(_ref2,_toConsumableArray(args))}},{key:"setTrackableState",value:function setTrackableState(state){var _ref3;var trackable=this.resultExtend("trackable",[]);var args=trackable;args.unshift(state);state=(_ref3=_).pick.apply(_ref3,_toConsumableArray(args));this.set(state);return this}},{key:"triggerTrackableState",value:function triggerTrackableState(){Adapt.trigger("state:change",this,this.getTrackableState())}},{key:"reset",value:function reset(type,force){if(!this.get("_canReset")&&!force)return;type=type||true;switch(type){case"hard":case true:this.set({_isEnabled:true,_isComplete:false,_isInteractionComplete:false});break;case"soft":this.set({_isEnabled:true,_isInteractionComplete:false});break;}}},{key:"checkReadyStatus",value:function checkReadyStatus(){var _this19=this;var children=this.getAvailableChildModels();if(children.find(function(child){_newArrowCheck(this,_this19);return child.get("_isReady")===false}.bind(this))){return}this.set("_isReady",true)}},{key:"setCompletionStatus",value:function setCompletionStatus(){if(!this.get("_isVisible"))return;this.set({_isComplete:true,_isInteractionComplete:true})}},{key:"checkCompletionStatus",value:function checkCompletionStatus(){Adapt.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isComplete")}},{key:"checkInteractionCompletionStatus",value:function checkInteractionCompletionStatus(){Adapt.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isInteractionComplete")}},{key:"checkCompletionStatusFor",value:function checkCompletionStatusFor(){var _this20=this;var completionAttribute=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"_isComplete";var completed=false;var children=this.getAvailableChildModels();var requireCompletionOf=this.get("_requireCompletionOf");if(requireCompletionOf===-1){completed=children.every(function(child){_newArrowCheck(this,_this20);return child.get(completionAttribute)||child.get("_isOptional")}.bind(this))}else{completed=children.filter(function(child){_newArrowCheck(this,_this20);return child.get(completionAttribute)&&!child.get("_isOptional")}.bind(this)).length>=requireCompletionOf}this.set(completionAttribute,completed);Adapt.checkedCompletion()}},{key:"getTypeGroup",value:function getTypeGroup(){}},{key:"isTypeGroup",value:function isTypeGroup(typeGroup){var hasUpperCase=/[A-Z]+/.test(typeGroup);var isPluralized=typeGroup.slice(-1)==="s";var lowerCased=typeGroup.toLowerCase();var singular=isPluralized&&lowerCased.slice(0,-1);var singularLowerCased=(singular||lowerCased).toLowerCase();if(isPluralized||hasUpperCase){Adapt.log.deprecated("'".concat(typeGroup,"' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '").concat(singularLowerCased,"'."))}var pluralizedLowerCaseTypes=[singularLowerCased,!isPluralized&&"".concat(lowerCased,"s")].filter(Boolean);var typeGroups=this.getTypeGroups();if(_.intersection(pluralizedLowerCaseTypes,typeGroups).length){return true}return false}},{key:"getTypeGroups",value:function getTypeGroups(){var _this21=this;if(this._typeGroups)return this._typeGroups;var typeGroups=[this.get("_type")];var parentClass=this;while(parentClass=Object.getPrototypeOf(parentClass)){if(!parentClass.hasOwnProperty("getTypeGroup"))continue;typeGroups.push(parentClass.getTypeGroup.call(this))}return this._typeGroups=_.uniq(typeGroups.filter(Boolean).map(function(s){_newArrowCheck(this,_this21);return s.toLowerCase()}.bind(this)))}},{key:"findAncestor",value:function findAncestor(ancestorType){var parent=this.getParent();if(!parent)return;if(!ancestorType||parent.isTypeGroup(ancestorType)){return parent}return parent.findAncestor(ancestorType)}},{key:"findDescendantModels",value:function findDescendantModels(descendants,options){var _this22=this;var allDescendantsModels=this.getAllDescendantModels();var returnedDescendants=allDescendantsModels.filter(function(model){_newArrowCheck(this,_this22);return model.isTypeGroup(descendants)}.bind(this));if(!options){return returnedDescendants}if(options.where){return returnedDescendants.filter(function(descendant){_newArrowCheck(this,_this22);for(var property in options.where){var value=options.where[property];if(descendant.get(property)!==value){return false}}return true}.bind(this))}}},{key:"getAllDescendantModels",value:function getAllDescendantModels(isParentFirst){var _this23=this;var descendants=[];if(!this.hasManagedChildren){return descendants}var children=this.getChildren();children.models.forEach(function(child){_newArrowCheck(this,_this23);if(!child.hasManagedChildren){descendants.push(child);return}var subDescendants=child.getAllDescendantModels(isParentFirst);if(isParentFirst===true){descendants.push(child)}descendants.push.apply(descendants,_toConsumableArray(subDescendants));if(isParentFirst!==true){descendants.push(child)}}.bind(this));return descendants}},{key:"findRelativeModel",value:function findRelativeModel(relativeString){var _this24=this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var rootModel=options.limitParentId?Adapt.findById(options.limitParentId):Adapt.course;var relativeDescriptor=Adapt.parseRelativeString(relativeString);var searchBackwards=relativeDescriptor.offset<0;var moveBy=Math.abs(relativeDescriptor.offset);var movementCount=0;var hasDescendantsOfType=Boolean(this.findDescendantModels(relativeDescriptor.type).length);if(hasDescendantsOfType){moveBy--}var pageDescendants;if(searchBackwards){var _pageDescendants;pageDescendants=[rootModel];(_pageDescendants=pageDescendants).push.apply(_pageDescendants,_toConsumableArray(rootModel.getAllDescendantModels(true)));pageDescendants.reverse()}else{pageDescendants=rootModel.getAllDescendantModels(false);pageDescendants.push(rootModel)}if(typeof options.filter==="function"){pageDescendants=pageDescendants.filter(options.filter)}var modelId=this.get("_id");var modelIndex=pageDescendants.findIndex(function(pageDescendant){_newArrowCheck(this,_this24);if(pageDescendant.get("_id")===modelId){return true}return false}.bind(this));if(options.loop){var totalOfType=pageDescendants.reduce(function(count,model){_newArrowCheck(this,_this24);if(!model.isTypeGroup(relativeDescriptor.type))return count;return++count}.bind(this),0);moveBy=moveBy%totalOfType;pageDescendants=pageDescendants.concat(pageDescendants.slice(0))}for(var _i2=modelIndex,l=pageDescendants.length;_i2<l;_i2++){var descendant=pageDescendants[_i2];if(descendant.isTypeGroup(relativeDescriptor.type)){if(movementCount>moveBy){break}if(movementCount===moveBy){return Adapt.findById(descendant.get("_id"))}movementCount++}}}},{key:"getChildren",value:function getChildren(){var _this25=this;if(this._childrenCollection){return this._childrenCollection}var childrenCollection;if(!this.hasManagedChildren){childrenCollection=new Backbone.Collection}else{var id=this.get("_id");var children=Adapt.data.filter(function(model){_newArrowCheck(this,_this25);return model.get("_parentId")===id}.bind(this));childrenCollection=new Backbone.Collection(children)}if(this.get("_type")==="block"&&childrenCollection.length===2&&childrenCollection.models[0].get("_layout")!=="left"){childrenCollection.comparator="_layout";childrenCollection.sort()}this.setChildren(childrenCollection);return this._childrenCollection}},{key:"setChildren",value:function setChildren(children){this._childrenCollection=children;this.set("_children",children)}},{key:"getAvailableChildModels",value:function getAvailableChildModels(){return this.getChildren().where({_isAvailable:true})}},{key:"getParent",value:function getParent(){if(this._parentModel){return this._parentModel}var parentId=this.get("_parentId");if(!parentId)return;this.setParent(Adapt.findById(parentId));return this._parentModel}},{key:"setParent",value:function setParent(parent){this._parentModel=parent;this.set("_parentId",this._parentModel.get("_id"));this.set("_parent",this._parentModel)}},{key:"getAncestorModels",value:function getAncestorModels(shouldIncludeChild){var parents=[];var context=this;if(shouldIncludeChild)parents.push(context);while(context.has("_parentId")){context=context.getParent();parents.push(context)}return parents.length?parents:null}},{key:"getSiblings",value:function getSiblings(passSiblingsAndIncludeSelf){var _this26=this;var id=this.get("_id");var parentId=this.get("_parentId");var siblings;if(!passSiblingsAndIncludeSelf){if(this._hasSiblingsAndSelf===false){return this.get("_siblings")}siblings=Adapt.data.filter(function(model){_newArrowCheck(this,_this26);return model.get("_parentId")===parentId&&model.get("_id")!==id}.bind(this));this._hasSiblingsAndSelf=false}else{if(this._hasSiblingsAndSelf){return this.get("_siblings")}siblings=Adapt.data.filter(function(model){_newArrowCheck(this,_this26);return model.get("_parentId")===parentId}.bind(this));this._hasSiblingsAndSelf=true}var siblingsCollection=new Backbone.Collection(siblings);this.set("_siblings",siblingsCollection);return siblingsCollection}},{key:"setOnChildren",value:function setOnChildren(){var _this27=this;for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++){args[_key12]=arguments[_key12]}this.set.apply(this,args);if(!this.hasManagedChildren)return;var children=this.getChildren();children.models.forEach(function(child){_newArrowCheck(this,_this27);return child.setOnChildren.apply(child,args)}.bind(this))}},{key:"setOptional",value:function setOptional(value){Adapt.log.deprecated("Use model.set('_isOptional', value) as setOptional() may be removed in the future");this.set({_isOptional:value})}},{key:"checkLocking",value:function checkLocking(){var lockType=this.get("_lockType");if(!lockType)return;switch(lockType){case"sequential":this.setSequentialLocking();break;case"unlockFirst":this.setUnlockFirstLocking();break;case"lockLast":this.setLockLastLocking();break;case"custom":this.setCustomLocking();break;default:console.warn("AdaptModel.checkLocking: unknown _lockType '".concat(lockType,"' found on ").concat(this.get("_id")));}}},{key:"setSequentialLocking",value:function setSequentialLocking(){var children=this.getAvailableChildModels();for(var _i3=1,j=children.length;_i3<j;_i3++){children[_i3].set("_isLocked",!children[_i3-1].get("_isComplete"))}}},{key:"setUnlockFirstLocking",value:function setUnlockFirstLocking(){var children=this.getAvailableChildModels();var isFirstChildComplete=children[0].get("_isComplete");for(var _i4=1,j=children.length;_i4<j;_i4++){children[_i4].set("_isLocked",!isFirstChildComplete)}}},{key:"setLockLastLocking",value:function setLockLastLocking(){var children=this.getAvailableChildModels();var lastIndex=children.length-1;for(var _i5=lastIndex-1;_i5>=0;_i5--){if(!children[_i5].get("_isComplete")){return children[lastIndex].set("_isLocked",true)}}children[lastIndex].set("_isLocked",false)}},{key:"setCustomLocking",value:function setCustomLocking(){var _this28=this;var children=this.getAvailableChildModels();children.forEach(function(child){_newArrowCheck(this,_this28);child.set("_isLocked",this.shouldLock(child))}.bind(this))}},{key:"shouldLock",value:function shouldLock(child){var lockedBy=child.get("_lockedBy");if(!lockedBy)return false;for(var _i6=lockedBy.length-1;_i6>=0;_i6--){var id=lockedBy[_i6];try{var model=Adapt.findById(id);if(!model.get("_isAvailable"))continue;if(!model.get("_isComplete"))return true}catch(e){console.warn("AdaptModel.shouldLock: unknown _lockedBy ID '".concat(id,"' found on ").concat(child.get("_id")))}}return false}},{key:"onIsComplete",value:function onIsComplete(){this.checkCompletionStatus();this.checkLocking()}},{key:"onAll",value:function onAll(type,model,value){if(!_.result(this,"bubblingEvents").includes(type))return;var event=new ModelEvent(type,model,value);this.bubble(event)}},{key:"bubble",value:function bubble(event){if(!event.canBubble)return;event.addPath(this);this.trigger("bubble:".concat(event.type," bubble"),event)}},{key:"hasManagedChildren",get:function get(){return true}}]);return AdaptModel}(Backbone.Model);return AdaptModel});define("core/js/models/contentObjectModel",["core/js/adapt","core/js/models/adaptModel"],function(Adapt,AdaptModel){var ContentObjectModel=function(_AdaptModel){"use strict";_inherits(ContentObjectModel,_AdaptModel);var _super9=_createSuper(ContentObjectModel);function ContentObjectModel(){_classCallCheck(this,ContentObjectModel);return _super9.apply(this,arguments)}_createClass(ContentObjectModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"contentobject"}},{key:"_parent",get:function get(){Adapt.log.deprecated("contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON");var isParentCourse=this.get("_parentId")===Adapt.course.get("_id");if(isParentCourse){return"course"}return"contentObjects"}},{key:"_siblings",get:function get(){Adapt.log.deprecated("contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON");return"contentObjects"}},{key:"_children",get:function get(){Adapt.log.deprecated("contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON");return null}}]);return ContentObjectModel}(AdaptModel);return ContentObjectModel});define("core/js/models/menuModel",["core/js/adapt","core/js/models/contentObjectModel"],function(Adapt,ContentObjectModel){var MenuModel=function(_ContentObjectModel){"use strict";_inherits(MenuModel,_ContentObjectModel);var _super10=_createSuper(MenuModel);function MenuModel(){_classCallCheck(this,MenuModel);return _super10.apply(this,arguments)}_createClass(MenuModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"menu"}},{key:"setCustomLocking",value:function setCustomLocking(){var _this29=this;var children=this.getAvailableChildModels();children.forEach(function(child){_newArrowCheck(this,_this29);child.set("_isLocked",this.shouldLock(child));if(!(child instanceof MenuModel))return;child.checkLocking()}.bind(this))}},{key:"_children",get:function get(){Adapt.log.deprecated("menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"contentObjects"}}]);return MenuModel}(ContentObjectModel);Adapt.register("menu",{model:MenuModel});return MenuModel});define("core/js/models/courseModel",["core/js/adapt","core/js/models/menuModel"],function(Adapt,MenuModel){var CourseModel=function(_MenuModel){"use strict";_inherits(CourseModel,_MenuModel);var _super11=_createSuper(CourseModel);function CourseModel(){_classCallCheck(this,CourseModel);return _super11.apply(this,arguments)}_createClass(CourseModel,[{key:"_parent",get:function get(){Adapt.log.deprecated("courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON");return null}},{key:"_siblings",get:function get(){Adapt.log.deprecated("courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON");return null}}]);return CourseModel}(MenuModel);Adapt.register("course",{model:CourseModel});return CourseModel});define("core/js/startController",["core/js/adapt"],function(Adapt){var StartController=Backbone.Controller.extend({model:null,loadCourseData:function loadCourseData(){this.model=new Backbone.Model(Adapt.course.get("_start"))},setStartLocation:function setStartLocation(){if(!this.isEnabled())return;window.history.replaceState("","",this.getStartHash())},returnToStartLocation:function returnToStartLocation(){var startIds=this.model.get("_startIds");if(startIds){startIds.forEach(function(startId){startId._skipIfComplete=false})}window.location.hash=this.getStartHash(true)},getStartHash:function getStartHash(alwaysForce){var startId=this.getStartId();var isRouteSpecified=window.location.href.indexOf("#")>-1;var shouldForceStartId=alwaysForce||this.model.get("_force");var shouldNavigateToStartId=startId&&(!isRouteSpecified||shouldForceStartId);if(shouldNavigateToStartId&&startId!==Adapt.course.get("_id")){return"#/id/"+startId}return window.location.hash||"#/"},isEnabled:function isEnabled(){if(!this.model||!this.model.get("_isEnabled"))return false;return true},getStartId:function getStartId(){var startId=this.model.get("_id");var startIds=this.model.get("_startIds");if(!startIds||!startIds.length)return startId;var $html=$("html");for(var i=0,l=startIds.length;i<l;i++){var item=startIds[i];var className=item._className;var skipIfComplete=item._skipIfComplete;var model=Adapt.findById(item._id);if(!model){console.log("startController: cannot find id",item._id);continue}if(skipIfComplete){if(model.get("_isComplete"))continue}if(!className||$html.is(className)||$html.hasClass(className)){startId=item._id;break}}return startId}});Adapt.once("adapt:start",function(){Adapt.startController.loadCourseData();Adapt.startController.setStartLocation()});Adapt.on("navigation:returnToStart",function(){Adapt.startController.returnToStartLocation()});return Adapt.startController=new StartController});define("core/js/data",["core/js/adapt","core/js/collections/adaptCollection","core/js/models/buildModel","core/js/models/configModel","core/js/models/courseModel","core/js/models/lockingModel","core/js/startController"],function(Adapt,AdaptCollection,BuildModel,ConfigModel,CourseModel){var Data=function(_AdaptCollection){"use strict";_inherits(Data,_AdaptCollection);var _super12=_createSuper(Data);function Data(){_classCallCheck(this,Data);return _super12.apply(this,arguments)}_createClass(Data,[{key:"model",value:function model(json){var ModelClass=Adapt.getModelClass(json);if(!ModelClass){return new Backbone.Model(json)}return new ModelClass(json)}},{key:"init",value:function(){var _init=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:Adapt.build=new BuildModel(null,{url:"adapt/js/build.min.js",reset:true});_context2.next=3;return Adapt.build.whenReady();case 3:$("html").attr("data-adapt-framework-version",Adapt.build.get("package").version);this.loadConfigData();case 5:case"end":return _context2.stop();}}},_callee2,this)}));function init(){return _init.apply(this,arguments)}return init}()},{key:"loadConfigData",value:function loadConfigData(){Adapt.config=new ConfigModel(null,{url:"course/config."+Adapt.build.get("jsonext"),reset:true});this.listenToOnce(Adapt,"configModel:loadCourseData",this.onLoadCourseData);this.listenTo(Adapt.config,{"change:_activeLanguage":this.onLanguageChange,"change:_defaultDirection":this.onDirectionChange})}},{key:"onDirectionChange",value:function onDirectionChange(model,direction){if(direction==="rtl"){$("html").removeClass("dir-ltr").addClass("dir-rtl").attr("dir","rtl")}else{$("html").removeClass("dir-rtl").addClass("dir-ltr").attr("dir","ltr")}}},{key:"onLoadCourseData",value:function onLoadCourseData(){if(!Adapt.config.get("_activeLanguage")){Adapt.config.set("_activeLanguage",Adapt.config.get("_defaultLanguage"));return}this.loadCourseData()}},{key:"onLanguageChange",value:function onLanguageChange(model,language){Adapt.offlineStorage.set("lang",language);this.loadCourseData(language)}},{key:"loadCourseData",value:function(){var _loadCourseData=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(newLanguage){var language,courseFolder;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:language=Adapt.config.get("_activeLanguage");courseFolder="course/"+language+"/";$("html").attr("lang",language);_context3.next=5;return this.loadManifestFiles(courseFolder);case 5:_context3.next=7;return this.triggerDataLoaded();case 7:_context3.next=9;return this.triggerDataReady(newLanguage);case 9:this.triggerInit();case 10:case"end":return _context3.stop();}}},_callee3,this)}));function loadCourseData(_x2){return _loadCourseData.apply(this,arguments)}return loadCourseData}()},{key:"getJSON",value:function getJSON(path){var _this30=this;return new Promise(function(resolve,reject){var _this31=this;_newArrowCheck(this,_this30);$.getJSON(path,function(data){_newArrowCheck(this,_this31);data.__path__=path;resolve(data)}.bind(this)).fail(reject)}.bind(this))}},{key:"loadManifestFiles",value:function(){var _loadManifestFiles=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(languagePath){var _this32=this;var manifestPath,manifest,allFileData,allModelData,course;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.trigger("loading");this.reset();manifestPath=languagePath+"language_data_manifest.js";_context4.prev=3;_context4.next=6;return this.getJSON(manifestPath);case 6:manifest=_context4.sent;_context4.next=13;break;case 9:_context4.prev=9;_context4.t0=_context4["catch"](3);manifest=["course.json","contentObjects.json","articles.json","blocks.json","components.json"];Adapt.log.warnOnce("Manifest path '".concat(manifestPath," not found. Using traditional files: ").concat(manifest.join(", ")));case 13:_context4.next=15;return Promise.all(manifest.map(function(filePath){_newArrowCheck(this,_this32);return this.getJSON("".concat(languagePath).concat(filePath))}.bind(this)));case 15:allFileData=_context4.sent;allModelData=allFileData.reduce(function(result,fileData){_newArrowCheck(this,_this32);if(Array.isArray(fileData)){result.push.apply(result,_toConsumableArray(fileData))}else if(fileData instanceof Object){result.push(fileData)}else{Adapt.log.warnOnce("File data isn't an array or object: ".concat(fileData.__path__))}return result}.bind(this),[]);course=allModelData.find(function(modelData){_newArrowCheck(this,_this32);return modelData._type==="course"}.bind(this));if(course){_context4.next=20;break}throw new Error("Expected a model data with \"_type\": \"course\", none found.");case 20:Adapt.trigger("courseModel:dataLoading");Adapt.course=this.push(course);Adapt.trigger("courseModel:dataLoaded");allModelData.forEach(function(modelData){_newArrowCheck(this,_this32);if(modelData._type==="course"){return}this.push(modelData)}.bind(this));this._byAdaptID=this.indexBy("_id");this.trigger("reset");this.trigger("loaded");_context4.next=29;return Adapt.wait.queue();case 29:case"end":return _context4.stop();}}},_callee4,this,[[3,9]])}));function loadManifestFiles(_x3){return _loadManifestFiles.apply(this,arguments)}return loadManifestFiles}()},{key:"triggerDataLoaded",value:function(){var _triggerDataLoaded=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(){return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:Adapt.log.debug("Firing app:dataLoaded");try{Adapt.trigger("app:dataLoaded")}catch(e){Adapt.log.error("Error during app:dataLoading trigger",e)}_context5.next=4;return Adapt.wait.queue();case 4:case"end":return _context5.stop();}}},_callee5)}));function triggerDataLoaded(){return _triggerDataLoaded.apply(this,arguments)}return triggerDataLoaded}()},{key:"triggerDataReady",value:function(){var _triggerDataReady=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(newLanguage){var _this33=this;return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(newLanguage){Adapt.trigger("app:languageChanged",newLanguage);_.defer(function(){_newArrowCheck(this,_this33);Adapt.startController.loadCourseData();var hash=Adapt.startController.isEnabled()?"#/":Adapt.startController.getStartHash(true);Adapt.router.navigate(hash,{trigger:true,replace:true})}.bind(this))}Adapt.log.debug("Firing app:dataReady");try{Adapt.trigger("app:dataReady")}catch(e){Adapt.log.error("Error during app:dataReady trigger",e)}_context6.next=5;return Adapt.wait.queue();case 5:case"end":return _context6.stop();}}},_callee6,this)}));function triggerDataReady(_x4){return _triggerDataReady.apply(this,arguments)}return triggerDataReady}()},{key:"triggerInit",value:function triggerInit(){this.isReady=true;this.trigger("ready")}},{key:"whenReady",value:function whenReady(){var _this34=this;if(this.isReady)return Promise.resolve();return new Promise(function(resolve){_newArrowCheck(this,_this34);this.once("ready",resolve)}.bind(this))}},{key:"findById",value:function findById(id){var model=this._byAdaptID[id];if(!model){console.warn("Adapt.findById() unable to find collection type for id: ".concat(id));return}return model}}]);return Data}(AdaptCollection);return Adapt.data=new Data});define("core/js/offlineStorage",["core/js/adapt"],function(Adapt){var OfflineStorage=Backbone.Controller.extend({ready:true,_handler:undefined,initialize:function initialize(handler){if(!handler){return}this.ready=false;this._handler=handler},hasHandler:function hasHandler(){return this._handler!==undefined},set:function set(name,value){if(this._handler&&this._handler.set){return this._handler.set.apply(this._handler,arguments)}this[name]=value},get:function get(name){if(this._handler&&this._handler.get){return this._handler.get.apply(this._handler,arguments)}return this[name]},setReadyStatus:function setReadyStatus(){this.ready=true;Adapt.trigger("offlineStorage:ready")}});Adapt.offlineStorage=new OfflineStorage;return Adapt.offlineStorage});define("core/js/enums/completionStateEnum",[],function(){var COMPLETION_STATE=ENUM(["INCOMPLETE","COMPLETED","PASSED","FAILED"]);return COMPLETION_STATE});define("core/js/tracking",["core/js/adapt","core/js/enums/completionStateEnum"],function(Adapt,COMPLETION_STATE){var Tracking=Backbone.Controller.extend({_config:{_requireContentCompleted:true,_requireAssessmentCompleted:false},_assessmentState:null,initialize:function initialize(){Adapt.once("configModel:dataLoaded",this.loadConfig.bind(this));Adapt.on("app:dataReady",this.setupEventListeners.bind(this))},setupEventListeners:function setupEventListeners(){if(this._config._requireAssessmentCompleted){this.listenTo(Adapt,{"assessment:complete":this.onAssessmentComplete,"assessment:restored":this.onAssessmentRestored})}if(this._config._requireContentCompleted){this.listenTo(Adapt.course,"change:_isComplete",this.checkCompletion)}},onAssessmentComplete:function onAssessmentComplete(assessmentState){this._assessmentState=assessmentState;this.checkCompletion()},onAssessmentRestored:function onAssessmentRestored(assessmentState){this._assessmentState=assessmentState},checkCompletion:function checkCompletion(){var completionData=this.getCompletionData();if(completionData.status===COMPLETION_STATE.INCOMPLETE){return}Adapt.trigger("tracking:complete",completionData);Adapt.log.debug("tracking:complete",completionData)},getCompletionData:function getCompletionData(){var completionData={status:COMPLETION_STATE.INCOMPLETE,assessment:null};if(this._config._requireContentCompleted&&!Adapt.course.get("_isComplete")){return completionData}if(this._config._requireAssessmentCompleted){if(!this._assessmentState){return completionData}completionData.status=this._assessmentState.isPass?COMPLETION_STATE.PASSED:COMPLETION_STATE.FAILED;completionData.assessment=this._assessmentState;return completionData}completionData.status=COMPLETION_STATE.COMPLETED;return completionData},loadConfig:function loadConfig(){if(Adapt.config.has("_completionCriteria")){this._config=Adapt.config.get("_completionCriteria")}}});Adapt.tracking=new Tracking;return Adapt.tracking});define("core/js/device",["core/js/adapt","bowser"],function(Adapt,Bowser){var $html=$("html");var $window=$(window);Adapt.device={touch:Modernizr.touchevents,screenWidth:getScreenWidth(),screenHeight:getScreenHeight(),browser:(Bowser.name||"").toLowerCase(),version:(Bowser.version||"").toLowerCase(),OS:getOperatingSystem().toLowerCase(),osVersion:Bowser.osversion||"",renderingEngine:getRenderingEngine()};Object.defineProperties(Adapt.device,{"orientation":{get:function get(){return this.screenWidth>=this.screenHeight?"landscape":"portrait"}},"aspectRatio":{get:function get(){return this.screenWidth/this.screenHeight}}});Adapt.once("app:dataReady",function(){Adapt.device.screenSize=checkScreenSize();$html.addClass("size-"+Adapt.device.screenSize);if(Adapt.device.orientation){$html.addClass("orientation-"+Adapt.device.orientation)}$window.on("resize orientationchange",onWindowResize)});function checkScreenSize(){var screenSizeConfig=Adapt.config.get("screenSize");var screenSize;var screensizeEmThreshold=300;var baseFontSize=16;var mediumEmBreakpoint=screenSizeConfig.medium>screensizeEmThreshold?screenSizeConfig.medium/baseFontSize:screenSizeConfig.medium;var smallEmBreakpoint=screenSizeConfig.small>screensizeEmThreshold?screenSizeConfig.small/baseFontSize:screenSizeConfig.small;var fontSize=parseFloat($("html").css("font-size"));var screenSizeEmWidth=Adapt.device.screenWidth/fontSize;if(screenSizeEmWidth>mediumEmBreakpoint){screenSize="large"}else if(screenSizeEmWidth>smallEmBreakpoint){screenSize="medium"}else{screenSize="small"}return screenSize}function getScreenWidth(){return isAppleDevice()?getAppleScreenWidth():window.innerWidth||$window.width()}function getScreenHeight(){return isAppleDevice()?getAppleScreenHeight():window.innerHeight||$window.height()}function getOperatingSystem(){var os="";var flags=["windows","mac","linux","windowsphone","chromeos","android","ios","blackberry","firefoxos","webos","bada","tizen","sailfish"];for(var i=0;i<flags.length;i++){if(Bowser[flags[i]]){os=flags[i];break}}if(os===""){var platform=navigator.platform;var platforms=["Win","Mac","Linux"];os="PlatformUnknown";for(var j=0;j<platforms.length;j++){if(platform.indexOf(platforms[j])!==-1){os=platforms[j].toLowerCase();break}}if(os==="win"){os="windows"}}return os}function getRenderingEngine(){var engine="";var flags=["webkit","blink","gecko","msie","msedge"];for(var i=0;i<flags.length;i++){if(Bowser[flags[i]]){engine=flags[i];break}}return engine}var onWindowResize=_.debounce(function onScreenSizeChanged(){var previousWidth=Adapt.device.screenWidth;var previousHeight=Adapt.device.screenHeight;Adapt.device.screenWidth=getScreenWidth();Adapt.device.screenHeight=getScreenHeight();if(previousWidth===Adapt.device.screenWidth&&previousHeight===Adapt.device.screenHeight){return}var newScreenSize=checkScreenSize();if(newScreenSize!==Adapt.device.screenSize){Adapt.device.screenSize=newScreenSize;$html.removeClass("size-small size-medium size-large").addClass("size-"+Adapt.device.screenSize);if(Adapt.device.orientation){$html.removeClass("orientation-landscape orientation-portrait").addClass("orientation-"+Adapt.device.orientation)}Adapt.trigger("device:changed",Adapt.device.screenSize)}Adapt.trigger("device:preResize device:resize device:postResize",Adapt.device.screenWidth)},100);function isAppleDevice(){return /iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function getAppleScreenWidth(){return Math.abs(window.orientation)===90?screen.height:screen.width}function getAppleScreenHeight(){return Math.abs(window.orientation)===90?screen.width:screen.height}function getAppleDeviceType(){var type="";var flags=["iphone","ipad","ipod"];for(var i=0;i<flags.length;i++){if(Bowser[flags[i]]){type=flags[i];break}}return type}function pixelDensity(){var pixelDensity=window.devicePixelRatio||1;if(pixelDensity>=3){return"ultra-high"}else if(pixelDensity>=2){return"high"}else if(pixelDensity>=1.5){return"medium"}else{return"low"}}var browser=Adapt.device.browser.toLowerCase();var browserString=browser.replace(/msie|internet explorer/,"ie");browserString=browserString+" version-"+Adapt.device.version+" OS-"+Adapt.device.OS+" "+getAppleDeviceType();browserString+=browserString.replace(".","-").toLowerCase();$html.addClass(browserString+" pixel-density-"+pixelDensity())});define("core/js/views/drawerItemView",["core/js/adapt"],function(Adapt){var DrawerItemView=Backbone.View.extend({className:"drawer__menu drawer__item",attributes:{role:"list"},initialize:function initialize(){this.listenTo(Adapt,"drawer:empty",this.remove);this.render()},events:{"click .drawer__item-btn":"onDrawerItemClicked"},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates["drawerItem"];$(this.el).html(template(data)).appendTo(".drawer__holder");return this},onDrawerItemClicked:function onDrawerItemClicked(event){event.preventDefault();var eventCallback=this.model.get("eventCallback");Adapt.trigger(eventCallback)}},{type:"drawerItem"});return DrawerItemView});define("core/js/views/drawerView",["core/js/adapt","core/js/views/drawerItemView"],function(Adapt,DrawerItemView){var DrawerView=Backbone.View.extend({className:"drawer u-display-none",disableAnimation:false,attributes:{"role":"dialog","aria-modal":"true","aria-labelledby":"drawer-heading","aria-hidden":"true"},initialize:function initialize(){this.disableAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;this._isVisible=false;this.drawerDir="right";if(Adapt.config.get("_defaultDirection")==="rtl"){this.drawerDir="left"}this.setupEventListeners();this.render();this.drawerDuration=Adapt.config.get("_drawer")._duration;this.drawerDuration=this.drawerDuration?this.drawerDuration:400;this.$wrapper=$("#wrapper")},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"navigation:toggleDrawer":this.toggleDrawer,"drawer:triggerCustomView":this.openCustomView,"drawer:closeDrawer":this.onCloseDrawer,"remove":this.onCloseDrawer,"drawer:remove":this.remove});this._onKeyUp=_.bind(this.onKeyUp,this);this.setupEscapeKey()},setupEscapeKey:function setupEscapeKey(){$(window).on("keyup",this._onKeyUp)},onKeyUp:function onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.onCloseDrawer()},events:{"click .drawer__back":"onBackButtonClicked","click .drawer__close":"onCloseClicked"},render:function render(){var template=Handlebars.templates["drawer"];$(this.el).html(template({_globals:Adapt.course.get("_globals")})).prependTo("body");var shadowTemplate=Handlebars.templates["shadow"];$(shadowTemplate()).prependTo("body");_.defer(_.bind(function(){this.postRender()},this));return this},postRender:function postRender(){this.$("a, button, input, select, textarea").attr("tabindex",-1);this.checkIfDrawerIsAvailable()},openCustomView:function openCustomView(view,hasBackButton){this._hasBackButton=hasBackButton;this._isCustomViewVisible=true;Adapt.trigger("drawer:empty");this.showDrawer();this.$(".drawer__holder").html(view)},checkIfDrawerIsAvailable:function checkIfDrawerIsAvailable(){if(this.collection.length===0){$(".js-nav-drawer-btn").addClass("u-display-none");Adapt.trigger("drawer:noItems");return}$(".js-nav-drawer-btn").removeClass("u-display-none")},onBackButtonClicked:function onBackButtonClicked(event){event.preventDefault();this.showDrawer(true)},onCloseClicked:function onCloseClicked(event){event.preventDefault();this.hideDrawer()},onCloseDrawer:function onCloseDrawer($toElement){this.hideDrawer($toElement)},toggleDrawer:function toggleDrawer(){if(this._isVisible&&this._isCustomViewVisible===false){this.hideDrawer()}else{this.showDrawer(true)}},showDrawer:function showDrawer(emptyDrawer){this.$el.removeClass("u-display-none").removeAttr("aria-hidden");if(!this._isVisible){Adapt.a11y.popupOpened(this.$el);Adapt.a11y.scrollDisable("body");this._isVisible=true}this.$("a, button, input, select, textarea").attr("tabindex",0);if(emptyDrawer){this.$(".drawer__back").addClass("u-display-none");this._isCustomViewVisible=false;this.emptyDrawer();if(this.collection.models.length===1){Adapt.trigger(this.collection.models[0].get("eventCallback"));this._isCustomViewVisible=false}else{this.renderItems();Adapt.trigger("drawer:openedItemView")}}else{if(this._hasBackButton&&this.collection.models.length>1){this.$(".drawer__back").removeClass("u-display-none")}else{this.$(".drawer__back").addClass("u-display-none")}Adapt.trigger("drawer:openedCustomView")}var direction={};if(this.disableAnimation){$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);direction[this.drawerDir]=0;this.$el.css(direction);complete.call(this)}else{$(".js-shadow").velocity({opacity:1},{duration:this.drawerDuration,begin:_.bind(function(){$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);complete.call(this)},this)});var showEasingAnimation=Adapt.config.get("_drawer")._showEasing;var easing=showEasingAnimation||"easeOutQuart";direction[this.drawerDir]=0;this.$el.velocity(direction,this.drawerDuration,easing)}function complete(){this.addShadowEvent();Adapt.trigger("drawer:opened");Adapt.a11y.focusFirst(this.$el,{defer:true})}},emptyDrawer:function emptyDrawer(){this.$(".drawer__holder").empty()},renderItems:function renderItems(){Adapt.trigger("drawer:empty");this.emptyDrawer();var models=this.collection.models;for(var i=0,len=models.length;i<len;i++){var item=models[i];new DrawerItemView({model:item})}},hideDrawer:function hideDrawer($toElement){var direction={};if(this._isVisible){Adapt.a11y.popupClosed($toElement);this._isVisible=false;Adapt.a11y.scrollEnable("body")}else{return}if(this.disableAnimation){direction[this.drawerDir]=-this.$el.width();this.$el.css(direction).addClass("u-display-none").attr("aria-hidden","true");$(".js-shadow").addClass("u-display-none");Adapt.trigger("drawer:closed")}else{var showEasingAnimation=Adapt.config.get("_drawer")._hideEasing;var easing=showEasingAnimation||"easeOutQuart";direction[this.drawerDir]=-this.$el.width();this.$el.velocity(direction,this.drawerDuration,easing,_.bind(function(){this.$el.addClass("u-display-none").attr("aria-hidden","true");Adapt.trigger("drawer:closed")},this));$(".js-shadow").velocity({opacity:0},{duration:this.drawerDuration,complete:function complete(){$(".js-shadow").addClass("u-display-none")}})}this._isCustomViewVisible=false;this.removeShadowEvent()},addShadowEvent:function addShadowEvent(){$(".js-shadow").one("click touchstart",function(){this.onCloseDrawer()}.bind(this))},removeShadowEvent:function removeShadowEvent(){$(".js-shadow").off("click touchstart")},remove:function remove(){Backbone.View.prototype.remove.apply(this,arguments);$(window).off("keyup",this._onKeyUp);Adapt.trigger("drawer:empty");this.collection.reset();$(".js-shadow").remove()}},{childContainer:".js-drawer-holder",childView:DrawerItemView});return DrawerView});define("core/js/drawer",["core/js/adapt","core/js/views/drawerView"],function(Adapt,DrawerView){var DrawerCollection=new Backbone.Collection(null,{comparator:"drawerOrder"});var Drawer={};Drawer.addItem=function(drawerObject,eventCallback){drawerObject.eventCallback=eventCallback;DrawerCollection.add(drawerObject)};Drawer.triggerCustomView=function(view,hasBackButton){if(hasBackButton!==false){hasBackButton=true}Adapt.trigger("drawer:triggerCustomView",view,hasBackButton)};Adapt.on({"adapt:start":function adaptStart(){new DrawerView({collection:DrawerCollection})},"app:languageChanged":function appLanguageChanged(){Adapt.trigger("drawer:remove")}});Adapt.drawer=Drawer});define("core/js/views/notifyPushView",["core/js/adapt"],function(Adapt){var NotifyPushView=Backbone.View.extend({className:function className(){var classes="notify-push ";classes+=this.model.get("_classes")||"";return classes},attributes:{"role":"dialog","aria-labelledby":"notify-push-heading","aria-modal":"false"},initialize:function initialize(){this.listenTo(Adapt,{"notify:pushShown notify:pushRemoved":this.updateIndexPosition,"remove":this.remove});this.listenTo(this.model.collection,{"remove":this.updateIndexPosition,"change:_index":this.updatePushPosition});this.preRender();this.render()},events:{"click .js-notify-push-close-btn":"closePush","click .js-notify-push-inner":"triggerEvent"},preRender:function preRender(){this.hasBeenRemoved=false},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates["notifyPush"];this.$el.html(template(data)).appendTo("#wrapper");_.defer(this.postRender.bind(this));return this},postRender:function postRender(){this.$el.addClass("is-active");_.delay(this.closePush.bind(this),this.model.get("_timeout"));Adapt.trigger("notify:pushShown")},closePush:function closePush(event){if(event){event.preventDefault()}if(this.hasBeenRemoved===false){this.hasBeenRemoved=true;this.$el.removeClass("is-active");_.delay(function(){this.model.collection.remove(this.model);Adapt.trigger("notify:pushRemoved",this);this.remove()}.bind(this),600)}},triggerEvent:function triggerEvent(event){Adapt.trigger(this.model.get("_callbackEvent"));this.closePush()},updateIndexPosition:function updateIndexPosition(){if(!this.hasBeenRemoved){var models=this.model.collection.models;for(var i=0,len=models.length;i<len;i++){var index=i;var model=models[i];if(model.get("_isActive")===true){model.set("_index",index);this.updatePushPosition()}}}},updatePushPosition:function updatePushPosition(){if(this.hasBeenRemoved){return}if(typeof this.model.get("_index")!=="undefined"){var elementHeight=this.$el.height();var offset=20;var navigationHeight=$(".nav").height();var currentIndex=this.model.get("_index");var flippedIndex=currentIndex===0?1:0;if(this.model.collection.where({_isActive:true}).length===1){flippedIndex=0}var positionLowerPush=(elementHeight+offset)*flippedIndex+navigationHeight+offset;this.$el.css("top",positionLowerPush)}}});return NotifyPushView});define("core/js/models/notifyModel",[],function(){var NotifyModel=Backbone.Model.extend({defaults:{_isActive:false,_showIcon:false,_timeout:3000}});return NotifyModel});define("core/js/collections/notifyPushCollection",["core/js/adapt","core/js/views/notifyPushView","core/js/models/notifyModel"],function(Adapt,NotifyPushView,NotifyModel){var NotifyPushCollection=Backbone.Collection.extend({model:NotifyModel,initialize:function initialize(){this.listenTo(this,"add",this.onPushAdded);this.listenTo(Adapt,"notify:pushRemoved",this.onRemovePush)},onPushAdded:function onPushAdded(model){this.checkPushCanShow(model)},checkPushCanShow:function checkPushCanShow(model){if(this.canShowPush()){model.set("_isActive",true);this.showPush(model)}},canShowPush:function canShowPush(){var availablePushNotifications=this.where({_isActive:true});if(availablePushNotifications.length>=2){return false}return true},showPush:function showPush(model){new NotifyPushView({model:model})},onRemovePush:function onRemovePush(view){var inactivePushNotifications=this.where({_isActive:false});if(inactivePushNotifications.length>0){this.checkPushCanShow(inactivePushNotifications[0])}}});return NotifyPushCollection});define("core/js/views/notifyView",["core/js/adapt"],function(Adapt){var NotifyView=Backbone.View.extend({className:function className(){var classes="notify ";classes+=this.model.get("_classes")||"";return classes},attributes:function attributes(){return Object.assign({"role":"dialog","aria-labelledby":"notify-heading","aria-modal":"true"},this.model.get("_attributes"))},disableAnimation:false,isOpen:false,hasOpened:false,initialize:function initialize(){_.bindAll(this,"resetNotifySize");this.disableAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;this.setupEventListeners();this.render()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"remove page:scrollTo":this.closeNotify,"notify:resize":this.resetNotifySize,"notify:cancel":this.cancelNotify,"notify:close":this.closeNotify,"device:resize":this.resetNotifySize});this._onKeyUp=this.onKeyUp.bind(this);this.setupEscapeKey()},setupEscapeKey:function setupEscapeKey(){$(window).on("keyup",this._onKeyUp)},onKeyUp:function onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.cancelNotify()},events:{"click .js-notify-btn-alert":"onAlertButtonClicked","click .js-notify-btn-prompt":"onPromptButtonClicked","click .js-notify-close-btn":"onCloseButtonClicked","click .js-notify-shadow-click":"onShadowClicked"},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates.notify;this.$el.css("visibility","hidden");this.$el.html(template(data)).prependTo("body");this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","visible");this.showNotify();return this},onAlertButtonClicked:function onAlertButtonClicked(event){event.preventDefault();this.closeNotify();Adapt.trigger(this.model.get("_callbackEvent"),this)},onPromptButtonClicked:function onPromptButtonClicked(event){event.preventDefault();this.closeNotify();Adapt.trigger($(event.currentTarget).attr("data-event"),this)},onCloseButtonClicked:function onCloseButtonClicked(event){event.preventDefault();this.cancelNotify()},onShadowClicked:function onShadowClicked(event){event.preventDefault();if(this.model.get("_closeOnShadowClick")===false)return;this.cancelNotify()},cancelNotify:function cancelNotify(){if(this.model.get("_isCancellable")===false)return;this.closeNotify();Adapt.trigger("notify:cancelled",this)},resetNotifySize:function resetNotifySize(){if(!this.hasOpened)return;$(".notify__popup").removeAttr("style").css({visibility:"visible",opacity:1});this.resizeNotify()},resizeNotify:function resizeNotify(){var windowHeight=$(window).height();var notifyHeight=this.$(".notify__popup").outerHeight();if(notifyHeight>=windowHeight){this.$(".notify__popup").css({"height":"100%","top":0,"overflow-y":"scroll","-webkit-overflow-scrolling":"touch"})}else{this.$(".notify__popup").css({"margin-top":-(notifyHeight/2)})}},showNotify:function showNotify(){this.isOpen=true;this.addSubView();this.$previousActiveElement=$(document.activeElement);Adapt.trigger("notify:opened",this);this.$el.imageready(this.onLoaded.bind(this))},onLoaded:function onLoaded(){if(this.disableAnimation){this.$(".notify__shadow").css("display","block")}else{this.$(".notify__shadow").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:function(){this.$(".notify__shadow").css("display","block")}.bind(this)})}this.resizeNotify();if(this.disableAnimation){this.$(".notify__popup").css("visibility","visible");this.onOpened()}else{this.$(".notify__popup").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:function(){this.$(".notify__popup").css("visibility","visible");this.onOpened()}.bind(this)})}},onOpened:function onOpened(){this.hasOpened=true;Adapt.a11y.popupOpened(this.$(".notify__popup"));Adapt.a11y.scrollDisable("body");$("html").addClass("notify");Adapt.a11y.focusFirst(this.$(".notify__popup"),{defer:false})},addSubView:function addSubView(){this.subView=this.model.get("_view");if(!this.subView)return;this.subView.$el.on("resize",this.resetNotifySize);this.$(".notify__content-inner").append(this.subView.$el)},closeNotify:function closeNotify(event){if(!this.isOpen)return;this.isOpen=false;if(!this.hasOpened){this.listenToOnce(Adapt,"popup:opened",function(){_.defer(this.onCloseReady.bind(this))})}else{this.onCloseReady()}},onCloseReady:function onCloseReady(){if(this.disableAnimation){this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","hidden");this.remove()}else{this.$(".notify__popup").velocity({opacity:0},{duration:400,complete:function(){this.$(".notify__popup").css("visibility","hidden")}.bind(this)});this.$(".notify__shadow").velocity({opacity:0},{duration:400,complete:function(){this.$el.css("visibility","hidden");this.remove()}.bind(this)})}Adapt.a11y.scrollEnable("body");$("html").removeClass("notify");Adapt.a11y.popupClosed(this.$previousActiveElement);Adapt.trigger("notify:closed",this)},remove:function remove(){this.removeSubView();$(window).off("keyup",this._onKeyUp);Backbone.View.prototype.remove.apply(this,arguments)},removeSubView:function removeSubView(){if(!this.subView)return;this.subView.$el.off("resize",this.resetNotifySize);this.subView.remove();this.subView=null}});return NotifyView});define("core/js/notify",["core/js/adapt","core/js/collections/notifyPushCollection","core/js/views/notifyView","core/js/models/notifyModel"],function(Adapt,NotifyPushCollection,NotifyView,NotifyModel){var Notify=Backbone.Controller.extend({notifyPushes:null,_warnFirstOnly:true,_warn:true,_hasWarned:false,initialize:function initialize(){this.notifyPushes=new NotifyPushCollection;this.listenTo(Adapt,{"notify:popup":this._deprecated.bind(this,"popup"),"notify:alert":this._deprecated.bind(this,"alert"),"notify:prompt":this._deprecated.bind(this,"prompt"),"notify:push":this._deprecated.bind(this,"push")})},_deprecated:function _deprecated(type,notifyObject){if(this._warn&&this._warnFirstOnly&&!this._hasWarned){Adapt.log.warn("NOTIFY DEPRECATED: Adapt.trigger('notify:"+type+"', notifyObject); is no longer supported, please use Adapt.notify."+type+"(notifyObject);");this._hasWarned=true}return this.create(notifyObject,{_type:type})},create:function create(notifyObject,defaults){notifyObject=_.defaults({},notifyObject,defaults,{_type:"popup",_isCancellable:true,_showCloseButton:true,_closeOnShadowClick:true});if(notifyObject._type==="push"){this.notifyPushes.push(notifyObject);return}return new NotifyView({model:new NotifyModel(notifyObject)})},popup:function popup(notifyObject){return this.create(notifyObject,{_type:"popup"})},alert:function alert(notifyObject){return this.create(notifyObject,{_type:"alert"})},prompt:function prompt(notifyObject){return this.create(notifyObject,{_type:"prompt"})},push:function push(notifyObject){return this.create(notifyObject,{_type:"push"})}});return Adapt.notify=new Notify});define("core/js/models/routerModel",["core/js/adapt"],function(Adapt){var RouterModel=function(_Backbone$Model5){"use strict";_inherits(RouterModel,_Backbone$Model5);var _super13=_createSuper(RouterModel);function RouterModel(){_classCallCheck(this,RouterModel);return _super13.apply(this,arguments)}_createClass(RouterModel,[{key:"defaults",value:function defaults(){return{_canNavigate:true,_shouldNavigateFocus:true}}},{key:"lockedAttributes",value:function lockedAttributes(){return{_canNavigate:false,_shouldNavigateFocus:false}}}]);return RouterModel}(Backbone.Model);return RouterModel});define("core/js/router",["core/js/adapt","core/js/models/routerModel","core/js/models/courseModel","core/js/models/contentObjectModel","core/js/models/menuModel","core/js/startController"],function(Adapt,RouterModel,CourseModel,ContentObjectModel,MenuModel){var Router=function(_Backbone$Router){"use strict";_inherits(Router,_Backbone$Router);var _super14=_createSuper(Router);function Router(){_classCallCheck(this,Router);return _super14.apply(this,arguments)}_createClass(Router,[{key:"routes",value:function routes(){return{"":"handleRoute","id/:id":"handleRoute",":pluginName(/*location)(/*action)":"handleRoute"}}},{key:"initialize",value:function initialize(_ref4){var model=_ref4.model;this.model=model;this._navigationRoot=null;this._isCircularNavigationInProgress=false;this.showLoading();this.$wrapper=$("#wrapper");this.$html=$("html");this.listenToOnce(Adapt,"app:dataReady",this.setDocumentTitle);this.listenTo(Adapt,"router:navigateTo",this.navigateToArguments)}},{key:"showLoading",value:function showLoading(){$(".js-loading").show()}},{key:"hideLoading",value:function hideLoading(){$(".js-loading").hide()}},{key:"setDocumentTitle",value:function setDocumentTitle(){var _this35=this;var currentModel=Adapt.location._currentModel;var hasSubTitle=currentModel&&currentModel!==Adapt.router.rootModel&&currentModel.get("title");var title=[this.rootModel.get("title"),hasSubTitle&&currentModel.get("title")].filter(Boolean).join(" | ");this.listenToOnce(Adapt,"contentObjectView:preRender",function(){_newArrowCheck(this,_this35);var escapedTitle=$("<div>".concat(title,"</div>")).text();document.title=escapedTitle}.bind(this))}},{key:"navigateToArguments",value:function navigateToArguments(args){var _this36=this;args=args.filter(function(v){_newArrowCheck(this,_this36);return v!==null}.bind(this));var options={trigger:false,replace:false};if(args.length===1&&Adapt.findById(args[0])){this.navigate("#/id/"+args[0],options);return}if(args.length<=3){this.navigate("#/"+args.join("/"),options);return}Adapt.log.deprecated("Use Backbone.history.navigate or window.location.href instead of Adapt.trigger('router:navigateTo')");this.handleRoute.apply(this,_toConsumableArray(args))}},{key:"handleRoute",value:function handleRoute(){var _this37=this;for(var _len13=arguments.length,args=new Array(_len13),_key13=0;_key13<_len13;_key13++){args[_key13]=arguments[_key13]}args=args.filter(function(v){_newArrowCheck(this,_this37);return v!==null}.bind(this));if(this.model.get("_canNavigate")){this._isCircularNavigationInProgress=false}if(this._isCircularNavigationInProgress===false){Adapt.trigger("router:navigate",args)}if(this.model.get("_canNavigate")){this.model.set("_canNavigate",false,{pluginName:"adapt"});if(args.length<=1){return this.handleId.apply(this,_toConsumableArray(args))}return this.handlePluginRouter.apply(this,_toConsumableArray(args))}if(this._isCircularNavigationInProgress){this._isCircularNavigationInProgress=false;return}this._isCircularNavigationInProgress=true;Adapt.trigger("router:navigationCancelled",args);this.navigateToCurrentRoute(true)}},{key:"handlePluginRouter",value:function(){var _handlePluginRouter=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(pluginName,location,action){var pluginLocation;return regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:pluginLocation=[pluginName,location&&"-".concat(location),action&&"-".concat(action)].filter(Boolean).join("");_context7.next=3;return this.updateLocation(pluginLocation,null,null,null);case 3:Adapt.trigger("router:plugin:"+pluginName,pluginName,location,action);Adapt.trigger("router:plugin",pluginName,location,action);this.model.set("_canNavigate",true,{pluginName:"adapt"});case 6:case"end":return _context7.stop();}}},_callee7,this)}));function handlePluginRouter(_x5,_x6,_x7){return _handlePluginRouter.apply(this,arguments)}return handlePluginRouter}()},{key:"handleId",value:function(){var _handleId=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(id){var _this38=this;var rootModel,model,isContentObject,isRoot,startController,isCourse,type,location,ViewClass,isMenu;return regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:rootModel=Adapt.router.rootModel;model=!id?rootModel:Adapt.findById(id);if(model){_context8.next=5;break}this.model.set("_canNavigate",true,{pluginName:"adapt"});return _context8.abrupt("return");case 5:id=model.get("_id");isContentObject=model instanceof ContentObjectModel;if(isContentObject){_context8.next=11;break}this.model.set("_canNavigate",true,{pluginName:"adapt"});Adapt.navigateToElement("."+id,{replace:true});return _context8.abrupt("return");case 11:isRoot=model===rootModel;if(!(isRoot&&Adapt.course.has("_start"))){_context8.next=16;break}startController=Adapt.course.get("_start");if(!(startController._isEnabled===true&&startController._isMenuDisabled===true)){_context8.next=16;break}return _context8.abrupt("return");case 16:if(!(model.get("_isLocked")&&Adapt.config.get("_forceRouteLocking"))){_context8.next=22;break}Adapt.log.warn("Unable to navigate to locked id: "+id);this.model.set("_canNavigate",true,{pluginName:"adapt"});if(!(Adapt.location._previousId===undefined)){_context8.next=21;break}return _context8.abrupt("return",this.navigate("#/",{trigger:true,replace:true}));case 21:return _context8.abrupt("return",this.navigateBack());case 22:this.showLoading();_context8.next=25;return Adapt.remove();case 25:isCourse=model instanceof CourseModel;type=isCourse?"menu":model.get("_type");location=isCourse?"course":"".concat(type,"-").concat(id);model.set("_isVisited",true);_context8.next=31;return this.updateLocation(location,type,id,model);case 31:Adapt.once("contentObjectView:ready",function(){_newArrowCheck(this,_this38);this.model.set("_canNavigate",true,{pluginName:"adapt"});this.handleNavigationFocus()}.bind(this));Adapt.trigger("router:".concat(type," router:contentObject"),model);ViewClass=Adapt.getViewClass(model);isMenu=model instanceof MenuModel;if(!(!ViewClass&&isMenu)){_context8.next=38;break}Adapt.log.deprecated("Using event based menu view instantiation for '".concat(Adapt.getViewName(model),"'"));return _context8.abrupt("return");case 38:this.$wrapper.append(new ViewClass({model:model}).$el);case 39:case"end":return _context8.stop();}}},_callee8,this)}));function handleId(_x8){return _handleId.apply(this,arguments)}return handleId}()},{key:"updateLocation",value:function(){var _updateLocation=_asyncToGenerator(regeneratorRuntime.mark(function _callee9(currentLocation,type,id,currentModel){return regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:Adapt.location._previousModel=Adapt.location._currentModel;Adapt.location._previousId=Adapt.location._currentId;Adapt.location._previousContentType=Adapt.location._contentType;Adapt.location._currentModel=currentModel;Adapt.location._currentId=id;Adapt.location._contentType=type;Adapt.location._currentLocation=currentLocation;if(type==="menu"){Adapt.location._lastVisitedType="menu";Adapt.location._lastVisitedMenu=id}else if(type==="page"){Adapt.location._lastVisitedType="page";Adapt.location._lastVisitedPage=id}this.setDocumentTitle();this.setGlobalClasses();Adapt.trigger("router:location",Adapt.location);_context9.next=13;return Adapt.wait.queue();case 13:case"end":return _context9.stop();}}},_callee9,this)}));function updateLocation(_x9,_x10,_x11,_x12){return _updateLocation.apply(this,arguments)}return updateLocation}()},{key:"setGlobalClasses",value:function setGlobalClasses(){var currentModel=Adapt.location._currentModel;var htmlClasses=currentModel&&currentModel.get("_htmlClasses")||"";var classes=Adapt.location._currentId?"location-".concat(Adapt.location._contentType," location-id-").concat(Adapt.location._currentId):"location-".concat(Adapt.location._currentLocation);var currentClasses="".concat(classes," ").concat(htmlClasses);this.$html.removeClass(Adapt.location._previousClasses).addClass(currentClasses).attr("data-location",Adapt.location._currentLocation);this.$wrapper.removeClass().addClass(classes).attr("data-location",Adapt.location._currentLocation);Adapt.location._previousClasses=currentClasses}},{key:"handleNavigationFocus",value:function handleNavigationFocus(){if(!this.model.get("_shouldNavigateFocus"))return;Adapt.a11y.focus("body")}},{key:"navigateBack",value:function navigateBack(){Backbone.history.history.back()}},{key:"navigateToCurrentRoute",value:function navigateToCurrentRoute(force){if(!this.model.get("_canNavigate")&&!force){return}if(!Adapt.location._currentId){return}var currentId=Adapt.location._currentModel.get("_id");var isRoot=Adapt.location._currentModel===this.rootModel;var route=isRoot?"#/":"#/id/"+currentId;this.navigate(route,{trigger:true,replace:true})}},{key:"navigateToPreviousRoute",value:function navigateToPreviousRoute(force){if(!this.model.get("_canNavigate")&&!force){return}var currentModel=Adapt.location._currentModel;var previousModel=Adapt.location._previousModel;if(!currentModel){return this.navigateBack()}if(Adapt.location._currentModel instanceof MenuModel){return this.navigateToParent()}if(previousModel){return this.navigateBack()}this.navigateToParent()}},{key:"navigateToParent",value:function navigateToParent(force){if(!this.model.get("_canNavigate")&&!force){return}var parentId=Adapt.location._currentModel.get("_parentId");var parentModel=Adapt.findById(parentId);var isRoot=parentModel===this.rootModel;var route=isRoot?"#/":"#/id/"+parentId;this.navigate(route,{trigger:true})}},{key:"navigateToHomeRoute",value:function navigateToHomeRoute(force){if(!this.model.get("_canNavigate")&&!force){return}this.navigate("#/",{trigger:true})}},{key:"navigateToElement",value:function navigateToElement(selector){var _this39=this;var settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var currentModelId=selector.replace(/\./g,"");var currentModel=Adapt.findById(currentModelId);if(!currentModel)return;var currentPage=currentModel instanceof ContentObjectModel?currentModel:currentModel.findAncestor("contentObjects");var pageId=currentPage.get("_id");if(pageId===Adapt.location._currentId){return Adapt.scrollTo(selector,settings)}Adapt.once("contentObjectView:ready",_.debounce(function(){_newArrowCheck(this,_this39);this.model.set("_shouldNavigateFocus",true,{pluginName:"adapt"});Adapt.scrollTo(selector,settings)}.bind(this),1));var shouldReplaceRoute=settings.replace||false;this.model.set("_shouldNavigateFocus",false,{pluginName:"adapt"});this.navigate("#/id/"+pageId,{trigger:true,replace:shouldReplaceRoute})}},{key:"get",value:function get(){var _this$model;Adapt.log.deprecated("Adapt.router.get, please use Adapt.router.model.get");return(_this$model=this.model).get.apply(_this$model,arguments)}},{key:"set",value:function set(){var _this$model2;Adapt.log.deprecated("Adapt.router.set, please use Adapt.router.model.set");return(_this$model2=this.model).set.apply(_this$model2,arguments)}},{key:"rootModel",get:function get(){return this._navigationRoot||Adapt.course},set:function set(model){this._navigationRoot=model}}]);return Router}(Backbone.Router);Adapt.router=new Router({model:new RouterModel(null,{reset:true})});Adapt.navigateToElement=Adapt.router.navigateToElement.bind(Adapt.router);return Adapt.router});define("core/js/collections/adaptSubsetCollection",["core/js/adapt","./adaptCollection"],function(Adapt,AdaptCollection){var AdaptSubsetCollection=function(_AdaptCollection2){"use strict";_inherits(AdaptSubsetCollection,_AdaptCollection2);var _super15=_createSuper(AdaptSubsetCollection);function AdaptSubsetCollection(){_classCallCheck(this,AdaptSubsetCollection);return _super15.apply(this,arguments)}_createClass(AdaptSubsetCollection,[{key:"initialize",value:function initialize(models,options){_get(_getPrototypeOf(AdaptSubsetCollection.prototype),"initialize",this).call(this,models,options);this.parent=options.parent;this.listenTo(this.parent,"reset",this.loadSubset)}},{key:"loadSubset",value:function loadSubset(){var _this40=this;this.set(this.parent.filter(function(model){_newArrowCheck(this,_this40);return model instanceof this.model}.bind(this)));this._byAdaptID=this.groupBy("_id")}}]);return AdaptSubsetCollection}(AdaptCollection);return AdaptSubsetCollection});define("core/js/models/pageModel",["core/js/adapt","core/js/models/contentObjectModel"],function(Adapt,ContentObjectModel){var PageModel=function(_ContentObjectModel2){"use strict";_inherits(PageModel,_ContentObjectModel2);var _super16=_createSuper(PageModel);function PageModel(){_classCallCheck(this,PageModel);return _super16.apply(this,arguments)}_createClass(PageModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"page"}},{key:"_children",get:function get(){Adapt.log.deprecated("pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"articles"}}]);return PageModel}(ContentObjectModel);Adapt.register("page",{model:PageModel});return PageModel});define("core/js/models/articleModel",["core/js/adapt","core/js/models/adaptModel"],function(Adapt,AdaptModel){var ArticleModel=function(_AdaptModel2){"use strict";_inherits(ArticleModel,_AdaptModel2);var _super17=_createSuper(ArticleModel);function ArticleModel(){_classCallCheck(this,ArticleModel);return _super17.apply(this,arguments)}_createClass(ArticleModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"article"}},{key:"_parent",get:function get(){Adapt.log.deprecated("articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON");return"contentObjects"}},{key:"_siblings",get:function get(){Adapt.log.deprecated("articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON");return"articles"}},{key:"_children",get:function get(){Adapt.log.deprecated("articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON");return"blocks"}}]);return ArticleModel}(AdaptModel);Adapt.register("article",{model:ArticleModel});return ArticleModel});define("core/js/models/blockModel",["core/js/adapt","core/js/models/adaptModel"],function(Adapt,AdaptModel){var BlockModel=function(_AdaptModel3){"use strict";_inherits(BlockModel,_AdaptModel3);var _super18=_createSuper(BlockModel);function BlockModel(){_classCallCheck(this,BlockModel);return _super18.apply(this,arguments)}_createClass(BlockModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"block"}},{key:"_parent",get:function get(){Adapt.log.deprecated("blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON");return"articles"}},{key:"_siblings",get:function get(){Adapt.log.deprecated("blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON");return"blocks"}},{key:"_children",get:function get(){Adapt.log.deprecated("blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON");return"components"}}]);return BlockModel}(AdaptModel);Adapt.register("block",{model:BlockModel});return BlockModel});define("core/js/models/componentModel",["core/js/adapt","core/js/models/adaptModel"],function(Adapt,AdaptModel){var ComponentModel=function(_AdaptModel4){"use strict";_inherits(ComponentModel,_AdaptModel4);var _super19=_createSuper(ComponentModel);function ComponentModel(){_classCallCheck(this,ComponentModel);return _super19.apply(this,arguments)}_createClass(ComponentModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"component"}},{key:"defaults",value:function defaults(){return AdaptModel.resultExtend("defaults",{_isA11yComponentDescriptionEnabled:true})}},{key:"trackable",value:function trackable(){return AdaptModel.resultExtend("trackable",["_userAnswer"])}},{key:"_parent",get:function get(){Adapt.log.deprecated("componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON");return"blocks"}},{key:"_siblings",get:function get(){Adapt.log.deprecated("componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON");return"components"}},{key:"hasManagedChildren",get:function get(){return false}}]);return ComponentModel}(AdaptModel);Adapt.register("component",{model:ComponentModel});return ComponentModel});define("core/js/views/adaptView",["core/js/adapt"],function(Adapt){var AdaptView=function(_Backbone$View){"use strict";_inherits(AdaptView,_Backbone$View);var _super20=_createSuper(AdaptView);function AdaptView(){_classCallCheck(this,AdaptView);return _super20.apply(this,arguments)}_createClass(AdaptView,[{key:"attributes",value:function attributes(){return{"data-adapt-id":this.model.get("_id")}}},{key:"initialize",value:function initialize(){this.listenTo(this.model,{"change:_isVisible":this.toggleVisibility,"change:_isHidden":this.toggleHidden,"change:_isComplete":this.onIsCompleteChange});this.model.set({"_globals":Adapt.course.get("_globals"),"_isReady":false});this._isRemoved=false;if(Adapt.location._currentId===this.model.get("_id")){Adapt.parentView=this}this.preRender();this.render();this.setupOnScreenHandler()}},{key:"preRender",value:function preRender(){}},{key:"postRender",value:function postRender(){this.addChildren()}},{key:"render",value:function render(){var _this41=this;var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRender view:preRender"),this);var data=this.model.toJSON();data.view=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data));Adapt.trigger("".concat(type,"View:render view:render"),this);_.defer(function(){_newArrowCheck(this,_this41);if(this._isRemoved)return;this.postRender();Adapt.trigger("".concat(type,"View:postRender view:postRender"),this)}.bind(this));return this}},{key:"setupOnScreenHandler",value:function setupOnScreenHandler(){var _this42=this;var onscreen=this.model.get("_onScreen");if(!onscreen||!onscreen._isEnabled)return;this.$el.addClass("has-animation ".concat(onscreen._classes,"-before"));this.$el.on("onscreen.adaptView",function(e,m){_newArrowCheck(this,_this42);if(!m.onscreen)return;var minVerticalInview=onscreen._percentInviewVertical||33;if(m.percentInviewVertical<minVerticalInview)return;this.$el.addClass("".concat(onscreen._classes,"-after")).off("onscreen.adaptView")}.bind(this))}},{key:"addChildren",value:function addChildren(){var _this43=this;var nthChild=0;var _this$model$getChildr=this.model.getChildren(),models=_this$model$getChildr.models;this.childViews={};models.forEach(function(model){_newArrowCheck(this,_this43);if(!model.get("_isAvailable"))return;nthChild++;model.set("_nthChild",nthChild);var ChildView=this.constructor.childView||Adapt.getViewClass(model);if(!ChildView){throw new Error("The component '".concat(model.attributes._id,"' ('").concat(model.attributes._component,"') has not been installed, and so is not available in your project."))}var $parentContainer=this.$(this.constructor.childContainer);var childView=new ChildView({model:model});this.childViews[model.get("_id")]=childView;$parentContainer.append(childView.$el)}.bind(this))}},{key:"findDescendantViews",value:function findDescendantViews(isParentFirst){var _this44=this;var descendants=[];this.childViews&&_.each(this.childViews,function(view){_newArrowCheck(this,_this44);if(isParentFirst)descendants.push(view);var children=view.findDescendantViews&&view.findDescendantViews(isParentFirst);if(children)descendants.push.apply(descendants,_toConsumableArray(children));if(!isParentFirst)descendants.push(view)}.bind(this));return descendants}},{key:"setReadyStatus",value:function setReadyStatus(){this.model.set("_isReady",true)}},{key:"setCompletionStatus",value:function setCompletionStatus(){if(!this.model.get("_isVisible"))return;this.model.set({_isComplete:true,_isInteractionComplete:true})}},{key:"resetCompletionStatus",value:function resetCompletionStatus(type){var _this45=this;if(!this.model.get("_canReset"))return;var descendantComponents=this.model.findDescendantModels("components");if(descendantComponents.length===0){this.model.reset(type)}else{descendantComponents.forEach(function(model){_newArrowCheck(this,_this45);return model.reset(type)}.bind(this))}}},{key:"preRemove",value:function preRemove(){var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRemove view:preRemove"),this)}},{key:"remove",value:function remove(){var _this46=this;var type=this.constructor.type;this.preRemove();Adapt.trigger("".concat(type,"View:remove view:remove"),this);this._isRemoved=true;Adapt.wait.for(function(end){var _this47=this;_newArrowCheck(this,_this46);this.$el.off("onscreen.adaptView");_get(_getPrototypeOf(AdaptView.prototype),"remove",this).call(this);_.defer(function(){_newArrowCheck(this,_this47);Adapt.trigger("".concat(type,"View:postRemove view:postRemove"),this)}.bind(this));end()}.bind(this));return this}},{key:"setVisibility",value:function setVisibility(){return this.model.get("_isVisible")?"":"u-visibility-hidden"}},{key:"toggleVisibility",value:function toggleVisibility(){this.$el.toggleClass("u-visibility-hidden",!this.model.get("_isVisible"))}},{key:"setHidden",value:function setHidden(){return this.model.get("_isHidden")?"u-display-none":""}},{key:"toggleHidden",value:function toggleHidden(){this.$el.toggleClass("u-display-none",this.model.get("_isHidden"))}},{key:"onIsCompleteChange",value:function onIsCompleteChange(model,isComplete){this.$el.toggleClass("is-complete",isComplete)}},{key:"getChildViews",value:function getChildViews(){return this.childViews}}]);return AdaptView}(Backbone.View);AdaptView.className="";return AdaptView});define("core/js/views/contentObjectView",["core/js/adapt","core/js/views/adaptView"],function(Adapt,AdaptView){var ContentObjectView=function(_AdaptView){"use strict";_inherits(ContentObjectView,_AdaptView);var _super21=_createSuper(ContentObjectView);function ContentObjectView(){_classCallCheck(this,ContentObjectView);return _super21.apply(this,arguments)}_createClass(ContentObjectView,[{key:"attributes",value:function attributes(){return AdaptView.resultExtend("attributes",{"role":"main","aria-labelledby":"".concat(this.model.get("_id"),"-heading")},this)}},{key:"className",value:function className(){return[this.constructor.type,"contentobject",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].filter(Boolean).join(" ")}},{key:"preRender",value:function preRender(){$.inview.lock(this.constructor.type+"View");this.disableAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady)}},{key:"render",value:function render(){var _this48=this;var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRender contentObjectView:preRender view:preRender"),this);var data=this.model.toJSON();data.view=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data));Adapt.trigger("".concat(type,"View:render contentObjectView:render view:render"),this);_.defer(function(){_newArrowCheck(this,_this48);if(this._isRemoved)return;this.postRender();Adapt.trigger("".concat(type,"View:postRender contentObjectView:postRender view:postRender"),this)}.bind(this));return this}},{key:"isReady",value:function(){var _isReady=_asyncToGenerator(regeneratorRuntime.mark(function _callee11(){var _this49=this;var type,performIsReady;return regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(!(!this.model.get("_isReady")||this._isTriggeredReady)){_context11.next=2;break}return _context11.abrupt("return");case 2:this._isTriggeredReady=true;type=this.constructor.type;performIsReady=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee10(){var _this50=this;var styleOptions;return regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:Adapt.trigger("".concat(type,"View:preReady contentObjectView:preReady view:preReady"),_this49);_context10.next=3;return Adapt.wait.queue();case 3:$(".js-loading").hide();if(Adapt.get("_shouldContentObjectScrollTop")!==false){$(window).scrollTop(0)}Adapt.trigger("".concat(type,"View:ready contentObjectView:ready view:ready"),_this49);$.inview.unlock("".concat(type,"View"));styleOptions={opacity:1};if(_this49.disableAnimation){_this49.$el.css(styleOptions);$.inview();_.defer(function(){_newArrowCheck(this,_this50);Adapt.trigger("".concat(type,"View:postReady contentObjectView:postReady view:postReady"),_this49)}.bind(this))}else{_this49.$el.velocity(styleOptions,{duration:"fast",complete:function complete(){_newArrowCheck(this,_this50);$.inview();Adapt.trigger("".concat(type,"View:postReady contentObjectView:postReady view:postReady"),_this49)}.bind(this)})}$(window).scroll();case 10:case"end":return _context10.stop();}}},_callee10,this)}));return function performIsReady(){return _ref5.apply(this,arguments)}}();_.defer(performIsReady);case 6:case"end":return _context11.stop();}}},_callee11,this)}));function isReady(){return _isReady.apply(this,arguments)}return isReady}()},{key:"preRemove",value:function preRemove(){var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRemove contentObjectView:preRemove view:preRemove"),this)}},{key:"remove",value:function remove(){var _this51=this;var type=this.constructor.type;this.preRemove();Adapt.trigger("".concat(type,"View:remove contentObjectView:remove view:remove"),this);this._isRemoved=true;Adapt.wait.for(function(end){var _this52=this;_newArrowCheck(this,_this51);this.$el.off("onscreen.adaptView");this.findDescendantViews().reverse().forEach(function(view){_newArrowCheck(this,_this52);view.remove()}.bind(this));this.childViews=[];_get(_getPrototypeOf(ContentObjectView.prototype),"remove",this).call(this);_.defer(function(){_newArrowCheck(this,_this52);Adapt.trigger("".concat(type,"View:postRemove contentObjectView:postRemove view:postRemove"),this);this.trigger("postRemove")}.bind(this));end()}.bind(this));return this}},{key:"destroy",value:function destroy(){this.remove();if(Adapt.parentView===this){Adapt.parentView=null}}}]);return ContentObjectView}(AdaptView);return ContentObjectView});define("core/js/views/pageView",["core/js/adapt","core/js/views/contentObjectView"],function(Adapt,ContentObjectView){var PageView=function(_ContentObjectView){"use strict";_inherits(PageView,_ContentObjectView);var _super22=_createSuper(PageView);function PageView(){_classCallCheck(this,PageView);return _super22.apply(this,arguments)}_createClass(PageView,[{key:"remove",value:function remove(){if(this.$pageLabel){this.$pageLabel.remove()}_get(_getPrototypeOf(PageView.prototype),"remove",this).call(this)}}]);return PageView}(ContentObjectView);Object.assign(PageView,{childContainer:".article__container",type:"page",template:"page"});Adapt.register("page",{view:PageView});return PageView});define("core/js/views/articleView",["core/js/adapt","core/js/views/adaptView"],function(Adapt,AdaptView){var ArticleView=function(_AdaptView2){"use strict";_inherits(ArticleView,_AdaptView2);var _super23=_createSuper(ArticleView);function ArticleView(){_classCallCheck(this,ArticleView);return _super23.apply(this,arguments)}_createClass(ArticleView,[{key:"className",value:function className(){return["article",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}]);return ArticleView}(AdaptView);Object.assign(ArticleView,{childContainer:".block__container",type:"article",template:"article"});Adapt.register("article",{view:ArticleView});return ArticleView});define("core/js/views/blockView",["core/js/adapt","core/js/views/adaptView"],function(Adapt,AdaptView){var BlockView=function(_AdaptView3){"use strict";_inherits(BlockView,_AdaptView3);var _super24=_createSuper(BlockView);function BlockView(){_classCallCheck(this,BlockView);return _super24.apply(this,arguments)}_createClass(BlockView,[{key:"className",value:function className(){return["block",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}]);return BlockView}(AdaptView);Object.assign(BlockView,{childContainer:".component__container",type:"block",template:"block"});Adapt.register("block",{view:BlockView});return BlockView});define("core/js/mpabc",["core/js/adapt","core/js/data","core/js/collections/adaptSubsetCollection","core/js/models/courseModel","core/js/models/contentObjectModel","core/js/models/menuModel","core/js/models/pageModel","core/js/models/articleModel","core/js/models/blockModel","core/js/models/componentModel","core/js/views/pageView","core/js/views/articleView","core/js/views/blockView"],function(Adapt,Data,AdaptSubsetCollection,CourseModel,ContentObjectModel,MenuModel,PageModel,ArticleModel,BlockModel,ComponentModel,PageView,ArticleView,BlockView){var MPABC=function(_Backbone$Controller4){"use strict";_inherits(MPABC,_Backbone$Controller4);var _super25=_createSuper(MPABC);function MPABC(){_classCallCheck(this,MPABC);return _super25.apply(this,arguments)}_createClass(MPABC,[{key:"initialize",value:function initialize(){this.listenTo(Data,{loading:this.waitForDataLoaded,loaded:this.onDataLoaded});this.setupDeprecatedSubsetCollections()}},{key:"waitForDataLoaded",value:function waitForDataLoaded(){Adapt.wait.begin()}},{key:"onDataLoaded",value:function onDataLoaded(){Adapt.wait.end()}},{key:"setupDeprecatedSubsetCollections",value:function setupDeprecatedSubsetCollections(){var _this53=this;var contentObjects=new AdaptSubsetCollection(null,{parent:Data,model:ContentObjectModel});var articles=new AdaptSubsetCollection(null,{parent:Data,model:ArticleModel});var blocks=new AdaptSubsetCollection(null,{parent:Data,model:BlockModel});var components=new AdaptSubsetCollection(null,{parent:Data,model:ComponentModel});Object.defineProperty(Adapt,"contentObjects",{get:function get(){_newArrowCheck(this,_this53);Adapt.log.deprecated("Adapt.contentObjects, please use Adapt.data instead");return contentObjects}.bind(this),set:function set(value){_newArrowCheck(this,_this53);return contentObjects=value}.bind(this)});Object.defineProperty(Adapt,"articles",{get:function get(){_newArrowCheck(this,_this53);Adapt.log.deprecated("Adapt.articles, please use Adapt.data instead");return articles}.bind(this),set:function set(value){_newArrowCheck(this,_this53);return articles=value}.bind(this)});Object.defineProperty(Adapt,"blocks",{get:function get(){_newArrowCheck(this,_this53);Adapt.log.deprecated("Adapt.blocks, please use Adapt.data instead");return blocks}.bind(this),set:function set(value){_newArrowCheck(this,_this53);return blocks=value}.bind(this)});Object.defineProperty(Adapt,"components",{get:function get(){_newArrowCheck(this,_this53);Adapt.log.deprecated("Adapt.components, please use Adapt.data instead");return components}.bind(this),set:function set(value){_newArrowCheck(this,_this53);return components=value}.bind(this)})}}]);return MPABC}(Backbone.Controller);return Adapt.mpabc=new MPABC});define("core/js/helpers",["handlebars","core/js/adapt"],function(Handlebars,Adapt){var defaultAriaLevels={"_menu":1,"_menuGroup":2,"_menuItem":2,"_page":1,"_article":2,"_block":3,"_component":4,"_componentItem":5,"_notify":1};var helpers={lowercase:function lowercase(text){return text.toLowerCase()},capitalise:function capitalise(text){return text.charAt(0).toUpperCase()+text.slice(1)},inc:function inc(index){return index+1},dec:function dec(index){return index-1},odd:function odd(index){return(index+1)%2===0?"even":"odd"},equals:function equals(value,text,block){return helpers.compare.call(this,value,"==",text,block)},compare:function compare(value,operator,text,block){switch(operator){case"===":if(value===text)return block.fn(this);break;case"=":case"==":if(value==text)return block.fn(this);break;case">=":if(value>=text)return block.fn(this);break;case"<=":if(value<=text)return block.fn(this);break;case">":if(value>text)return block.fn(this);break;case"<":if(value<text)return block.fn(this);break;}return block.inverse(this)},math:function math(lvalue,operator,rvalue,options){lvalue=parseFloat(lvalue);rvalue=parseFloat(rvalue);switch(operator){case"+":return lvalue+rvalue;case"-":return lvalue-rvalue;case"*":return lvalue*rvalue;case"/":return lvalue/rvalue;case"%":return lvalue%rvalue;}},any:function any(){var args=Array.prototype.slice.call(arguments,0,-1);var block=Array.prototype.slice.call(arguments,-1)[0];return _.any(args)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},all:function all(){var args=Array.prototype.slice.call(arguments,0,-1);var block=Array.prototype.slice.call(arguments,-1)[0];return _.all(args)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},none:function none(){var args=Array.prototype.slice.call(arguments,0,-1);var block=Array.prototype.slice.call(arguments,-1)[0];return!_.any(args)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},compile:function compile(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();var data=this;if(context){data=!context.data||!context.data.root?context:context.data.root}return Handlebars.compile(template)(data)},compile_a11y_text:function compile_a11y_text(template,context){Adapt.a11y.log.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return helpers.compile.call(this,template,context)},compile_a11y_normalize:function compile_a11y_normalize(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();return Handlebars.helpers.a11y_normalize.call(this,helpers.compile.call(this,template,context))},compile_a11y_remove_breaks:function compile_a11y_remove_breaks(template,context){if(!template){return""}return Handlebars.helpers.a11y_remove_breaks.call(this,helpers.compile.call(this,template,context))},import_globals:function import_globals(context){if(context.data.root._globals){return""}context.data.root._globals=Adapt.course.get("_globals");return""},import_adapt:function import_adapt(context){if(context.data.root.Adapt){return}var adapt=context.data.root.Adapt={};var i,l,name;var directImport=["config","course"];for(i=0,l=directImport.length;i<l;i++){name=directImport[i];adapt[name]=Adapt[name].toJSON()}var indexedImport=["contentObjects","articles","blocks","components"];for(i=0,l=indexedImport.length;i<l;i++){name=indexedImport[i];var importArray=Adapt[name].toJSON();var importIndex={};for(var i1=0,l1=importArray.length;i1<l1;i1++){var item=importArray[i1];importIndex[item._id]=item}adapt[name]=importIndex}return""},component_description:function component_description(override,context){if(!this._isA11yComponentDescriptionEnabled){return}var isNotDefined=!this._globals._components||!this._globals._components["_"+this._component];if(isNotDefined){return}var hasOverride=arguments.length>1;var description;if(hasOverride){description=override;description=helpers.compile(description,context)}else{description=this._globals._components["_"+this._component].ariaRegion;description=helpers.compile(description,override)}if(!description){return}return new Handlebars.SafeString("<div class=\"aria-label\">"+description+"</div>")},a11y_text:function a11y_text(text){Adapt.a11y.log.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_normalize:function a11y_normalize(htmls){return Adapt.a11y.normalize.apply(Adapt.a11y,arguments)},a11y_remove_breaks:function a11y_remove_breaks(htmls){return Adapt.a11y.removeBreaks.apply(Adapt.a11y,arguments)},a11y_aria_label:function a11y_aria_label(htmls){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\">"+values.join(" ")+"</div>")},a11y_aria_label_relative:function a11y_aria_label_relative(htmls){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label relative\">"+values.join(" ")+"</div>")},a11y_aria_image:function a11y_aria_image(texts){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\" role=\"img\" aria-label=\""+values.join(" ")+"\"></div>")},a11y_wrap_focus:function a11y_wrap_focus(){var cfg=Adapt.config.get("_accessibility");if(cfg._isPopupWrapFocusEnabled===false)return"";return new Handlebars.SafeString("<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" role=\"presentation\">&nbsp;</a>")},a11y_attrs_heading:function a11y_attrs_heading(levelOrType){var cfg=Adapt.config.get("_accessibility");var level=1;if(this._ariaLevel){levelOrType=this._ariaLevel}if(isNaN(levelOrType)===false){level=levelOrType}else if(_.isString(levelOrType)){cfg._ariaLevels=cfg._ariaLevels||defaultAriaLevels;if(cfg._ariaLevels&&cfg._ariaLevels["_"+levelOrType]!==undefined){level=cfg._ariaLevels["_"+levelOrType]}}return new Handlebars.SafeString(" role=\"heading\" aria-level=\""+level+"\" ")},a11y_attrs_tabbable:function a11y_attrs_tabbable(){Adapt.a11y.log.deprecated("a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.");return new Handlebars.SafeString(" role=\"region\" tabindex=\"0\" ")},a11y_alt_text:function a11y_alt_text(visible,alternatives){var values=Array.prototype.slice.call(arguments,1,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<span aria-hidden=\"true\">"+visible+"</span><span class=\"aria-label\">"+values.join(" ")+"</span>")}};_.extend(helpers,{if_value_equals:function if_value_equals(){Adapt.a11y.log.deprecated("if_value_equals, use equals instead.");return helpers.equals.apply(this,arguments)},numbers:function numbers(){Adapt.a11y.log.deprecated("numbers, use inc instead.");return helpers.inc.apply(this,arguments)},lowerCase:function lowerCase(){Adapt.a11y.log.deprecated("lowerCase, use lowercase instead.");return helpers.lowercase.apply(this,arguments)}});for(var name in helpers){if(!helpers.hasOwnProperty(name))continue;Handlebars.registerHelper(name,helpers[name])}return helpers});define("core/js/scrolling",["core/js/adapt"],function(Adapt){var Scrolling=function(_Backbone$Controller5){"use strict";_inherits(Scrolling,_Backbone$Controller5);var _super26=_createSuper(Scrolling);function Scrolling(){_classCallCheck(this,Scrolling);return _super26.apply(this,arguments)}_createClass(Scrolling,[{key:"initialize",value:function initialize(){this.$html=null;this.$app=null;this.isLegacyScrolling=true;this._checkApp();Adapt.once("configModel:dataLoaded",this._loadConfig.bind(this))}},{key:"_checkApp",value:function _checkApp(){this.$html=$("html");this.$app=$("#app");if(this.$app.length)return;this.$app=$("<div id=\"app\">");$("body").append(this.$app);this.$app.append($("#wrapper"));Adapt.log.warn("UPDATE - Your html file needs to have #app adding. See https://github.com/adaptlearning/adapt_framework/issues/2168")}},{key:"_loadConfig",value:function _loadConfig(){var config=Adapt.config.get("_scrollingContainer");if(!config||!config._isEnabled)return;var limitTo=config._limitToSelector;var isIncluded=!limitTo||this.$html.is(limitTo)||this.$html.hasClass(limitTo);if(!isIncluded)return;this.isLegacyScrolling=false;this._addStyling();this._fixJQuery();this._fixScrollTo();this._fixBrowser()}},{key:"_addStyling",value:function _addStyling(){this.$html.addClass("adapt-scrolling")}},{key:"_fixJQuery",value:function _fixJQuery(){var selectorScrollTop=$.fn.scrollTop;var $app=Adapt.scrolling.$app;$.fn.scrollTop=function(){if(this[0]===window||this[0]===document.body){return selectorScrollTop.apply($app,arguments)}return selectorScrollTop.apply(this,arguments)};var selectorOffset=$.fn.offset;$.fn.offset=function(coordinates){if(coordinates){return selectorOffset.apply(this,arguments)}var $app=Adapt.scrolling.$app;var $element=this;var elementOffset=selectorOffset.call($element);var isCorrectedContainer=$element.parents().add($element).filter("html,body,#app").length;if(!isCorrectedContainer){return elementOffset}var scrollTop=parseInt($app.scrollTop());var scrollLeft=parseInt($app.scrollLeft());var appOffset=selectorOffset.call($app);elementOffset.top+=scrollTop-appOffset.top;elementOffset.left+=scrollLeft-appOffset.left;return elementOffset}}},{key:"_fixScrollTo",value:function _fixScrollTo(){var selectorScrollTo=$.fn.scrollTo;var scrollTo=$.scrollTo;var $app=Adapt.scrolling.$app;$.fn.scrollTo=function(target,duration,settings){if(this[0]===window||this[0]===document.body){return selectorScrollTo.apply($app,arguments)}return selectorScrollTo.apply(this,arguments)};$.scrollTo=function(target,duration,settings){return selectorScrollTo.apply($app,arguments)};Object.assign($.scrollTo,scrollTo)}},{key:"_fixBrowser",value:function _fixBrowser(){var _this54=this;var app=Adapt.scrolling.$app[0];window.scrollTo=function(x,y){app.scrollTop=y||0;app.scrollLeft=x||0};var $window=$(window);this.$app.on("scroll",function(){_newArrowCheck(this,_this54);$window.scroll()}.bind(this))}},{key:"scrollTo",value:function scrollTo(selector){var _this55=this;var settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var location=Adapt.location._contentType?Adapt.location._contentType:Adapt.location._currentLocation;Adapt.trigger("".concat(location,":scrollTo"),selector);var disableScrollToAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;if(disableScrollToAnimation){settings.duration=0}else if(!settings.duration){settings.duration=$.scrollTo.defaults.duration}var offsetTop=0;if(Adapt.scrolling.isLegacyScrolling){offsetTop=-$(".nav").outerHeight();if($(selector).hasClass("component")){offsetTop-=$(selector).find(".aria-label").height()||0}}if(!settings.offset)settings.offset={top:offsetTop,left:0};if(settings.offset.top===undefined)settings.offset.top=offsetTop;if(settings.offset.left===undefined)settings.offset.left=0;if(settings.offset.left===0)settings.axis="y";if(Adapt.get("_canScroll")!==false){$.scrollTo(selector,settings)}_.delay(function(){_newArrowCheck(this,_this55);Adapt.a11y.focusNext(selector);Adapt.trigger("".concat(location,":scrolledTo"),selector)}.bind(this),settings.duration+300)}}]);return Scrolling}(Backbone.Controller);Adapt.scrolling=new Scrolling;Adapt.scrollTo=Adapt.scrolling.scrollTo.bind(Adapt.scrolling);return Adapt.scrolling});define("core/js/views/headingView",["core/js/adapt"],function(Adapt){var HeadingView=Backbone.View.extend({initialize:function initialize(){this.listenTo(Adapt.parentView,"postRemove",this.remove);this.listenTo(this.model,"change:_isComplete",this.render);this.render()},render:function render(){var template=Handlebars.templates[this.constructor.template];var data=this.model.toJSON();var customHeadingType=this.$el.attr("data-a11y-heading-type");if(customHeadingType)data._type=customHeadingType;this.$el.html(template(data));this.checkCompletion()},checkCompletion:function checkCompletion(){var isComplete=this.model.get("_isComplete");this.$el.toggleClass("is-complete",isComplete).toggleClass("is-incomplete",!isComplete)}},{template:"heading"});return HeadingView});define("core/js/headings",["./adapt","./views/headingView"],function(Adapt,HeadingView){var Headings=Backbone.Controller.extend({initialize:function initialize(){this.listenTo(Adapt,"view:render",this.onViewRender)},onViewRender:function onViewRender(view){var $headingSeats=view.$(".js-heading");$headingSeats.each(function(index,el){new HeadingView({el:el,model:view.model})})}});return new Headings});define("core/js/views/navigationView",["core/js/adapt"],function(Adapt){var NavigationView=function(_Backbone$View2){"use strict";_inherits(NavigationView,_Backbone$View2);var _super27=_createSuper(NavigationView);function NavigationView(){_classCallCheck(this,NavigationView);return _super27.apply(this,arguments)}_createClass(NavigationView,[{key:"className",value:function className(){return"nav"}},{key:"events",value:function events(){return{"click [data-event]":"triggerEvent"}}},{key:"attributes",value:function attributes(){return{"role":"navigation"}}},{key:"initialize",value:function initialize(){this.listenToOnce(Adapt,{"courseModel:dataLoading":this.remove});this.listenTo(Adapt,"router:menu router:page",this.hideNavigationButton);this.preRender()}},{key:"preRender",value:function preRender(){Adapt.trigger("navigationView:preRender",this);this.render()}},{key:"render",value:function render(){var _this56=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template({_globals:Adapt.course.get("_globals"),_accessibility:Adapt.config.get("_accessibility")})).insertBefore("#app");_.defer(function(){_newArrowCheck(this,_this56);Adapt.trigger("navigationView:postRender",this)}.bind(this));return this}},{key:"triggerEvent",value:function triggerEvent(event){event.preventDefault();var currentEvent=$(event.currentTarget).attr("data-event");Adapt.trigger("navigation:"+currentEvent);switch(currentEvent){case"backButton":Adapt.router.navigateToPreviousRoute();break;case"homeButton":Adapt.router.navigateToHomeRoute();break;case"parentButton":Adapt.router.navigateToParent();break;case"skipNavigation":this.skipNavigation();break;case"returnToStart":Adapt.startController.returnToStartLocation();break;}}},{key:"skipNavigation",value:function skipNavigation(){Adapt.a11y.focusFirst("."+Adapt.location._contentType)}},{key:"hideNavigationButton",value:function hideNavigationButton(model){var shouldHide=model.get("_type")==="course";this.$(".nav__back-btn, .nav__home-btn").toggleClass("u-display-none",shouldHide)}},{key:"showNavigationButton",value:function showNavigationButton(){this.$(".nav__back-btn, .nav__home-btn").removeClass("u-display-none")}}]);return NavigationView}(Backbone.View);NavigationView.template="nav";return NavigationView});define("core/js/navigation",["core/js/adapt","core/js/views/navigationView"],function(Adapt,NavigationView){var NavigationController=Backbone.Controller.extend({initialize:function initialize(){this.listenTo(Adapt,"adapt:preInitialize",this.addNavigationBar)},addNavigationBar:function addNavigationBar(){var adaptConfig=Adapt.course.get("_navigation");if(adaptConfig&&adaptConfig._isDefaultNavigationDisabled){Adapt.trigger("navigation:initialize");return}Adapt.navigation=new NavigationView}});return new NavigationController});define("core/js/views/componentView",["core/js/adapt","core/js/views/adaptView"],function(Adapt,AdaptView){var ComponentView=function(_AdaptView4){"use strict";_inherits(ComponentView,_AdaptView4);var _super28=_createSuper(ComponentView);function ComponentView(){_classCallCheck(this,ComponentView);return _super28.apply(this,arguments)}_createClass(ComponentView,[{key:"attributes",value:function attributes(){if(!this.model.get("_isA11yRegionEnabled")){return AdaptView.resultExtend("attributes",{},this)}return AdaptView.resultExtend("attributes",{"aria-labelledby":this.model.get("_id")+"-heading","role":"region"},this)}},{key:"className",value:function className(){return["component",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}},{key:"renderState",value:function renderState(){Adapt.log.removed("renderState is removed and moved to item title")}},{key:"setupInviewCompletion",value:function setupInviewCompletion(inviewElementSelector,callback){this.$inviewElement=this.$(inviewElementSelector||".component__inner");this.inviewCallback=callback||this.setCompletionStatus;this.$inviewElement.on("inview.componentView",this.onInview.bind(this))}},{key:"removeInviewListener",value:function removeInviewListener(){if(!this.$inviewElement)return;this.$inviewElement.off("inview.componentView");this.$inviewElement=null}},{key:"onInview",value:function onInview(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true;}if(!this.hasSeenTop||!this.hasSeenBottom)return;this.inviewCallback();if(this.model.get("_isComplete")){this.removeInviewListener()}}},{key:"postRender",value:function postRender(){}},{key:"remove",value:function remove(){this.removeInviewListener();_get(_getPrototypeOf(ComponentView.prototype),"remove",this).call(this)}}]);return ComponentView}(AdaptView);ComponentView.type="component";return ComponentView});define("core/js/enums/buttonStateEnum",[],function(){var BUTTON_STATE=ENUM(["SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET"]);return BUTTON_STATE});define("core/js/views/buttonsView",["core/js/adapt","core/js/enums/buttonStateEnum"],function(Adapt,BUTTON_STATE){var textPropertyName={"SUBMIT":"submit","CORRECT":"correct","INCORRECT":"incorrect","SHOW_CORRECT_ANSWER":"showCorrectAnswer","HIDE_CORRECT_ANSWER":"hideCorrectAnswer","SHOW_FEEDBACK":"showFeedback","RESET":"reset"};var ButtonsView=Backbone.View.extend({initialize:function initialize(options){this.parent=options.parent;this.listenTo(Adapt.parentView,"postRemove",this.remove);this.listenTo(this.model,"change:_buttonState",this.onButtonStateChanged);this.listenTo(this.model,"change:feedbackMessage",this.onFeedbackMessageChanged);this.listenTo(this.model,"change:_attemptsLeft",this.onAttemptsChanged);this.render()},events:{"click .js-btn-action":"onActionClicked","click .js-btn-feedback":"onFeedbackClicked"},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates["buttons"];_.defer(_.bind(function(){this.postRender();Adapt.trigger("buttonsView:postRender",this)},this));this.$el.html(template(data))},postRender:function postRender(){this.refresh()},checkResetSubmittedState:function checkResetSubmittedState(){var isSubmitted=this.model.get("_isSubmitted");if(!isSubmitted){this.$(".js-btn-marking").removeClass("is-incorrect is-correct").addClass("u-display-none");this.$el.removeClass("is-submitted");this.model.set("feedbackMessage",undefined);Adapt.a11y.toggleAccessibleEnabled(this.$(".js-btn-feedback"),false)}else{this.$el.addClass("is-submitted")}},onActionClicked:function onActionClicked(){var buttonState=this.model.get("_buttonState");this.trigger("buttons:stateUpdate",BUTTON_STATE(buttonState));this.checkResetSubmittedState()},onFeedbackClicked:function onFeedbackClicked(){this.trigger("buttons:stateUpdate",BUTTON_STATE.SHOW_FEEDBACK)},onFeedbackMessageChanged:function onFeedbackMessageChanged(model,changedAttribute){if(changedAttribute&&this.model.get("_canShowFeedback")){Adapt.a11y.toggleAccessibleEnabled(this.$(".js-btn-feedback"),true)}else{Adapt.a11y.toggleAccessibleEnabled(this.$(".js-btn-feedback"),false)}},onButtonStateChanged:function onButtonStateChanged(model,changedAttribute){this.updateAttemptsCount();var $buttonsAction=this.$(".js-btn-action");var buttonState=BUTTON_STATE(changedAttribute);if(changedAttribute===BUTTON_STATE.CORRECT||changedAttribute===BUTTON_STATE.INCORRECT){Adapt.a11y.toggleAccessibleEnabled($buttonsAction,false)}else{var propertyName=textPropertyName[buttonState.asString];var ariaLabel=this.model.get("_buttons")["_"+propertyName].ariaLabel;var buttonText=this.model.get("_buttons")["_"+propertyName].buttonText;Adapt.a11y.toggleAccessibleEnabled($buttonsAction,true);$buttonsAction.html(buttonText).attr("aria-label",ariaLabel);switch(changedAttribute){case BUTTON_STATE.SHOW_CORRECT_ANSWER:case BUTTON_STATE.HIDE_CORRECT_ANSWER:Adapt.a11y.toggleAccessible($buttonsAction,false);}}},checkFeedbackState:function checkFeedbackState(){var canShowFeedback=this.model.get("_canShowFeedback");this.$(".js-btn-action").toggleClass("is-full-width",!canShowFeedback);this.$(".js-btn-feedback").toggleClass("u-display-none",!canShowFeedback);this.$(".js-btn-marking").toggleClass("is-full-width u-display-none",!canShowFeedback)},updateAttemptsCount:function updateAttemptsCount(model,changedAttribute){var isInteractionComplete=this.model.get("_isInteractionComplete");var attemptsLeft=this.model.get("_attemptsLeft")?this.model.get("_attemptsLeft"):this.model.get("_attempts");var shouldDisplayAttempts=this.model.get("_shouldDisplayAttempts");var attemptsString;this.checkResetSubmittedState();if(!isInteractionComplete&&attemptsLeft!==0){attemptsString=attemptsLeft+" ";if(attemptsLeft>1){attemptsString+=this.model.get("_buttons").remainingAttemptsText}else if(attemptsLeft===1){attemptsString+=this.model.get("_buttons").remainingAttemptText}}else{this.$(".js-display-attempts").addClass("u-visibility-hidden");this.showMarking()}if(shouldDisplayAttempts){this.$(".js-insert-attempts-string").html(attemptsString)}},showMarking:function showMarking(){if(!this.model.shouldShowMarking)return;var isCorrect=this.model.get("_isCorrect");var ariaLabels=Adapt.course.get("_globals")._accessibility._ariaLabels;this.$(".js-btn-marking").removeClass("u-display-none").addClass(isCorrect?"is-correct":"is-incorrect").attr("aria-label",isCorrect?ariaLabels.answeredCorrectly:ariaLabels.answeredIncorrectly)},refresh:function refresh(){this.updateAttemptsCount();this.checkResetSubmittedState();this.checkFeedbackState();this.onButtonStateChanged(null,this.model.get("_buttonState"));this.onFeedbackMessageChanged(null,this.model.get("feedbackMessage"))}});return ButtonsView});define("core/js/models/questionModel",["core/js/adapt","core/js/models/componentModel","core/js/enums/buttonStateEnum"],function(Adapt,ComponentModel,BUTTON_STATE){var QuestionModel=function(_ComponentModel){"use strict";_inherits(QuestionModel,_ComponentModel);var _super29=_createSuper(QuestionModel);function QuestionModel(){_classCallCheck(this,QuestionModel);return _super29.apply(this,arguments)}_createClass(QuestionModel,[{key:"defaults",value:function defaults(){return ComponentModel.resultExtend("defaults",{_isQuestionType:true,_shouldDisplayAttempts:false,_canShowModelAnswer:true,_canShowFeedback:true,_canShowMarking:true,_isSubmitted:false,_questionWeight:Adapt.config.get("_questionWeight"),_items:[]})}},{key:"trackable",value:function trackable(){return ComponentModel.resultExtend("trackable",["_isSubmitted","_score","_isCorrect","_attemptsLeft"])}},{key:"getTypeGroup",value:function getTypeGroup(){return"question"}},{key:"init",value:function init(){this.setupDefaultSettings();this.listenToOnce(Adapt,"adapt:initialize",this.onAdaptInitialize)}},{key:"setupDefaultSettings",value:function setupDefaultSettings(){this.setupWeightSettings();this.setupButtonSettings()}},{key:"setupButtonSettings",value:function setupButtonSettings(){var globalButtons=Adapt.course.get("_buttons");if(!this.has("_buttons")){this.set("_buttons",globalButtons)}else{var componentButtons=this.get("_buttons");for(var key in componentButtons){if(_typeof(componentButtons[key])==="object"){if(!componentButtons[key].buttonText&&globalButtons[key].buttonText){componentButtons[key].buttonText=globalButtons[key].buttonText}if(!componentButtons[key].ariaLabel&&globalButtons[key].ariaLabel){componentButtons[key].ariaLabel=globalButtons[key].ariaLabel}}if(!componentButtons[key]&&globalButtons[key]){componentButtons[key]=globalButtons[key]}}}}},{key:"setupWeightSettings",value:function setupWeightSettings(){}},{key:"onAdaptInitialize",value:function onAdaptInitialize(){this.restoreUserAnswers()}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){}},{key:"canSubmit",value:function canSubmit(){}},{key:"updateAttempts",value:function updateAttempts(){if(!this.get("_attemptsLeft")){this.set("_attemptsLeft",this.get("_attempts"))}this.set("_attemptsLeft",this.get("_attemptsLeft")-1)}},{key:"setQuestionAsSubmitted",value:function setQuestionAsSubmitted(){this.set({_isEnabled:false,_isSubmitted:true})}},{key:"storeUserAnswer",value:function storeUserAnswer(){}},{key:"markQuestion",value:function markQuestion(){if(this.isCorrect()){this.set("_isCorrect",true)}else{this.set("_isCorrect",false)}}},{key:"isCorrect",value:function isCorrect(){}},{key:"setScore",value:function setScore(){}},{key:"checkQuestionCompletion",value:function checkQuestionCompletion(){var isComplete=this.get("_isCorrect")||this.get("_attemptsLeft")===0;if(isComplete){this.setCompletionStatus()}return isComplete}},{key:"updateButtons",value:function updateButtons(){var isInteractionComplete=this.get("_isInteractionComplete");var isCorrect=this.get("_isCorrect");var isEnabled=this.get("_isEnabled");var buttonState=this.get("_buttonState");var canShowModelAnswer=this.get("_canShowModelAnswer");if(isInteractionComplete){if(isCorrect||!canShowModelAnswer){this.set("_buttonState",BUTTON_STATE.CORRECT)}else{switch(buttonState){case BUTTON_STATE.SUBMIT:case BUTTON_STATE.HIDE_CORRECT_ANSWER:this.set("_buttonState",BUTTON_STATE.SHOW_CORRECT_ANSWER);break;default:this.set("_buttonState",BUTTON_STATE.HIDE_CORRECT_ANSWER);}}}else{if(isEnabled){this.set("_buttonState",BUTTON_STATE.SUBMIT)}else{this.set("_buttonState",BUTTON_STATE.RESET)}}}},{key:"setupFeedback",value:function setupFeedback(){if(!this.has("_feedback"))return;if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){}},{key:"setupCorrectFeedback",value:function setupCorrectFeedback(){this.set({feedbackTitle:this.getFeedbackTitle(),feedbackMessage:this.get("_feedback").correct})}},{key:"setupPartlyCorrectFeedback",value:function setupPartlyCorrectFeedback(){var feedback=this.get("_feedback")._partlyCorrect;if(feedback&&feedback.final){this.setAttemptSpecificFeedback(feedback)}else{this.setupIncorrectFeedback()}}},{key:"setupIncorrectFeedback",value:function setupIncorrectFeedback(){this.setAttemptSpecificFeedback(this.get("_feedback")._incorrect)}},{key:"setAttemptSpecificFeedback",value:function setAttemptSpecificFeedback(feedback){var body=this.get("_attemptsLeft")&&feedback.notFinal||feedback.final;this.set({feedbackTitle:this.getFeedbackTitle(),feedbackMessage:body})}},{key:"getFeedbackTitle",value:function getFeedbackTitle(){return this.get("_feedback").title||this.get("displayTitle")||this.get("title")||""}},{key:"isInteractive",value:function isInteractive(){return!this.get("_isComplete")||this.get("_isEnabled")&&!this.get("_isSubmitted")}},{key:"reset",value:function reset(type,force){if(!this.get("_canReset")&&!force)return;type=type||true;_get(_getPrototypeOf(QuestionModel.prototype),"reset",this).call(this,type,force);var attempts=this.get("_attempts");this.set({_attemptsLeft:attempts,_isCorrect:undefined,_isSubmitted:false,_buttonState:BUTTON_STATE.SUBMIT})}},{key:"setQuestionAsReset",value:function setQuestionAsReset(){this.set({_isEnabled:true,_isSubmitted:false})}},{key:"resetUserAnswer",value:function resetUserAnswer(){}},{key:"refresh",value:function refresh(){this.trigger("question:refresh")}},{key:"getButtonState",value:function getButtonState(){if(this.get("_isCorrect")){return BUTTON_STATE.CORRECT}if(this.get("_attemptsLeft")===0){return this.get("_canShowModelAnswer")?BUTTON_STATE.SHOW_CORRECT_ANSWER:BUTTON_STATE.INCORRECT}return this.get("_isSubmitted")?BUTTON_STATE.RESET:BUTTON_STATE.SUBMIT}},{key:"getInteractionObject",value:function getInteractionObject(){return{}}},{key:"getResponse",value:function getResponse(){}},{key:"getResponseType",value:function getResponseType(){}},{key:"shouldShowMarking",get:function get(){if(!this.get("_canShowMarking")){return false}return this.get("_isInteractionComplete")}}]);return QuestionModel}(ComponentModel);return QuestionModel});define("core/js/views/questionView",["core/js/adapt","core/js/views/componentView","core/js/views/buttonsView","core/js/models/questionModel","core/js/enums/buttonStateEnum"],function(Adapt,ComponentView,ButtonsView,QuestionModel,BUTTON_STATE){var useQuestionModelOnly=false;var QuestionView=function(_ComponentView){"use strict";_inherits(QuestionView,_ComponentView);var _super30=_createSuper(QuestionView);function QuestionView(){_classCallCheck(this,QuestionView);return _super30.apply(this,arguments)}_createClass(QuestionView,[{key:"className",value:function className(){return["component","is-question",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":"",this.model.get("_canShowModelAnswer")?"can-show-model-answer":"",this.model.get("_canShowFeedback")?"can-show-feedback":"",this.model.get("_canShowMarking")?"can-show-marking":""].join(" ")}},{key:"preRender",value:function preRender(){this.listenTo(this.model,"change:_isEnabled",this.onEnabledChanged);this.listenTo(this.model,"question:refresh",this.refresh);this.checkIfResetOnRevisit();this._runModelCompatibleFunction("setupDefaultSettings");this.setupQuestion()}},{key:"onEnabledChanged",value:function onEnabledChanged(model,changedAttribute){if(!changedAttribute){this.$(".component__widget").addClass("is-disabled");this.disableQuestion()}else{this.$(".component__widget").removeClass("is-disabled");this.enableQuestion()}}},{key:"disableQuestion",value:function disableQuestion(){}},{key:"enableQuestion",value:function enableQuestion(){}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var _this57=this;var isResetOnRevisit=this.model.get("_isResetOnRevisit");isResetOnRevisit=isResetOnRevisit==="false"?false:isResetOnRevisit;if(isResetOnRevisit){this.model.reset(isResetOnRevisit,true);_.defer(function(){_newArrowCheck(this,_this57);this.resetQuestionOnRevisit(isResetOnRevisit)}.bind(this))}else{var isInteractionComplete=this.model.get("_isInteractionComplete");if(isInteractionComplete){this.model.set("_buttonState",BUTTON_STATE.HIDE_CORRECT_ANSWER);_.defer(function(){_newArrowCheck(this,_this57);this.onHideCorrectAnswerClicked()}.bind(this))}else{this.model.set("_buttonState",BUTTON_STATE.SUBMIT);_.defer(function(){_newArrowCheck(this,_this57);this.onResetClicked()}.bind(this))}}}},{key:"resetQuestionOnRevisit",value:function resetQuestionOnRevisit(type){}},{key:"setupQuestion",value:function setupQuestion(){}},{key:"postRender",value:function postRender(){this.addButtonsView();this.onQuestionRendered()}},{key:"addButtonsView",value:function addButtonsView(){this.buttonsView=new ButtonsView({model:this.model,el:this.$(".btn__container")});this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onButtonStateUpdate)}},{key:"onButtonStateUpdate",value:function onButtonStateUpdate(buttonState){switch(buttonState){case BUTTON_STATE.SUBMIT:this.onSubmitClicked();break;case BUTTON_STATE.RESET:this.onResetClicked();break;case BUTTON_STATE.SHOW_CORRECT_ANSWER:this.onShowCorrectAnswerClicked();break;case BUTTON_STATE.HIDE_CORRECT_ANSWER:this.onHideCorrectAnswerClicked();break;case BUTTON_STATE.SHOW_FEEDBACK:this.showFeedback();break;}}},{key:"onQuestionRendered",value:function onQuestionRendered(){}},{key:"onSubmitClicked",value:function onSubmitClicked(){var canSubmit=this._runModelCompatibleFunction("canSubmit");if(!canSubmit){this.showInstructionError();this.onCannotSubmit();return}this._runModelCompatibleFunction("updateAttempts");this._runModelCompatibleFunction("setQuestionAsSubmitted");this.removeInstructionError();this._runModelCompatibleFunction("storeUserAnswer");this._runModelCompatibleFunction("markQuestion","isCorrect");this._runModelCompatibleFunction("setScore");this._runModelCompatibleFunction("checkQuestionCompletion");if(this.model.shouldShowMarking){this.showMarking()}this.recordInteraction();this._runModelCompatibleFunction("setupFeedback");this.showFeedback();$(window).resize();this._runModelCompatibleFunction("updateButtons");this.onSubmitted()}},{key:"showInstructionError",value:function showInstructionError(){this.$(".component__instruction-inner").addClass("validation-error");Adapt.a11y.focusFirst(this.$el,{defer:true})}},{key:"onCannotSubmit",value:function onCannotSubmit(){}},{key:"onSubmitted",value:function onSubmitted(){}},{key:"setQuestionAsSubmitted",value:function setQuestionAsSubmitted(){this.model.setQuestionAsSubmitted();this.$(".component__widget").addClass("is-submitted")}},{key:"removeInstructionError",value:function removeInstructionError(){this.$(".component__instruction-inner").removeClass("validation-error")}},{key:"showMarking",value:function showMarking(){}},{key:"checkQuestionCompletion",value:function checkQuestionCompletion(){var isComplete=this.model.checkQuestionCompletion();if(isComplete){this.$(".component__widget").addClass("is-complete show-user-answer")}}},{key:"recordInteraction",value:function recordInteraction(){if(this.model.get("_recordInteraction")===true||!this.model.has("_recordInteraction")){Adapt.trigger("questionView:recordInteraction",this)}}},{key:"showFeedback",value:function showFeedback(){if(this.model.get("_canShowFeedback")){Adapt.trigger("questionView:showFeedback",this)}else{Adapt.trigger("questionView:disabledFeedback",this)}}},{key:"onResetClicked",value:function onResetClicked(){this.setQuestionAsReset();this._runModelCompatibleFunction("updateButtons");this._runModelCompatibleFunction("resetUserAnswer");this.resetQuestion();if(!this.model.get("_isReady"))return;var currentModel=Adapt.findById(Adapt.location._currentId);if(!currentModel||!currentModel.get("_isReady"))return;Adapt.a11y.focusNext(this.$el)}},{key:"setQuestionAsReset",value:function setQuestionAsReset(){this.model.setQuestionAsReset();this.$(".component__widget").removeClass("is-submitted")}},{key:"resetQuestion",value:function resetQuestion(){}},{key:"refresh",value:function refresh(){this.model.set("_buttonState",this.model.getButtonState());if(this.model.shouldShowMarking&&this.model.get("_isSubmitted")){this.showMarking()}if(this.buttonsView){_.defer(this.buttonsView.refresh.bind(this.buttonsView))}}},{key:"onShowCorrectAnswerClicked",value:function onShowCorrectAnswerClicked(){this.setQuestionAsShowCorrect();this._runModelCompatibleFunction("updateButtons");this.showCorrectAnswer()}},{key:"setQuestionAsShowCorrect",value:function setQuestionAsShowCorrect(){this.$(".component__widget").addClass("is-submitted show-correct-answer").removeClass("show-user-answer")}},{key:"showCorrectAnswer",value:function showCorrectAnswer(){}},{key:"onHideCorrectAnswerClicked",value:function onHideCorrectAnswerClicked(){this.setQuestionAsHideCorrect();this._runModelCompatibleFunction("updateButtons");this.hideCorrectAnswer()}},{key:"setQuestionAsHideCorrect",value:function setQuestionAsHideCorrect(){this.$(".component__widget").addClass("is-submitted show-user-answer").removeClass("show-correct-answer")}},{key:"hideCorrectAnswer",value:function hideCorrectAnswer(){}},{key:"getLatency",value:function getLatency(){return null}},{key:"_runModelCompatibleFunction",value:function _runModelCompatibleFunction(name,lookForViewOnlyFunction){return this.model[name]()}}]);return QuestionView}(ComponentView);QuestionView._isQuestionType=true;if(useQuestionModelOnly)return QuestionView;var ViewOnlyQuestionViewCompatibilityLayer=function(_QuestionView){"use strict";_inherits(ViewOnlyQuestionViewCompatibilityLayer,_QuestionView);var _super31=_createSuper(ViewOnlyQuestionViewCompatibilityLayer);function ViewOnlyQuestionViewCompatibilityLayer(){_classCallCheck(this,ViewOnlyQuestionViewCompatibilityLayer);return _super31.apply(this,arguments)}_createClass(ViewOnlyQuestionViewCompatibilityLayer,[{key:"getInteractionObject",value:function getInteractionObject(){Adapt.log.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getInteractionObject()}},{key:"getResponse",value:function getResponse(){Adapt.log.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getResponse()}},{key:"getResponseType",value:function getResponseType(){Adapt.log.deprecated("QuestionView.getResponseType, please use QuestionModel.getResponseType");return this.model.getResponseType()}},{key:"setupDefaultSettings",value:function setupDefaultSettings(){Adapt.log.deprecated("QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings");return this.model.setupDefaultSettings()}},{key:"setupButtonSettings",value:function setupButtonSettings(){Adapt.log.deprecated("QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings");return this.model.setupButtonSettings()}},{key:"setupWeightSettings",value:function setupWeightSettings(){Adapt.log.deprecated("QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings");return this.model.setupWeightSettings()}},{key:"canSubmit",value:function canSubmit(){Adapt.log.deprecated("QuestionView.canSubmit, please use QuestionModel.canSubmit");return this.model.canSubmit()}},{key:"updateAttempts",value:function updateAttempts(){Adapt.log.deprecated("QuestionView.updateAttempts, please use QuestionModel.updateAttempts");return this.model.updateAttempts()}},{key:"storeUserAnswer",value:function storeUserAnswer(){Adapt.log.deprecated("QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer");return this.model.storeUserAnswer()}},{key:"resetUserAnswer",value:function resetUserAnswer(){Adapt.log.deprecated("QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer");return this.model.resetUserAnswer()}},{key:"markQuestion",value:function markQuestion(){if(this._isInViewOnlyCompatibleMode("isCorrect")){if(this.isCorrect()){this.model.set("_isCorrect",true)}else{this.model.set("_isCorrect",false)}}else{return this.model.markQuestion()}}},{key:"isCorrect",value:function isCorrect(){Adapt.log.deprecated("QuestionView.isCorrect, please use QuestionModel.isCorrect");return this.model.isCorrect()}},{key:"setScore",value:function setScore(){Adapt.log.deprecated("QuestionView.setScore, please use QuestionModel.setScore");return this.model.setScore()}},{key:"updateButtons",value:function updateButtons(){Adapt.log.deprecated("QuestionView.updateButtons, please use QuestionModel.updateButtons");return this.model.updateButtons()}},{key:"setupFeedback",value:function setupFeedback(){if(this._isInViewOnlyCompatibleMode("isPartlyCorrect")){if(this.model.get("_isCorrect")){this._runModelCompatibleFunction("setupCorrectFeedback")}else if(this.isPartlyCorrect()){this._runModelCompatibleFunction("setupPartlyCorrectFeedback")}else{this._runModelCompatibleFunction("setupIncorrectFeedback")}}else{this.model.setupFeedback()}}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){Adapt.log.deprecated("QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect");return this.model.isPartlyCorrect()}},{key:"setupCorrectFeedback",value:function setupCorrectFeedback(){Adapt.log.deprecated("QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback");return this.model.setupCorrectFeedback()}},{key:"setupPartlyCorrectFeedback",value:function setupPartlyCorrectFeedback(){Adapt.log.deprecated("QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback");return this.model.setupPartlyCorrectFeedback()}},{key:"setupIncorrectFeedback",value:function setupIncorrectFeedback(){Adapt.log.deprecated("QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback");return this.model.setupIncorrectFeedback()}},{key:"_runModelCompatibleFunction",value:function _runModelCompatibleFunction(name,lookForViewOnlyFunction){if(this._isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction)){return this[name]()}else{return this.model[name]()}}},{key:"_isInViewOnlyCompatibleMode",value:function _isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction){var checkForFunction=lookForViewOnlyFunction||name;if(!this.constructor.prototype[checkForFunction])return false;var hasCompatibleVersion=ViewOnlyQuestionViewCompatibilityLayer.prototype.hasOwnProperty(checkForFunction);var usingCompatibleVersion=this.constructor.prototype[checkForFunction]===ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction];if(hasCompatibleVersion&&usingCompatibleVersion){switch(checkForFunction){case"setupFeedback":case"markQuestion":return true;}return false}return true}}]);return ViewOnlyQuestionViewCompatibilityLayer}(QuestionView);;return ViewOnlyQuestionViewCompatibilityLayer});define("components/adapt-contrib-mcq/js/mcqView",["core/js/adapt","core/js/views/questionView"],function(Adapt,QuestionView){var McqView=QuestionView.extend({events:{"focus .js-item-input":"onItemFocus","blur .js-item-input":"onItemBlur","change .js-item-input":"onItemSelect","keyup .js-item-input":"onKeyPress"},isCorrectAnswerShown:false,initialize:function initialize(){QuestionView.prototype.initialize.apply(this,arguments);this.update=_.debounce(this.update.bind(this),1);this.listenTo(this.model,{"change:_isEnabled change:_isComplete change:_isSubmitted":this.update});this.listenTo(this.model.getChildren(),{"change:_isActive":this.update})},resetQuestionOnRevisit:function resetQuestionOnRevisit(){this.resetQuestion()},setupQuestion:function setupQuestion(){this.model.setupRandomisation()},onQuestionRendered:function onQuestionRendered(){this.setReadyStatus();this.update()},onKeyPress:function onKeyPress(event){if(event.which!==13)return;this.onItemSelect(event)},onItemFocus:function onItemFocus(event){if(!this.model.isInteractive())return;$(".js-item-label[for="+$(event.currentTarget).attr("id")+"]").addClass("is-highlighted")},onItemBlur:function onItemBlur(event){$(".js-item-label[for="+$(event.currentTarget).attr("id")+"]").removeClass("is-highlighted")},onItemSelect:function onItemSelect(event){if(!this.model.isInteractive())return;var index=$(event.currentTarget).data("adapt-index");var itemModel=this.model.getItem(index);var shouldSelect=!itemModel.get("_isActive");if(this.model.isSingleSelect()){shouldSelect=true;this.model.resetActiveItems()}else if(shouldSelect&&this.model.isAtActiveLimit()){this.model.getLastActiveItem().toggleActive(false)}itemModel.toggleActive(shouldSelect)},onCannotSubmit:function onCannotSubmit(){},showMarking:function showMarking(){this.update()},resetQuestion:function resetQuestion(){this.model.resetActiveItems();this.model.resetItems()},showCorrectAnswer:function showCorrectAnswer(){this.isCorrectAnswerShown=true;this.update()},hideCorrectAnswer:function hideCorrectAnswer(){this.isCorrectAnswerShown=false;this.update()},update:function update(){this.updateSelection();this.updateMarking()},updateSelection:function updateSelection(){var isEnabled=this.model.get("_isEnabled");this.model.getChildren().each(function(itemModel){var isSelected=this.isCorrectAnswerShown?itemModel.get("_shouldBeSelected"):itemModel.get("_isActive");var index=itemModel.get("_index");this.$(".js-item-label").filter("[data-adapt-index=\""+index+"\"]").toggleClass("is-selected",isSelected).toggleClass("is-disabled",!isEnabled);this.$(".js-item-input").filter("[data-adapt-index=\""+index+"\"]").prop("checked",isSelected).prop("disabled",!isEnabled)}.bind(this))},updateMarking:function updateMarking(){var isInteractive=this.model.isInteractive();var canShowMarking=this.model.get("_canShowMarking");var ariaLabels=Adapt.course.get("_globals")._accessibility._ariaLabels;this.model.getChildren().each(function(itemModel){var index=itemModel.get("_index");var $itemInput=this.$(".js-item-input").filter("[data-adapt-index=\""+index+"\"]");var $item=$itemInput.parents(".js-mcq-item");if(isInteractive||!canShowMarking){$item.removeClass("is-correct is-incorrect");$itemInput.attr("aria-label",$.a11y_normalize(itemModel.get("text")));return}var shouldBeSelected=itemModel.get("_shouldBeSelected");var isCorrect=Boolean(itemModel.get("_isCorrect"));var isActive=Boolean(itemModel.get("_isActive"));$item.toggleClass("is-correct",isCorrect).toggleClass("is-incorrect",!isCorrect);$itemInput.attr("aria-label",[shouldBeSelected?ariaLabels.correct:ariaLabels.incorrect,", ",isActive?ariaLabels.selectedAnswer:ariaLabels.unselectedAnswer,". ",$.a11y_normalize(itemModel.get("text"))].join(""))}.bind(this))}});return McqView});define("core/js/models/itemModel",[],function(){var ItemModel=function(_Backbone$Model6){"use strict";_inherits(ItemModel,_Backbone$Model6);var _super32=_createSuper(ItemModel);function ItemModel(){_classCallCheck(this,ItemModel);return _super32.apply(this,arguments)}_createClass(ItemModel,[{key:"defaults",value:function defaults(){return{_isActive:false,_isVisited:false}}},{key:"reset",value:function reset(){this.set({_isActive:false,_isVisited:false})}},{key:"toggleActive",value:function toggleActive(){var isActive=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isActive");this.set("_isActive",isActive)}},{key:"toggleVisited",value:function toggleVisited(){var isVisited=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isVisited");this.set("_isVisited",isVisited)}}]);return ItemModel}(Backbone.Model);return ItemModel});define("core/js/models/itemsComponentModel",["core/js/models/componentModel","core/js/models/itemModel"],function(ComponentModel,ItemModel){var ItemsComponentModel=function(_ComponentModel2){"use strict";_inherits(ItemsComponentModel,_ComponentModel2);var _super33=_createSuper(ItemsComponentModel);function ItemsComponentModel(){_classCallCheck(this,ItemsComponentModel);return _super33.apply(this,arguments)}_createClass(ItemsComponentModel,[{key:"toJSON",value:function toJSON(){var json=_get(_getPrototypeOf(ItemsComponentModel.prototype),"toJSON",this).call(this);json._items=this.getChildren().toJSON();return json}},{key:"init",value:function init(){this.setUpItems();this.listenTo(this.getChildren(),{"all":this.onAll,"change:_isVisited":this.checkCompletionStatus})}},{key:"getTypeGroup",value:function getTypeGroup(){return"itemscomponent"}},{key:"setUpItems",value:function setUpItems(){var _this58=this;var items=this.get("_items")||[];items.forEach(function(item,index){_newArrowCheck(this,_this58);return item._index=index}.bind(this));this.setChildren(new Backbone.Collection(items,{model:ItemModel}))}},{key:"getItem",value:function getItem(index){return this.getChildren().findWhere({_index:index})}},{key:"getVisitedItems",value:function getVisitedItems(){return this.getChildren().where({_isVisited:true})}},{key:"getActiveItems",value:function getActiveItems(){return this.getChildren().where({_isActive:true})}},{key:"getActiveItem",value:function getActiveItem(){return this.getChildren().findWhere({_isActive:true})}},{key:"areAllItemsCompleted",value:function areAllItemsCompleted(){return this.getVisitedItems().length===this.getChildren().length}},{key:"checkCompletionStatus",value:function checkCompletionStatus(){if(!this.areAllItemsCompleted())return;this.setCompletionStatus()}},{key:"reset",value:function reset(type,force){var _this59=this;this.getChildren().each(function(item){_newArrowCheck(this,_this59);return item.reset()}.bind(this));_get(_getPrototypeOf(ItemsComponentModel.prototype),"reset",this).call(this,type,force)}},{key:"resetActiveItems",value:function resetActiveItems(){var _this60=this;this.getChildren().each(function(item){_newArrowCheck(this,_this60);return item.toggleActive(false)}.bind(this))}},{key:"setActiveItem",value:function setActiveItem(index){var item=this.getItem(index);if(!item)return;var activeItem=this.getActiveItem();if(activeItem)activeItem.toggleActive(false);item.toggleActive(true)}}]);return ItemsComponentModel}(ComponentModel);return ItemsComponentModel});define("core/js/models/itemsQuestionModel",["core/js/adapt","core/js/models/questionModel","core/js/models/itemsComponentModel"],function(Adapt,QuestionModel,ItemsComponentModel){var _this61=this;var BlendedItemsComponentQuestionModel=function(_QuestionModel){"use strict";_inherits(BlendedItemsComponentQuestionModel,_QuestionModel);var _super34=_createSuper(BlendedItemsComponentQuestionModel);function BlendedItemsComponentQuestionModel(){_classCallCheck(this,BlendedItemsComponentQuestionModel);return _super34.apply(this,arguments)}_createClass(BlendedItemsComponentQuestionModel,[{key:"init",value:function init(){_get(_getPrototypeOf(BlendedItemsComponentQuestionModel.prototype),"init",this).call(this);ItemsComponentModel.prototype.init.call(this)}},{key:"reset",value:function reset(type,force){_get(_getPrototypeOf(BlendedItemsComponentQuestionModel.prototype),"reset",this).call(this,type,force);ItemsComponentModel.prototype.reset.call(this,type,force)}}]);return BlendedItemsComponentQuestionModel}(QuestionModel);Object.getOwnPropertyNames(ItemsComponentModel.prototype).forEach(function(name){_newArrowCheck(this,_this61);if(name==="constructor"||name==="init"||name==="reset")return;Object.defineProperty(BlendedItemsComponentQuestionModel.prototype,name,{value:ItemsComponentModel.prototype[name]})}.bind(this));var ItemsQuestionModel=function(_BlendedItemsComponen){"use strict";_inherits(ItemsQuestionModel,_BlendedItemsComponen);var _super35=_createSuper(ItemsQuestionModel);function ItemsQuestionModel(){_classCallCheck(this,ItemsQuestionModel);return _super35.apply(this,arguments)}_createClass(ItemsQuestionModel,[{key:"init",value:function init(){_get(_getPrototypeOf(ItemsQuestionModel.prototype),"init",this).call(this);this.set("_isRadio",this.isSingleSelect())}},{key:"getTypeGroup",value:function getTypeGroup(){return"itemsquestion"}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){var _this62=this;if(!this.get("_isSubmitted"))return;var itemModels=this.getChildren();var userAnswer=this.get("_userAnswer");itemModels.each(function(item){_newArrowCheck(this,_this62);item.toggleActive(userAnswer[item.get("_index")])}.bind(this));this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}},{key:"setupRandomisation",value:function setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;var children=this.getChildren();children.set(children.shuffle())}},{key:"canSubmit",value:function canSubmit(){var activeItems=this.getActiveItems();return activeItems.length>0}},{key:"storeUserAnswer",value:function storeUserAnswer(){var _this63=this;var items=this.getChildren().slice(0);items.sort(function(a,b){_newArrowCheck(this,_this63);return a.get("_index")-b.get("_index")}.bind(this));var userAnswer=items.map(function(itemModel){_newArrowCheck(this,_this63);return itemModel.get("_isActive")}.bind(this));this.set("_userAnswer",userAnswer)}},{key:"isCorrect",value:function isCorrect(){var _this64=this;var props={_numberOfRequiredAnswers:0,_numberOfIncorrectAnswers:0,_isAtLeastOneCorrectSelection:false,_numberOfCorrectAnswers:0};this.getChildren().each(function(itemModel){_newArrowCheck(this,_this64);var itemShouldBeActive=itemModel.get("_shouldBeSelected");if(itemShouldBeActive){props._numberOfRequiredAnswers++}if(!itemModel.get("_isActive"))return;if(!itemShouldBeActive){props._numberOfIncorrectAnswers++;return}props._isAtLeastOneCorrectSelection=true;props._numberOfCorrectAnswers++;itemModel.set("_isCorrect",true)}.bind(this));this.set(props);var hasRightNumberOfCorrectAnswers=props._numberOfCorrectAnswers===props._numberOfRequiredAnswers;var hasNoIncorrectAnswers=!props._numberOfIncorrectAnswers;return hasRightNumberOfCorrectAnswers&&hasNoIncorrectAnswers}},{key:"setScore",value:function setScore(){var questionWeight=this.get("_questionWeight");var answeredCorrectly=this.get("_isCorrect");var score=answeredCorrectly?questionWeight:0;this.set("_score",score)}},{key:"setupFeedback",value:function setupFeedback(){if(!this.has("_feedback"))return;if(this.get("_isCorrect")){this.setupCorrectFeedback();return}if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback();return}var activeItem=this.getActiveItem();if(this.isSingleSelect()&&activeItem.get("feedback")){this.setupIndividualFeedback(activeItem);return}this.setupIncorrectFeedback()}},{key:"setupIndividualFeedback",value:function setupIndividualFeedback(selectedItem){this.set({feedbackTitle:this.getFeedbackTitle(this.get("_feedback")),feedbackMessage:selectedItem.get("feedback")})}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}},{key:"resetUserAnswer",value:function resetUserAnswer(){this.set("_userAnswer",[])}},{key:"isAtActiveLimit",value:function isAtActiveLimit(){var selectedItems=this.getActiveItems();return selectedItems.length===this.get("_selectable")}},{key:"isSingleSelect",value:function isSingleSelect(){return this.get("_selectable")===1}},{key:"getLastActiveItem",value:function getLastActiveItem(){var selectedItems=this.getActiveItems();return selectedItems[selectedItems.length-1]}},{key:"resetItems",value:function resetItems(){this.resetActiveItems();this.set("_isAtLeastOneCorrectSelection",false)}},{key:"getInteractionObject",value:function getInteractionObject(){var _this65=this;var interactions={correctResponsesPattern:[],choices:[]};interactions.choices=this.getChildren().map(function(itemModel){_newArrowCheck(this,_this65);return{id:(itemModel.get("_index")+1).toString(),description:itemModel.get("text")}}.bind(this));var correctItems=this.getChildren().filter(function(itemModel){_newArrowCheck(this,_this65);return itemModel.get("_shouldBeSelected")}.bind(this));interactions.correctResponsesPattern=[correctItems.map(function(itemModel){_newArrowCheck(this,_this65);return String(itemModel.get("_index")+1)}.bind(this)).join("[,]")];return interactions}},{key:"getResponse",value:function getResponse(){var _this66=this;var activeItems=this.getActiveItems();var activeIndexes=activeItems.map(function(itemModel){_newArrowCheck(this,_this66);return itemModel.get("_index")+1}.bind(this));return activeIndexes.join(",")}},{key:"getResponseType",value:function getResponseType(){return"choice"}}]);return ItemsQuestionModel}(BlendedItemsComponentQuestionModel);return ItemsQuestionModel});define("components/adapt-contrib-mcq/js/adapt-contrib-mcq",["core/js/adapt","./mcqView","core/js/models/itemsQuestionModel"],function(Adapt,McqView,ItemsQuestionModel){return Adapt.register("mcq",{view:McqView,model:ItemsQuestionModel.extend({})})});var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(u){var c=/\blang(?:uage)?-([\w-]+)\b/i,n=0,M={manual:u.Prism&&u.Prism.manual,disableWorkerMessageHandler:u.Prism&&u.Prism.disableWorkerMessageHandler,util:{encode:function e(n){return n instanceof W?new W(n.type,e(n.content),n.alias):Array.isArray(n)?n.map(e):n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function type(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function objId(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function t(e,r){var a,n;switch(r=r||{},M.util.type(e)){case"Object":if(n=M.util.objId(e),r[n])return r[n];for(var i in a={},r[n]=a,e){e.hasOwnProperty(i)&&(a[i]=t(e[i],r))}return a;case"Array":return n=M.util.objId(e),r[n]?r[n]:(a=[],r[n]=a,e.forEach(function(e,n){a[n]=t(e,r)}),a);default:return e;}},getLanguage:function getLanguage(e){for(;e&&!c.test(e.className);){e=e.parentElement}return e?(e.className.match(c)||[,"none"])[1].toLowerCase():"none"},currentScript:function currentScript(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(e){var n=(/at [^(\r\n]*\((.*):.+:.+\)$/i.exec(e.stack)||[])[1];if(n){var t=document.getElementsByTagName("script");for(var r in t){if(t[r].src==n)return t[r]}}return null}},isActive:function isActive(e,n,t){for(var r="no-"+n;e;){var a=e.classList;if(a.contains(n))return!0;if(a.contains(r))return!1;e=e.parentElement}return!!t}},languages:{extend:function extend(e,n){var t=M.util.clone(M.languages[e]);for(var r in n){t[r]=n[r]}return t},insertBefore:function insertBefore(t,e,n,r){var a=(r=r||M.languages)[t],i={};for(var l in a){if(a.hasOwnProperty(l)){if(l==e)for(var o in n){n.hasOwnProperty(o)&&(i[o]=n[o])}n.hasOwnProperty(l)||(i[l]=a[l])}}var s=r[t];return r[t]=i,M.languages.DFS(M.languages,function(e,n){n===s&&e!=t&&(this[e]=i)}),i},DFS:function e(n,t,r,a){a=a||{};var i=M.util.objId;for(var l in n){if(n.hasOwnProperty(l)){t.call(n,l,n[l],r||l);var o=n[l],s=M.util.type(o);"Object"!==s||a[i(o)]?"Array"!==s||a[i(o)]||(a[i(o)]=!0,e(o,t,l,a)):(a[i(o)]=!0,e(o,t,null,a))}}}},plugins:{},highlightAll:function highlightAll(e,n){M.highlightAllUnder(document,e,n)},highlightAllUnder:function highlightAllUnder(e,n,t){var r={callback:t,container:e,selector:"code[class*=\"language-\"], [class*=\"language-\"] code, code[class*=\"lang-\"], [class*=\"lang-\"] code"};M.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),M.hooks.run("before-all-elements-highlight",r);for(var a,i=0;a=r.elements[i++];){M.highlightElement(a,!0===n,r.callback)}},highlightElement:function highlightElement(e,n,t){var r=M.util.getLanguage(e),a=M.languages[r];e.className=e.className.replace(c,"").replace(/\s+/g," ")+" language-"+r;var i=e.parentElement;i&&"pre"===i.nodeName.toLowerCase()&&(i.className=i.className.replace(c,"").replace(/\s+/g," ")+" language-"+r);var l={element:e,language:r,grammar:a,code:e.textContent};function o(e){l.highlightedCode=e,M.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,M.hooks.run("after-highlight",l),M.hooks.run("complete",l),t&&t.call(l.element)}if(M.hooks.run("before-sanity-check",l),!l.code)return M.hooks.run("complete",l),void(t&&t.call(l.element));if(M.hooks.run("before-highlight",l),l.grammar){if(n&&u.Worker){var s=new Worker(M.filename);s.onmessage=function(e){o(e.data)},s.postMessage(JSON.stringify({language:l.language,code:l.code,immediateClose:!0}))}else o(M.highlight(l.code,l.grammar,l.language));}else o(M.util.encode(l.code))},highlight:function highlight(e,n,t){var r={code:e,grammar:n,language:t};return M.hooks.run("before-tokenize",r),r.tokens=M.tokenize(r.code,r.grammar),M.hooks.run("after-tokenize",r),W.stringify(M.util.encode(r.tokens),r.language)},tokenize:function tokenize(e,n){var t=n.rest;if(t){for(var r in t){n[r]=t[r]}delete n.rest}var a=new i;return I(a,a.head,e),function e(n,t,r,a,i,l){for(var o in r){if(r.hasOwnProperty(o)&&r[o]){var s=r[o];s=Array.isArray(s)?s:[s];for(var u=0;u<s.length;++u){if(l&&l.cause==o+","+u)return;var c=s[u],g=c.inside,f=!!c.lookbehind,h=!!c.greedy,d=0,v=c.alias;if(h&&!c.pattern.global){var p=c.pattern.toString().match(/[imsuy]*$/)[0];c.pattern=RegExp(c.pattern.source,p+"g")}for(var m=c.pattern||c,y=a.next,k=i;y!==t.tail&&!(l&&k>=l.reach);k+=y.value.length,y=y.next){var b=y.value;if(t.length>n.length)return;if(!(b instanceof W)){var x=1;if(h&&y!=t.tail.prev){m.lastIndex=k;var w=m.exec(n);if(!w)break;var A=w.index+(f&&w[1]?w[1].length:0),P=w.index+w[0].length,S=k;for(S+=y.value.length;S<=A;){y=y.next,S+=y.value.length}if(S-=y.value.length,k=S,y.value instanceof W)continue;for(var E=y;E!==t.tail&&(S<P||"string"==typeof E.value);E=E.next){x++,S+=E.value.length}x--,b=n.slice(k,S),w.index-=k}else{m.lastIndex=0;var w=m.exec(b)}if(w){f&&(d=w[1]?w[1].length:0);var A=w.index+d,O=w[0].slice(d),P=A+O.length,L=b.slice(0,A),N=b.slice(P),j=k+b.length;l&&j>l.reach&&(l.reach=j);var C=y.prev;L&&(C=I(t,C,L),k+=L.length),z(t,C,x);var _=new W(o,g?M.tokenize(O,g):O,v,O);y=I(t,C,_),N&&I(t,y,N),1<x&&e(n,t,r,y.prev,k,{cause:o+","+u,reach:j})}}}}}}}(e,a,n,a.head,0),function(e){var n=[],t=e.head.next;for(;t!==e.tail;){n.push(t.value),t=t.next}return n}(a)},hooks:{all:{},add:function add(e,n){var t=M.hooks.all;t[e]=t[e]||[],t[e].push(n)},run:function run(e,n){var t=M.hooks.all[e];if(t&&t.length)for(var r,a=0;r=t[a++];){r(n)}}},Token:W};function W(e,n,t,r){this.type=e,this.content=n,this.alias=t,this.length=0|(r||"").length}function i(){var e={value:null,prev:null,next:null},n={value:null,prev:e,next:null};e.next=n,this.head=e,this.tail=n,this.length=0}function I(e,n,t){var r=n.next,a={value:t,prev:n,next:r};return n.next=a,r.prev=a,e.length++,a}function z(e,n,t){for(var r=n.next,a=0;a<t&&r!==e.tail;a++){r=r.next}(n.next=r).prev=n,e.length-=a}if(u.Prism=M,W.stringify=function n(e,t){if("string"==typeof e)return e;if(Array.isArray(e)){var r="";return e.forEach(function(e){r+=n(e,t)}),r}var a={type:e.type,content:n(e.content,t),tag:"span",classes:["token",e.type],attributes:{},language:t},i=e.alias;i&&(Array.isArray(i)?Array.prototype.push.apply(a.classes,i):a.classes.push(i)),M.hooks.run("wrap",a);var l="";for(var o in a.attributes){l+=" "+o+"=\""+(a.attributes[o]||"").replace(/"/g,"&quot;")+"\""}return"<"+a.tag+" class=\""+a.classes.join(" ")+"\""+l+">"+a.content+"</"+a.tag+">"},!u.document)return u.addEventListener&&(M.disableWorkerMessageHandler||u.addEventListener("message",function(e){var n=JSON.parse(e.data),t=n.language,r=n.code,a=n.immediateClose;u.postMessage(M.highlight(r,M.languages[t],t)),a&&u.close()},!1)),M;var e=M.util.currentScript();function t(){M.manual||M.highlightAll()}if(e&&(M.filename=e.src,e.hasAttribute("data-manual")&&(M.manual=!0)),!M.manual){var r=document.readyState;"loading"===r||"interactive"===r&&e&&e.defer?document.addEventListener("DOMContentLoaded",t):window.requestAnimationFrame?window.requestAnimationFrame(t):window.setTimeout(t,16)}return M}(_self);"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);Prism.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/,name:/[^\s<>'"]+/}},cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup,Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function value(a,e){var s={};s["language-"+e]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[e]},s.cdata=/^<!\[CDATA\[|\]\]>$/i;var n={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:s}};n["language-"+e]={pattern:/[\s\S]+/,inside:Prism.languages[e]};var t={};t[a]={pattern:RegExp("(<__[^]*?>)(?:<!\\[CDATA\\[(?:[^\\]]|\\](?!\\]>))*\\]\\]>|(?!<!\\[CDATA\\[)[^])*?(?=</__>)".replace(/__/g,function(){return a}),"i"),lookbehind:!0,greedy:!0,inside:n},Prism.languages.insertBefore("markup","cdata",t)}}),Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.xml=Prism.languages.extend("markup",{}),Prism.languages.ssml=Prism.languages.xml,Prism.languages.atom=Prism.languages.xml,Prism.languages.rss=Prism.languages.xml;!function(e){var s=/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+[\s\S]*?(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\((?!\s*\))\s*)(?:[^()]|\((?:[^()]|\([^()]*\))*\))+?(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|(?:[^\\\\\r\n()\"']|\\\\[^])*)\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:RegExp("[^{}\\s](?:[^{};\"']|"+s.source+")*?(?=\\s*\\{)"),string:{pattern:s,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var t=e.languages.markup;t&&(t.tag.addInlined("style","css"),e.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:t.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:e.languages.css}},alias:"language-css"}},t.tag))}(Prism);Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|interface|extends|implements|trait|instanceof|new)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])[_$A-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\.(?:prototype|constructor))/,lookbehind:!0}],keyword:[{pattern:/((?:^|})\s*)(?:catch|finally)\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|for|from|function|(?:get|set)(?=\s*[\[$\w\xA0-\uFFFF])|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],number:/\b(?:(?:0[xX](?:[\dA-Fa-f](?:_[\dA-Fa-f])?)+|0[bB](?:[01](?:_[01])?)+|0[oO](?:[0-7](?:_[0-7])?)+)n?|(?:\d(?:_\d)?)+n|NaN|Infinity)\b|(?:\b(?:\d(?:_\d)?)+\.?(?:\d(?:_\d)?)*|\B\.(?:\d(?:_\d)?)+)(?:[Ee][+-]?(?:\d(?:_\d)?)+)?/,function:/#?[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/,Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*]|\\.|[^/\\\[\r\n])+\/[gimyus]{0,6}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/#?[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+[_$A-Za-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)?\s*\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=>)/i,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:[_$A-Za-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})+}|(?!\${)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})+}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\${|}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.js=Prism.languages.javascript;Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},"string-interpolation":{pattern:/(?:f|rf|fr)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:{{)*){(?!{)(?:[^{}]|{(?!{)(?:[^{}]|{(?!{)(?:[^{}])+})+})+}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|rb|br)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|rb|br)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^\s*)@\w+(?:\.\w+)*/im,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:and|as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:True|False|None)\b/,number:/(?:\b(?=\d)|\B(?=\.))(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python;!function(){if("undefined"!=typeof self&&self.Prism&&self.document){var o="line-numbers",a=/\n(?!$)/g,e=Prism.plugins.lineNumbers={getLine:function getLine(e,n){if("PRE"===e.tagName&&e.classList.contains(o)){var t=e.querySelector(".line-numbers-rows"),i=parseInt(e.getAttribute("data-start"),10)||1,r=i+(t.children.length-1);n<i&&(n=i),r<n&&(n=r);var s=n-i;return t.children[s]}},resize:function resize(e){u([e])},assumeViewportIndependence:!0},t=function t(e){return e?window.getComputedStyle?getComputedStyle(e):e.currentStyle||null:null},n=void 0;window.addEventListener("resize",function(){e.assumeViewportIndependence&&n===window.innerWidth||(n=window.innerWidth,u(Array.prototype.slice.call(document.querySelectorAll("pre."+o))))}),Prism.hooks.add("complete",function(e){if(e.code){var n=e.element,t=n.parentNode;if(t&&/pre/i.test(t.nodeName)&&!n.querySelector(".line-numbers-rows")&&Prism.util.isActive(n,o)){n.classList.remove(o),t.classList.add(o);var i,r=e.code.match(a),s=r?r.length+1:1,l=new Array(s+1).join("<span></span>");(i=document.createElement("span")).setAttribute("aria-hidden","true"),i.className="line-numbers-rows",i.innerHTML=l,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(i),u([t]),Prism.hooks.run("line-numbers",e)}}}),Prism.hooks.add("line-numbers",function(e){e.plugins=e.plugins||{},e.plugins.lineNumbers=!0})}function u(e){if(0!=(e=e.filter(function(e){var n=t(e)["white-space"];return"pre-wrap"===n||"pre-line"===n})).length){var n=e.map(function(e){var n=e.querySelector("code"),t=e.querySelector(".line-numbers-rows");if(n&&t){var i=e.querySelector(".line-numbers-sizer"),r=n.textContent.split(a);i||((i=document.createElement("span")).className="line-numbers-sizer",n.appendChild(i)),i.innerHTML="0",i.style.display="block";var s=i.getBoundingClientRect().height;return i.innerHTML="",{element:e,lines:r,lineHeights:[],oneLinerHeight:s,sizer:i}}}).filter(Boolean);n.forEach(function(e){var i=e.sizer,n=e.lines,r=e.lineHeights,s=e.oneLinerHeight;r[n.length-1]=void 0,n.forEach(function(e,n){if(e&&1<e.length){var t=i.appendChild(document.createElement("span"));t.style.display="block",t.textContent=e}else r[n]=s})}),n.forEach(function(e){for(var n=e.sizer,t=e.lineHeights,i=0,r=0;r<t.length;r++){void 0===t[r]&&(t[r]=n.children[i++].getBoundingClientRect().height)}}),n.forEach(function(e){var n=e.sizer,t=e.element.querySelector(".line-numbers-rows");n.style.display="none",n.innerHTML="",e.lineHeights.forEach(function(e,n){t.children[n].style.height=e+"px"})})}}}();define("core/libraries/prism",function(){});define("components/adapt-cmcq/js/adapt-cmcq",["coreJS/adapt","components/adapt-contrib-mcq/js/adapt-contrib-mcq","core/libraries/prism"],function(Adapt,Mcq){var Cmcq=Mcq.view.extend({events:{"focus .cmcq-item input":"onItemFocus","blur .cmcq-item input":"onItemBlur","change .cmcq-item input":"onItemSelected","keyup .cmcq-item input":"onKeyPress"},onItemSelected:function onItemSelected(event){var selectedItemObject=this.model.get("_items")[$(event.currentTarget).parent(".cmcq-item").index()];if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){this.toggleItemSelected(selectedItemObject,event)}},setupQuestion:function setupQuestion(){Mcq.view.prototype.setupQuestion.call(this);this.listenTo(Adapt,{"device:changed":this.resizeImage,"device:resize":this.onDeviceResize})},onQuestionRendered:function onQuestionRendered(){this.$("label").imageready(_.bind(function(){this.setReadyStatus()},this));Prism.highlightAll()}},{template:"cmcq"});return Adapt.register("cmcq",{view:Cmcq,model:Mcq.model.extend({})})});define("components/adapt-contrib-accordion/js/accordionModel",["core/js/models/itemsComponentModel"],function(ItemsComponentModel){var AccordionModel=ItemsComponentModel.extend({defaults:function defaults(){return _.extend({},_.result(ItemsComponentModel.prototype,"defaults"),{_shouldCollapseItems:true,_toggleSpeed:200})},toggleItemsState:function toggleItemsState(index){var item=this.getItem(index);var previousActiveItem=this.getActiveItem();item.toggleActive();item.toggleVisited(true);if(previousActiveItem&&this.get("_shouldCollapseItems")){previousActiveItem.toggleActive(false)}}});return AccordionModel});define("components/adapt-contrib-accordion/js/accordionView",["core/js/views/componentView"],function(ComponentView){var AccordionView=ComponentView.extend({events:{"click .js-toggle-item":"onClick"},preRender:function preRender(){this.checkIfResetOnRevisit();this.model.resetActiveItems();this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange})},postRender:function postRender(){this.setReadyStatus();if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion()}},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},onClick:function onClick(event){event.preventDefault();this.model.toggleItemsState($(event.currentTarget).parent().data("index"))},onItemsActiveChange:function onItemsActiveChange(item,isActive){this.toggleItem(item,isActive)},onItemsVisitedChange:function onItemsVisitedChange(item,isVisited){if(!isVisited)return;var $item=this.getItemElement(item);$item.children(".accordion__item-btn").addClass("is-visited")},toggleItem:function toggleItem(item,shouldExpand){var $item=this.getItemElement(item);var $body=$item.children(".accordion__item-content").stop(true,true);$item.children(".accordion__item-btn").toggleClass("is-selected is-open",shouldExpand).toggleClass("is-closed",!shouldExpand).attr("aria-expanded",shouldExpand);if(!shouldExpand){$body.slideUp(this.model.get("_toggleSpeed"));return}$body.slideDown(this.model.get("_toggleSpeed"))},getItemElement:function getItemElement(item){var index=item.get("_index");return this.$(".accordion__item").filter("[data-index=\""+index+"\"]")}});return AccordionView});define("components/adapt-contrib-accordion/js/adapt-contrib-accordion",["core/js/adapt","./accordionModel","./accordionView"],function(Adapt,AccordionModel,AccordionView){return Adapt.register("accordion",{model:AccordionModel,view:AccordionView})});define("components/adapt-contrib-assessmentResults/js/assessmentResultsModel",["core/js/adapt","core/js/models/componentModel"],function(Adapt,ComponentModel){var AssessmentResultsModel=function(_ComponentModel3){"use strict";_inherits(AssessmentResultsModel,_ComponentModel3);var _super36=_createSuper(AssessmentResultsModel);function AssessmentResultsModel(){_classCallCheck(this,AssessmentResultsModel);return _super36.apply(this,arguments)}_createClass(AssessmentResultsModel,[{key:"init",value:function init(){var _get2;this.set("originalBody",this.get("body"));this.listenTo(Adapt,{"assessments:complete":this.onAssessmentComplete,"assessments:reset":this.onAssessmentReset});for(var _len14=arguments.length,args=new Array(_len14),_key14=0;_key14<_len14;_key14++){args[_key14]=arguments[_key14]}(_get2=_get(_getPrototypeOf(AssessmentResultsModel.prototype),"init",this)).call.apply(_get2,[this].concat(args))}},{key:"checkIfAssessmentComplete",value:function checkIfAssessmentComplete(){if(!Adapt.assessment||this.get("_assessmentId")===undefined){return}var assessmentModel=Adapt.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;var state=assessmentModel.getState();var isResetOnRevisit=assessmentModel.get("_assessment")._isResetOnRevisit;if(state.isComplete&&(!state.allowResetIfPassed||!isResetOnRevisit)){this.onAssessmentComplete(state);return}this.setVisibility()}},{key:"onAssessmentComplete",value:function onAssessmentComplete(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!=state.id)return;this.set({_state:state,attempts:state.attempts,attemptsSpent:state.attemptsSpent,attemptsLeft:state.attemptsLeft,score:state.score,scoreAsPercent:state.scoreAsPercent,maxScore:state.maxScore,isPass:state.isPass});this.setFeedbackBand(state);this.checkRetryEnabled(state);this.setFeedbackText();this.toggleVisibility(true)}},{key:"setFeedbackBand",value:function setFeedbackBand(state){var scoreProp=state.isPercentageBased?"scoreAsPercent":"score";var bands=_.sortBy(this.get("_bands"),"_score");for(var _i7=bands.length-1;_i7>=0;_i7--){var isScoreInBandRange=state[scoreProp]>=bands[_i7]._score;if(!isScoreInBandRange)continue;this.set("_feedbackBand",bands[_i7]);break}}},{key:"checkRetryEnabled",value:function checkRetryEnabled(state){var assessmentModel=Adapt.assessment.get(state.id);if(!assessmentModel.canResetInPage())return false;var feedbackBand=this.get("_feedbackBand");var isRetryEnabled=(feedbackBand&&feedbackBand._allowRetry)!==false;var isAttemptsLeft=state.attemptsLeft>0||state.attemptsLeft==="infinite";var showRetry=isRetryEnabled&&isAttemptsLeft&&(!state.isPass||state.allowResetIfPassed);this.set({_isRetryEnabled:showRetry,retryFeedback:showRetry?this.get("_retry").feedback:""})}},{key:"setFeedbackText",value:function setFeedbackText(){var feedbackBand=this.get("_feedbackBand");var feedback=feedbackBand?Handlebars.compile(feedbackBand.feedback)(this.toJSON()):"";this.set({feedback:feedback,body:this.get("_completionBody")})}},{key:"setVisibility",value:function setVisibility(){if(!Adapt.assessment)return;var isVisibleBeforeCompletion=this.get("_isVisibleBeforeCompletion")||false;var wasVisible=this.get("_isVisible");var assessmentModel=Adapt.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;var state=assessmentModel.getState();var isComplete=state.isComplete;var isAttemptInProgress=state.attemptInProgress;var attemptsSpent=state.attemptsSpent;var hasHadAttempt=!isAttemptInProgress&&attemptsSpent>0;var isVisible=isVisibleBeforeCompletion&&!isComplete||hasHadAttempt;if(!wasVisible&&isVisible)isVisible=(_readOnlyError("isVisible"),false);this.toggleVisibility(isVisible)}},{key:"toggleVisibility",value:function toggleVisibility(isVisible){if(isVisible===undefined){isVisible=!this.get("_isVisible")}this.set("_isVisible",isVisible,{pluginName:"assessmentResults"})}},{key:"checkCompletion",value:function checkCompletion(){if(this.get("_setCompletionOn")==="pass"&&!this.get("isPass")){return}this.setCompletionStatus()}},{key:"onAssessmentReset",value:function onAssessmentReset(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!=state.id)return;var resetType=this.get("_resetType");if(!resetType||resetType==="inherit"){resetType=state.resetType||"hard"}this.reset(resetType,true)}},{key:"reset",value:function reset(){var _get3;this.set({body:this.get("originalBody"),state:null,feedback:"",_feedbackBand:null,retryFeedback:"",_isRetryEnabled:false});for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++){args[_key15]=arguments[_key15]}(_get3=_get(_getPrototypeOf(AssessmentResultsModel.prototype),"reset",this)).call.apply(_get3,[this].concat(args))}}]);return AssessmentResultsModel}(ComponentModel);return AssessmentResultsModel});define("components/adapt-contrib-assessmentResults/js/assessmentResultsView",["core/js/adapt","core/js/views/componentView"],function(Adapt,ComponentView){var AssessmentResultsView=function(_ComponentView2){"use strict";_inherits(AssessmentResultsView,_ComponentView2);var _super37=_createSuper(AssessmentResultsView);function AssessmentResultsView(){_classCallCheck(this,AssessmentResultsView);return _super37.apply(this,arguments)}_createClass(AssessmentResultsView,[{key:"events",value:function events(){return{"click .js-assessment-retry-btn":"onRetryClicked"}}},{key:"preRender",value:function preRender(){this.model.setLocking("_isVisible",false);this.listenTo(Adapt.parentView,"preRemove",function(){this.model.unsetLocking("_isVisible")});this.listenTo(this.model,{"change:_feedbackBand":this.addClassesToArticle,"change:body":this.render})}},{key:"postRender",value:function postRender(){this.model.checkIfAssessmentComplete();this.setReadyStatus();this.setupInviewCompletion(".component__inner",this.model.checkCompletion.bind(this.model))}},{key:"onRetryClicked",value:function onRetryClicked(){var _this67=this;var state=this.model.get("_state");Adapt.assessment.get(state.id).reset(null,function(wasReset){_newArrowCheck(this,_this67);if(!wasReset){return}if(this.model.get("_retry")._routeToAssessment===true){Adapt.navigateToElement("."+state.articleId)}}.bind(this))}},{key:"addClassesToArticle",value:function addClassesToArticle(model,value){if(!value||!value._classes)return;this.$el.parents(".article").addClass(value._classes)}}]);return AssessmentResultsView}(ComponentView);AssessmentResultsView.template="assessmentResults";return AssessmentResultsView});define("components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults",["core/js/adapt","./assessmentResultsModel","./assessmentResultsView"],function(Adapt,AssessmentResultsModel,AssessmentResultsView){return Adapt.register("assessmentResults",{model:AssessmentResultsModel,view:AssessmentResultsView})});define("components/adapt-contrib-blank/js/adapt-contrib-blank",["core/js/adapt","core/js/views/componentView","core/js/models/componentModel"],function(Adapt,ComponentView,ComponentModel){var BlankView=ComponentView.extend({preRender:function preRender(){this.checkIfResetOnRevisit()},postRender:function postRender(){this.setReadyStatus();this.setupInviewCompletion()},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}});return Adapt.register("blank",{model:ComponentModel.extend({}),view:BlankView})});define("components/adapt-contrib-gmcq/js/adapt-contrib-gmcq",["core/js/adapt","components/adapt-contrib-mcq/js/adapt-contrib-mcq"],function(Adapt,Mcq){var Gmcq=Mcq.view.extend({setupQuestion:function setupQuestion(){Mcq.view.prototype.setupQuestion.call(this);this.listenTo(Adapt,{"device:changed":this.resizeImage,"device:resize":this.onDeviceResize})},onQuestionRendered:function onQuestionRendered(){this.resizeImage(Adapt.device.screenSize);this.setUpColumns();this.$(".js-item-label").imageready(this.setReadyStatus.bind(this))},onDeviceResize:function onDeviceResize(){this.setUpColumns()},resizeImage:function resizeImage(width){var imageWidth=width==="medium"?"small":width;this.$(".js-item-label").each(function(index){var $img=$(this).find("img");var newSrc=$img.attr("data-"+imageWidth);if(!newSrc)return;$img.attr("src",newSrc)})},setUpColumns:function setUpColumns(){var columns=this.model.get("_columns");if(!columns)return;var isLarge=Adapt.device.screenSize==="large";this.$el.toggleClass("has-column-layout",isLarge);this.$(".js-mcq-item").css("width",isLarge?100/columns+"%":"")}},{template:"gmcq"});return Adapt.register("gmcq",{view:Gmcq,model:Mcq.model.extend({})})});define("components/adapt-contrib-graphic/js/adapt-contrib-graphic",["core/js/adapt","core/js/views/componentView","core/js/models/componentModel"],function(Adapt,ComponentView,ComponentModel){var GraphicView=ComponentView.extend({preRender:function preRender(){this.listenTo(Adapt,"device:changed",this.resizeImage);this.checkIfResetOnRevisit()},postRender:function postRender(){this.resizeImage(Adapt.device.screenSize,true)},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},resizeImage:function resizeImage(width,setupInView){var imageWidth=width==="medium"?"small":width;var imageSrc=this.model.get("_graphic")?this.model.get("_graphic")[imageWidth]:"";this.$(".js-graphic-set-image-src").attr("src",imageSrc);this.$(".graphic__widget").imageready(function(){this.setReadyStatus();if(setupInView){this.setupInviewCompletion(".graphic__widget")}}.bind(this))}});return Adapt.register("graphic",{model:ComponentModel.extend({}),view:GraphicView})});define("components/adapt-contrib-hotgraphic/js/hotgraphicPopupView",["core/js/adapt"],function(Adapt){'use strict';var HotgraphicPopupView=Backbone.View.extend({className:"hotgraphic-popup",events:{"click .js-hotgraphic-popup-close":"closePopup","click .js-hotgraphic-controls-click":"onControlClick"},initialize:function initialize(){this.onControlClick=_.debounce(this.onControlClick.bind(this),100);this.listenToOnce(Adapt,"notify:opened",this.onOpened);this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange});this.render()},onOpened:function onOpened(){this.applyNavigationClasses(this.model.getActiveItem().get("_index"));this.updatePageCount();this.handleTabs()},applyNavigationClasses:function applyNavigationClasses(index){var itemCount=this.model.get("_items").length;var canCycleThroughPagination=this.model.get("_canCycleThroughPagination");var shouldEnableBack=index>0||canCycleThroughPagination;var shouldEnableNext=index<itemCount-1||canCycleThroughPagination;var $controls=this.$(".hotgraphic-popup__controls");this.$("hotgraphic-popup__nav").toggleClass("first",!shouldEnableBack).toggleClass("last",!shouldEnableNext);Adapt.a11y.toggleAccessibleEnabled($controls.filter(".back"),shouldEnableBack);Adapt.a11y.toggleAccessibleEnabled($controls.filter(".next"),shouldEnableNext)},updatePageCount:function updatePageCount(){var template=Adapt.course.get("_globals")._components._hotgraphic.popupPagination||"{{itemNumber}} / {{totalItems}}";var labelText=Handlebars.compile(template)({itemNumber:this.model.getActiveItem().get("_index")+1,totalItems:this.model.get("_items").length});this.$(".hotgraphic-popup__count").html(labelText)},handleTabs:function handleTabs(){Adapt.a11y.toggleHidden(this.$(".hotgraphic-popup__item:not(.is-active) *"),true);Adapt.a11y.toggleHidden(this.$(".hotgraphic-popup__item.is-active *"),false)},onItemsActiveChange:function onItemsActiveChange(item,_isActive){if(!_isActive)return;var index=item.get("_index");this.updatePageCount();this.applyItemClasses(index);this.handleTabs();this.handleFocus(index)},applyItemClasses:function applyItemClasses(index){this.$(".hotgraphic-popup__item[data-index=\""+index+"\"]").addClass("is-active").removeAttr("aria-hidden");this.$(".hotgraphic-popup__item[data-index=\""+index+"\"] .hotgraphic-popup__item-title").attr("id","notify-heading");this.$(".hotgraphic-popup__item:not([data-index=\""+index+"\"])").removeClass("is-active").attr("aria-hidden","true");this.$(".hotgraphic-popup__item:not([data-index=\""+index+"\"]) .hotgraphic-popup__item-title").removeAttr("id")},handleFocus:function handleFocus(index){Adapt.a11y.focusFirst(this.$(".hotgraphic-popup__inner .is-active"));this.applyNavigationClasses(index)},onItemsVisitedChange:function onItemsVisitedChange(item,_isVisited){if(!_isVisited)return;this.$(".hotgraphic-popup__item").filter("[data-index=\""+item.get("_index")+"\"]").addClass("is-visited")},render:function render(){var data=this.model.toJSON();data.view=this;var template=Handlebars.templates["hotgraphicPopup"];this.$el.html(template(data))},closePopup:function closePopup(event){Adapt.trigger("notify:close")},onControlClick:function onControlClick(event){var direction=$(event.currentTarget).hasClass("back")?"back":"next";var index=this.getNextIndex(direction);if(index!==-1){this.setItemState(index)}},getNextIndex:function getNextIndex(direction){var index=this.model.getActiveItem().get("_index");var lastIndex=this.model.get("_items").length-1;switch(direction){case"back":if(index>0)return--index;if(this.model.get("_canCycleThroughPagination"))return lastIndex;break;case"next":if(index<lastIndex)return++index;if(this.model.get("_canCycleThroughPagination"))return 0;}return-1},setItemState:function setItemState(index){this.model.getActiveItem().toggleActive();var nextItem=this.model.getItem(index);nextItem.toggleActive();nextItem.toggleVisited(true)}});return HotgraphicPopupView});define("components/adapt-contrib-hotgraphic/js/hotgraphicView",["core/js/adapt","core/js/views/componentView","./hotgraphicPopupView"],function(Adapt,ComponentView,HotgraphicPopupView){'use strict';var HotGraphicView=ComponentView.extend({events:{"click .js-hotgraphic-item-click":"onPinClicked"},initialize:function initialize(){ComponentView.prototype.initialize.call(this);this.setUpViewData();this.setUpModelData();this.setUpEventListeners();this.checkIfResetOnRevisit()},setUpViewData:function setUpViewData(){this.popupView=null;this._isPopupOpen=false},setUpModelData:function setUpModelData(){if(this.model.get("_canCycleThroughPagination")===undefined){this.model.set("_canCycleThroughPagination",false)}},setUpEventListeners:function setUpEventListeners(){this.listenTo(Adapt,"device:changed",this.reRender);this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange})},reRender:function reRender(){if(Adapt.device.screenSize!=="large"){this.replaceWithNarrative()}},replaceWithNarrative:function replaceWithNarrative(){var NarrativeView=Adapt.getViewClass("narrative");var model=this.prepareNarrativeModel();var newNarrative=new NarrativeView({model:model});var $container=$(".component__container",$("."+this.model.get("_parentId")));newNarrative.reRender();newNarrative.setupNarrative();$container.append(newNarrative.$el);Adapt.trigger("device:resize");_.defer(this.remove.bind(this))},prepareNarrativeModel:function prepareNarrativeModel(){var model=this.model;model.set({"_component":"narrative","_wasHotgraphic":true,"originalBody":model.get("body"),"originalInstruction":model.get("instruction")});var activeItem=model.getActiveItem();if(!activeItem){model.getItem(0).toggleActive(true)}if(model.get("mobileBody")){model.set("body",model.get("mobileBody"))}if(model.get("mobileInstruction")){model.set("instruction",model.get("mobileInstruction"))}return model},onItemsActiveChange:function onItemsActiveChange(model,_isActive){this.getItemElement(model).toggleClass("is-active",_isActive)},getItemElement:function getItemElement(model){var index=model.get("_index");return this.$(".js-hotgraphic-item-click").filter("[data-index=\""+index+"\"]")},onItemsVisitedChange:function onItemsVisitedChange(model,_isVisited){if(!_isVisited)return;var $pin=this.getItemElement(model);var visitedLabel=this.model.get("_globals")._accessibility._ariaLabels.visited+".";$pin.find(".aria-label").each(function(index,el){el.innerHTML+=" "+visitedLabel});$pin.addClass("is-visited")},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},preRender:function preRender(){if(Adapt.device.screenSize==="large"){this.render()}else{this.reRender()}},postRender:function postRender(){this.$(".hotgraphic__widget").imageready(this.setReadyStatus.bind(this));if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".component__widget")}},onPinClicked:function onPinClicked(event){if(event)event.preventDefault();var item=this.model.getItem($(event.currentTarget).data("index"));item.toggleActive(true);item.toggleVisited(true);this.openPopup()},openPopup:function openPopup(){if(this._isPopupOpen)return;this._isPopupOpen=true;this.popupView=new HotgraphicPopupView({model:this.model});Adapt.trigger("notify:popup",{_view:this.popupView,_isCancellable:true,_showCloseButton:false,_classes:"hotgraphic "+this.model.get("_classes")});this.listenToOnce(Adapt,{"popup:closed":this.onPopupClosed})},onPopupClosed:function onPopupClosed(){this.model.getActiveItem().toggleActive();this._isPopupOpen=false}});return HotGraphicView});define("components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic",["core/js/adapt","./hotgraphicView","core/js/models/itemsComponentModel"],function(Adapt,HotgraphicView,ItemsComponentModel){return Adapt.register("hotgraphic",{model:ItemsComponentModel.extend({}),view:HotgraphicView})});define("components/adapt-contrib-matching/js/dropdownOption",[],function(){var DropDownItem=Backbone.View.extend({events:{"click":"onClick","click *":"onClick"},initialize:function initialize(settings){this.settings=settings;this.$inner=this.$(".js-dropdown-list-item-inner")},isPlaceholder:function isPlaceholder(){return this.$el.is("[hidden]")},parent:function parent(){return this.settings.parent},onClick:function onClick(event){var parent=this.parent();event.preventDefault();this.select().scrollTo();parent.$button.focus()},getValue:function getValue(){return this.$el.attr("value").trim()},select:function select(){var parent=this.parent();parent.deselectAll();parent.setActiveDescendantId(this.el.id);this.$el.attr({selected:"","aria-selected":"true"});parent.$inner.html(this.$el.attr("text"));var value=this.isPlaceholder()?"":this.getValue();parent.$input.val(value).trigger("change");parent.trigger("change",parent);return this},deselect:function deselect(){if(!this.isSelected())return this;var parent=this.parent();parent.removeActiveDescendantId();this.$el.removeAttr("selected");this.$el.attr("aria-selected","false");parent.$inner.html("");parent.$input.val("").trigger("change");parent.trigger("change",parent);return this},reselect:function reselect(){var parent=this.parent();parent.setActiveDescendantId(this.$el[0].id);if(this.isSelected())return this;this.select();return this},isSelected:function isSelected(){return Boolean(this.$el.attr("selected"))},getIndex:function getIndex(){var parent=this.parent();return _.findIndex(parent.options,function(option){return option===this}.bind(this))},getNext:function getNext(){var parent=this.parent();return parent.options[this.getIndex()+1]},getPrevious:function getPrevious(){var parent=this.parent();return parent.options[this.getIndex()-1]},getFirst:function getFirst(){var parent=this.parent();return parent.options[0]},getLast:function getLast(){var parent=this.parent();return parent.options[parent.options.length-1]},scrollTo:function scrollTo(){var parent=this.parent();parent.settings.scrollToItem.call(parent,this)},destroy:function destroy(){var parent=this.parent();this.remove();if(this.isPlaceholder()){parent.placeholder=null}else{for(var i=0,l=parent.options.length;i<l;i++){var item=parent.options[i];if(item!==this)continue;parent.options.splice(i,1);break}}delete this.settings}});return DropDownItem});define("components/adapt-contrib-matching/js/dropdown",["./dropdownOption"],function(DropDownOption){var DropDown=Backbone.View.extend({initialize:function initialize(settings){_.bindAll(this,"onStartInteraction","onButtonClick","onListBlur","onKeyDown");this.settings=_.defaults(settings,this.getDefaults());this.placeholder=null;this.options=[];this.setUpElements();this.setUpItems();this.select(this.settings.value);this.addEventListeners();this.toggleOpen(false);this.settings.load.call(this,this);this.trigger("load",this)},getDefaults:function getDefaults(){return{load:DropDown.defaults.load,openList:DropDown.defaults.openList,closeList:DropDown.defaults.closeList,scrollToItem:DropDown.defaults.scrollToItem}},setUpElements:function setUpElements(){this.$list=this.$(".js-dropdown-list");this.$button=this.$(".js-dropdown-btn");this.$inner=this.$button.find(".js-dropdown-inner");this.$input=this.$(".js-data-output")},setUpItems:function setUpItems(){var $options=this.$(".js-dropdown-list-item");$options.each(function(index,el){var option=new DropDownOption({parent:this,el:el});if(option.isPlaceholder()){this.placeholder=option;return}this.options.push(option)}.bind(this))},addEventListeners:function addEventListeners(){this.$button.on({"mousedown touchstart":this.onStartInteraction,click:this.onButtonClick});this.$list.on("blur",this.onListBlur);$(document).on("keydown",this.onKeyDown)},onStartInteraction:function onStartInteraction(){this.wasOpen=this.isOpen()},deselectAll:function deselectAll(){this.placeholder.deselect();this.options.forEach(function(option){option.deselect()})},onButtonClick:function onButtonClick(event){if(this.wasOpen||this.isOpen()){this.wasOpen=false;return}this.toggleOpen();var option=this.getFirstSelectedItem()||this.placeholder;if(!option)return;option.reselect();option.scrollTo();this.$list.focus()},isOpen:function isOpen(){return!this.$list.hasClass("u-display-none")},toggleOpen:function toggleOpen(open){if(open===undefined)open=!this.isOpen();if(open)clearTimeout(this.blurTimeout);this.$button.attr("aria-expanded",open?"true":"false");var name=open?"openList":"closeList";this.settings[name].call(this,this);this.trigger(name,this)},onListBlur:function onListBlur(event){var handleBlur=function(){this.toggleOpen(false);this.removeActiveDescendantId()}.bind(this);this.blurTimeout=setTimeout(handleBlur,100)},onKeyDown:function onKeyDown(event){if(!this.isOpen())return;var option=this.getFirstSelectedItem()||this.placeholder;switch(event.keyCode){case 38:event.preventDefault();option=option.getPrevious()||option.getLast();break;case 40:event.preventDefault();option=option.getNext()||option.getFirst();break;case 13:case 32:case 27:event.preventDefault();this.$button.focus();return;default:return;}option.select().scrollTo()},getFirstSelectedItem:function getFirstSelectedItem(){return _.find(this.options,function(option){return option.isSelected()})},setActiveDescendantId:function setActiveDescendantId(id){this.$list.attr("aria-activedescendant",id)},removeActiveDescendantId:function removeActiveDescendantId(){this.$list.removeAttr("aria-activedescendant")},select:function select(value){value=String(value);var option=_.find(this.options,function(option){return option.getValue()===value});if(option){option.select();return}this.placeholder.select()},toggleDisabled:function toggleDisabled(value){if(value===undefined){value=!this.$input.attr("disabled")}if(value===false){this.$input.removeAttr("disabled");this.$button.removeAttr("disabled").removeClass("is-disabled");this.$el.removeAttr("disabled");return}this.$input.attr("disabled","");this.$button.attr("disabled","").addClass("is-disabled");this.$el.attr("disabled","")},isEmpty:function isEmpty(){return!this.getFirstSelectedItem()},val:function val(){return this.$input.val()},destroy:function destroy(){this.removeEventListeners();this.$el.remove();delete this.options;delete this.$input;delete this.$inner;delete this.$button;delete this.$list;delete this.$el},removeEventListeners:function removeEventListeners(){this.$button.off({"mousedown touchstart":this.onStartInteraction,click:this.onButtonClick});this.$list.off("blur",this.onListBlur);$(document).off("keydown",this.onKeyDown)}},{defaults:{load:function load(){},openList:function openList(){this.$list.css({top:"",left:this.$button[0].offsetLeft,width:this.$button.outerWidth()}).addClass("u-visibility-hidden").removeClass("u-display-none");var offset=this.$list[0].getBoundingClientRect();var height=this.$list.height();var windowHeight=$(window).height();var isOffscreen=offset.top+height>windowHeight;this.$list.css("top",isOffscreen?-height:"").removeClass("u-visibility-hidden").focus()},closeList:function closeList(){this.$list.removeClass("u-visibility-hidden").addClass("u-display-none").css("top","")},scrollToItem:function scrollToItem(option){var height=this.$list[0].clientHeight;var pos=option.$el[0].offsetTop-height/2;this.$list[0].scrollTop=pos}}});return DropDown});define("components/adapt-contrib-matching/js/matchingView",["core/js/adapt","core/js/views/questionView","./dropdown"],function(Adapt,QuestionView,DropDown){var MatchingView=QuestionView.extend({dropdowns:null,disableQuestion:function disableQuestion(){this.dropdowns.forEach(function(dropdown){dropdown.toggleDisabled(true)})},enableQuestion:function enableQuestion(){this.dropdowns.forEach(function(dropdown){dropdown.toggleDisabled(false)})},resetQuestionOnRevisit:function resetQuestionOnRevisit(){this.resetQuestion()},setupQuestion:function setupQuestion(){this.listenToOnce(Adapt.parentView,"postRemove",this.onPostRemove);this.model.setupRandomisation()},onPostRemove:function onPostRemove(){this.dropdowns.forEach(function(dropdown){dropdown.off("change",this.onOptionSelected);dropdown.destroy()},this)},onQuestionRendered:function onQuestionRendered(){this.setReadyStatus();this.setUpDropdowns()},setUpDropdowns:function setUpDropdowns(){_.bindAll(this,"onOptionSelected");this.dropdowns=[];var items=this.model.get("_items");this.$(".matching__item").each(function(i,el){var item=items[i];var selectedOption=_.find(item._options,function(option){return option._isSelected});var value=selectedOption?selectedOption._index:null;var dropdown=new DropDown({el:$(el).find(".dropdown")[0],placeholder:this.model.get("placeholder"),value:value});this.dropdowns.push(dropdown);dropdown.on("change",this.onOptionSelected)}.bind(this));this.enableQuestion();if(this.model.get("_isEnabled")!==true){this.disableQuestion()}},onCannotSubmit:function onCannotSubmit(){this.dropdowns.forEach(function(dropdown){if(!dropdown.isEmpty())return;dropdown.$el.parents(".matching__select-container").addClass("has-error")})},onOptionSelected:function onOptionSelected(dropdown){if(this.model.get("_isInteractionComplete"))return;var $container=dropdown.$el.parents(".matching__select-container");$container.removeClass("error");var itemIndex=dropdown.$el.parents(".matching__item").index();if(dropdown.isEmpty())return;var optionIndex=parseInt(dropdown.val());this.model.setOptionSelected(itemIndex,optionIndex,true)},showMarking:function showMarking(){if(!this.model.get("_canShowMarking"))return;this.model.get("_items").forEach(function(item,i){var $item=this.$(".matching__item").eq(i);$item.removeClass("is-correct is-incorrect").addClass(item._isCorrect?"is-correct":"is-incorrect")},this)},resetQuestion:function resetQuestion(){this.$(".matching__item").removeClass("is-correct is-incorrect");this.model.set("_isAtLeastOneCorrectSelection",false);var resetAll=this.model.get("_shouldResetAllAnswers");this.model.get("_items").forEach(function(item,index){if(item._isCorrect&&resetAll===false)return;this.selectValue(index,null);item._options.forEach(function(option,index){option._isSelected=false});item._selected=null},this)},showCorrectAnswer:function showCorrectAnswer(){this.model.get("_items").forEach(function(item,index){var correctOption=_.findWhere(item._options,{_isCorrect:true});this.selectValue(index,correctOption._index)},this)},hideCorrectAnswer:function hideCorrectAnswer(){var answerArray=this.model.has("_tempUserAnswer")?this.model.get("_tempUserAnswer"):this.model.get("_userAnswer");this.model.get("_items").forEach(function(item,index){var key=answerArray[index];var value=item._options[key]._index;this.selectValue(index,value)},this)},selectValue:function selectValue(index,optionIndex){if(!this.dropdowns)return;var dropdown=this.dropdowns[index];if(!dropdown)return;dropdown.select(optionIndex)}});return MatchingView});define("components/adapt-contrib-matching/js/matchingModel",["core/js/models/questionModel"],function(QuestionModel){var MatchingModel=QuestionModel.extend({init:function init(){QuestionModel.prototype.init.call(this);this.setupQuestionItemIndexes()},setupQuestionItemIndexes:function setupQuestionItemIndexes(){this.get("_items").forEach(function(item,index){if(item._index===undefined){item._index=index;item._selected=false}item._options.forEach(function(option,index){if(option._index===undefined){option._index=index;option._isSelected=false}})})},setupRandomisation:function setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;this.get("_items").forEach(function(item){item._options=_.shuffle(item._options)})},restoreUserAnswers:function restoreUserAnswers(){if(!this.get("_isSubmitted"))return;var userAnswer=this.get("_userAnswer");this.get("_items").forEach(function(item,index){item._options.forEach(function(option,index){if(option._index===userAnswer[item._index]){option._isSelected=true;item._selected=option}})});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},canSubmit:function canSubmit(){var canSubmit=_.every(this.get("_items"),function(item){return _.findWhere(item._options,{"_isSelected":true})!==undefined});return canSubmit},setOptionSelected:function setOptionSelected(itemIndex,optionIndex,isSelected){var item=this.get("_items")[itemIndex];var option=_.findWhere(item._options,{"_index":optionIndex});option._isSelected=isSelected;item._selected=option},storeUserAnswer:function storeUserAnswer(){var userAnswer=new Array(this.get("_items").length);var tempUserAnswer=new Array(this.get("_items").length);this.get("_items").forEach(function(item,index){var optionIndex=_.findIndex(item._options,function(o){return o._isSelected});tempUserAnswer[item._index]=optionIndex;userAnswer[item._index]=item._options[optionIndex]._index},this);this.set({"_userAnswer":userAnswer,"_tempUserAnswer":tempUserAnswer})},isCorrect:function isCorrect(){var numberOfCorrectAnswers=0;this.get("_items").forEach(function(item,index){var isCorrect=item._selected&&item._selected._isCorrect;if(!isCorrect){item._isCorrect=false;return}numberOfCorrectAnswers++;item._isCorrect=true;this.set({"_numberOfCorrectAnswers":numberOfCorrectAnswers,"_isAtLeastOneCorrectSelection":true})},this);this.set("_numberOfCorrectAnswers",numberOfCorrectAnswers);if(numberOfCorrectAnswers===this.get("_items").length){return true}return false},setScore:function setScore(){var questionWeight=this.get("_questionWeight");if(this.get("_isCorrect")){this.set("_score",questionWeight);return}var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var itemLength=this.get("_items").length;var score=questionWeight*numberOfCorrectAnswers/itemLength;this.set("_score",score)},isPartlyCorrect:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function resetUserAnswer(){this.set("_userAnswer",[])},getInteractionObject:function getInteractionObject(){var interactions={correctResponsesPattern:null,source:null,target:null};var items=this.get("_items");interactions.correctResponsesPattern=[items.map(function(item,questionIndex){questionIndex=questionIndex+1;return[questionIndex,item._options.filter(function(item){return item._isCorrect}).map(function(item){return questionIndex+"_"+(item._index+1).toString()})].join("[.]")}).join("[,]")];interactions.source=_.flatten(items.map(function(item){return{id:(item._index+1).toString(),description:item.text}}));interactions.target=_.flatten(items.map(function(item,index){index=index+1;return item._options.map(function(option){return{id:index+"_"+(option._index+1),description:option.text}})}));return interactions},getResponse:function getResponse(){var responses=[];this.get("_userAnswer").forEach(function(userAnswer,index){responses.push(index+1+"."+(userAnswer+1))});return responses.join("#")},getResponseType:function getResponseType(){return"matching"}});return MatchingModel});define("components/adapt-contrib-matching/js/adapt-contrib-matching",["core/js/adapt","./matchingView","./matchingModel"],function(Adapt,MatchingView,MatchingModel){return Adapt.register("matching",{view:MatchingView,model:MatchingModel})});define("components/adapt-contrib-media/js/adapt-contrib-media",["core/js/adapt","core/js/views/componentView","core/js/models/componentModel","libraries/mediaelement-and-player","libraries/mediaelement-fullscreen-hook"],function(Adapt,ComponentView,ComponentModel){var froogaloopAdded=false;function purge(d){var a=d.attributes,i,l,n;if(a){for(i=a.length-1;i>=0;i-=1){n=a[i].name;if(typeof d[n]==="function"){d[n]=null}}}a=d.childNodes;if(a){l=a.length;for(i=0;i<l;i+=1){purge(d.childNodes[i])}}}_.extend(mejs.MepDefaults,{keyActions:[],defaultSeekForwardInterval:function defaultSeekForwardInterval(duration){if(_typeof(duration)==="object")return duration.duration*0.05;return duration*0.05},defaultSeekBackwardInterval:function defaultSeekBackwardInterval(duration){if(_typeof(duration)==="object")return duration.duration*0.05;return duration*0.05}});var MediaView=ComponentView.extend({events:{"click .js-media-inline-transcript-toggle":"onToggleInlineTranscript","click .js-media-external-transcript-click":"onExternalTranscriptClicked","click .js-skip-to-transcript":"onSkipToTranscript"},className:function className(){var classes=ComponentView.prototype.className.call(this);var playerOptions=this.model.get("_playerOptions");if(playerOptions&&playerOptions.toggleCaptionsButtonWhenOnlyOne){classes+=" toggle-captions"}return classes},preRender:function preRender(){this.listenTo(Adapt,{"device:resize":this.onScreenSizeChanged,"device:changed":this.onDeviceChanged,"media:stop":this.onMediaStop});_.bindAll(this,"onMediaElementPlay","onMediaElementPause","onMediaElementEnded","onMediaElementTimeUpdate","onMediaElementSeeking");this.model.set({"_isMediaEnded":false,"_isMediaPlaying":false});if(this.model.get("_media").source){var media=this.model.get("_media");if(window.location.protocol==="https:"&&media.source.indexOf("http:")===0){media.source=media.source.replace(/^http\:/,"https:")}this.model.set("_media",media)}this.checkIfResetOnRevisit()},postRender:function postRender(){this.setupPlayer();this.addMejsButtonClass()},addMejsButtonClass:function addMejsButtonClass(){this.$(".mejs-overlay-button").addClass("icon")},setupPlayer:function setupPlayer(){if(!this.model.get("_playerOptions"))this.model.set("_playerOptions",{});var modelOptions=this.model.get("_playerOptions");if(modelOptions.pluginPath===undefined){_.extend(modelOptions,{pluginPath:"https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/",flashName:"flashmediaelement-cdn.swf",flashScriptAccess:"always"})}if(modelOptions.features===undefined){modelOptions.features=["playpause","progress","current","duration"];if(this.model.get("_useClosedCaptions")){modelOptions.features.unshift("tracks")}if(this.model.get("_allowFullScreen")){modelOptions.features.push("fullscreen")}if(this.model.get("_showVolumeControl")){modelOptions.features.push("volume")}}modelOptions.success=_.debounce(this.onPlayerReady.bind(this),100);if(this.model.get("_useClosedCaptions")){var startLanguage=this.model.get("_startLanguage")||"en";if(!Adapt.offlineStorage.get("captions")){Adapt.offlineStorage.set("captions",startLanguage)}modelOptions.startLanguage=this.checkForSupportedCCLanguage(Adapt.offlineStorage.get("captions"))}if(modelOptions.alwaysShowControls===undefined){modelOptions.alwaysShowControls=false}if(modelOptions.hideVideoControlsOnLoad===undefined){modelOptions.hideVideoControlsOnLoad=true}this.addMediaTypeClass();this.addThirdPartyFixes(modelOptions,function createPlayer(){this.$("audio, video").mediaelementplayer(modelOptions);this.cleanUpPlayer();var _media=this.model.get("_media");if(!_media.mp3&&!_media.mp4&&!_media.ogv&&!_media.webm&&!_media.source){Adapt.log.warn("ERROR! No media is selected in components.json for component "+this.model.get("_id"));this.setReadyStatus();return}if(_media.source){this.$(".media-widget").addClass("external-source")}}.bind(this))},addMediaTypeClass:function addMediaTypeClass(){var media=this.model.get("_media");if(media&&media.type){var typeClass=media.type.replace(/\//,"-");this.$(".media__widget").addClass(typeClass)}},addThirdPartyFixes:function addThirdPartyFixes(modelOptions,callback){var media=this.model.get("_media");if(!media)return callback();switch(media.type){case"video/vimeo":modelOptions.alwaysShowControls=false;modelOptions.hideVideoControlsOnLoad=true;modelOptions.features=[];if(froogaloopAdded)return callback();$.getScript("assets/froogaloop.js").done(function(){froogaloopAdded=true;callback()}).fail(function(){froogaloopAdded=false;console.log("Could not load froogaloop.js")});break;default:callback();}},cleanUpPlayer:function cleanUpPlayer(){this.$(".media__widget").children(".mejs-offscreen").remove();this.$("[role=application]").removeAttr("role tabindex");this.$("[aria-controls]").removeAttr("aria-controls")},setupEventListeners:function setupEventListeners(){this.completionEvent=this.model.get("_setCompletionOn")||"play";if(this.completionEvent==="inview"){this.setupInviewCompletion(".component__widget")}if(this.model.get("_preventForwardScrubbing")&&!this.model.get("_isComplete")){$(this.mediaElement).on({"seeking":this.onMediaElementSeeking,"timeupdate":this.onMediaElementTimeUpdate})}$(this.mediaElement).on({"play":this.onMediaElementPlay,"pause":this.onMediaElementPause,"ended":this.onMediaElementEnded});_.delay(this.listenForCaptionsChange.bind(this),250)},listenForCaptionsChange:function listenForCaptionsChange(){if(!this.model.get("_useClosedCaptions"))return;var selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).on("click.mediaCaptionsChange",_.debounce(function(){var srclang=this.mediaElement.player.selectedTrack?this.mediaElement.player.selectedTrack.srclang:"none";Adapt.offlineStorage.set("captions",srclang);Adapt.trigger("media:captionsChange",this,srclang)}.bind(this),250));this.listenTo(Adapt,"media:captionsChange",this.onCaptionsChanged)},onCaptionsChanged:function onCaptionsChanged(view,lang){if(view&&view.cid===this.cid)return;lang=this.checkForSupportedCCLanguage(lang);this.mediaElement.player.setTrack(lang);var $inputs=this.$(".mejs-captions-selector input");$inputs.filter(":checked").prop("checked",false);$inputs.filter("[value=\""+lang+"\"]").prop("checked",true)},checkForSupportedCCLanguage:function checkForSupportedCCLanguage(lang){if(!lang||lang==="none")return"none";if(_.findWhere(this.model.get("_media").cc,{srclang:lang}))return lang;return this.model.get("_startLanguage")||"none"},onMediaElementPlay:function onMediaElementPlay(event){this.queueGlobalEvent("play");Adapt.trigger("media:stop",this);if(this.model.get("_pauseWhenOffScreen"))$(this.mediaElement).on("inview",this.onMediaElementInview);this.model.set({"_isMediaPlaying":true,"_isMediaEnded":false});if(this.completionEvent==="play"){this.setCompletionStatus()}},onMediaElementPause:function onMediaElementPause(event){this.queueGlobalEvent("pause");$(this.mediaElement).off("inview",this.onMediaElementInview);this.model.set("_isMediaPlaying",false)},onMediaElementEnded:function onMediaElementEnded(event){this.queueGlobalEvent("ended");this.model.set("_isMediaEnded",true);if(this.completionEvent==="ended"){this.setCompletionStatus()}},onMediaElementInview:function onMediaElementInview(event,isInView){if(!isInView&&!event.currentTarget.paused)event.currentTarget.pause()},onMediaElementSeeking:function onMediaElementSeeking(event){var maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime>maxViewed){event.target.currentTime=maxViewed}},onMediaElementTimeUpdate:function onMediaElementTimeUpdate(event){var maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime>maxViewed){this.model.set("_maxViewed",event.target.currentTime)}},setupPlayPauseToggle:function setupPlayPauseToggle(){var player=this.mediaElement.player;if(!player){console.log("Media.setupPlayPauseToggle: OOPS! there's no player reference.");return}player.options.clickToPlayPause=false;this.onOverlayClick=this.onOverlayClick.bind(this);this.onMediaElementClick=this.onMediaElementClick.bind(this);this.$(".mejs-overlay-button").on("click",this.onOverlayClick);this.$(".mejs-mediaelement").on("click",this.onMediaElementClick)},onMediaStop:function onMediaStop(view){if(view&&view.cid===this.cid)return;if(!this.mediaElement||!this.mediaElement.player)return;this.mediaElement.player.pause()},onOverlayClick:function onOverlayClick(){var player=this.mediaElement.player;if(!player)return;player.play()},onMediaElementClick:function onMediaElementClick(event){var player=this.mediaElement.player;if(!player)return;var isPaused=player.media.paused;if(!isPaused)player.pause()},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},remove:function remove(){this.$(".mejs-overlay-button").off("click",this.onOverlayClick);this.$(".mejs-mediaelement").off("click",this.onMediaElementClick);if(this.model.get("_useClosedCaptions")){var selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).off("click.mediaCaptionsChange")}var modelOptions=this.model.get("_playerOptions");delete modelOptions.success;var media=this.model.get("_media");if(media){switch(media.type){case"video/vimeo":this.$("iframe")[0].isRemoved=true;}}if(this.mediaElement&&this.mediaElement.player){var player_id=this.mediaElement.player.id;purge(this.$el[0]);this.mediaElement.player.remove();if(mejs.players[player_id]){delete mejs.players[player_id]}}if(this.mediaElement){$(this.mediaElement).off({"play":this.onMediaElementPlay,"pause":this.onMediaElementPause,"ended":this.onMediaElementEnded,"seeking":this.onMediaElementSeeking,"timeupdate":this.onMediaElementTimeUpdate,"inview":this.onMediaElementInview});this.mediaElement.src="";$(this.mediaElement.pluginElement).remove();delete this.mediaElement}ComponentView.prototype.remove.call(this)},onDeviceChanged:function onDeviceChanged(){if(this.model.get("_media").source){this.$(".mejs-container").width(this.$(".component__widget").width())}},onPlayerReady:function onPlayerReady(mediaElement,domObject){this.mediaElement=mediaElement;var player=this.mediaElement.player;if(!player)player=mejs.players[this.$(".mejs-container").attr("id")];var hasTouch=mejs.MediaFeatures.hasTouch;if(hasTouch){this.setupPlayPauseToggle()}this.addThirdPartyAfterFixes();this.cleanUpPlayerAfter();if(player&&this.model.has("_startVolume")){player.setVolume(parseInt(this.model.get("_startVolume"))/100)}this.setReadyStatus();this.setupEventListeners()},addThirdPartyAfterFixes:function addThirdPartyAfterFixes(){var media=this.model.get("_media");switch(media.type){case"video/vimeo":this.$(".mejs-container").attr("tabindex",0);}},cleanUpPlayerAfter:function cleanUpPlayerAfter(){this.$("[aria-valuemax='NaN']").attr("aria-valuemax",0)},onScreenSizeChanged:function onScreenSizeChanged(){this.$("audio, video").width(this.$(".component__widget").width())},onSkipToTranscript:function onSkipToTranscript(){_.delay(function(){this.$(".media__transcript-btn").a11y_focus()}.bind(this),250)},onToggleInlineTranscript:function onToggleInlineTranscript(event){if(event)event.preventDefault();var $transcriptBodyContainer=this.$(".media__transcript-body-inline");var $button=this.$(".media__transcript-btn-inline");var $buttonText=this.$(".media__transcript-btn-inline .media__transcript-btn-text");if($transcriptBodyContainer.hasClass("inline-transcript-open")){$transcriptBodyContainer.stop(true,true).slideUp(function(){$(window).resize()});$button.attr("aria-expanded",false);$transcriptBodyContainer.removeClass("inline-transcript-open");$buttonText.html(this.model.get("_transcript").inlineTranscriptButton)}else{$transcriptBodyContainer.stop(true,true).slideDown(function(){$(window).resize()});$button.attr("aria-expanded",true);$transcriptBodyContainer.addClass("inline-transcript-open");$buttonText.html(this.model.get("_transcript").inlineTranscriptCloseButton);if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}}},onExternalTranscriptClicked:function onExternalTranscriptClicked(event){if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}},queueGlobalEvent:function queueGlobalEvent(eventType){var t=Date.now();var lastEvent=this.lastEvent||{time:0};var timeSinceLastEvent=t-lastEvent.time;var debounceTime=500;this.lastEvent={time:t,type:eventType};clearTimeout(this.eventTimeout);if(eventType==="ended"){return this.triggerGlobalEvent(eventType)}if(timeSinceLastEvent>debounceTime){this.eventTimeout=setTimeout(this.triggerGlobalEvent.bind(this,eventType),debounceTime)}},triggerGlobalEvent:function triggerGlobalEvent(eventType){var player=this.mediaElement.player;var eventObj={type:eventType,src:this.mediaElement.src,platform:this.mediaElement.pluginType};if(player)eventObj.isVideo=player.isVideo;Adapt.trigger("media",eventObj)}});return Adapt.register("media",{model:ComponentModel.extend({}),view:MediaView})});define("components/adapt-contrib-narrative/js/modeEnum",[],function(){return new ENUM(["SMALL","LARGE"])});define("components/adapt-contrib-narrative/js/narrativeView",["core/js/adapt","core/js/views/componentView","./modeEnum"],function(Adapt,ComponentView,MODE){'use strict';var NarrativeView=ComponentView.extend({_isInitial:true,events:{"click .js-narrative-strapline-open-popup":"openPopup","click .js-narrative-controls-click":"onNavigationClicked","click .js-narrative-progress-click":"onProgressClicked"},preRender:function preRender(){this.listenTo(Adapt,{"device:changed device:resize":this.reRender,"notify:closed":this.closeNotify});this.renderMode();this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange});this.checkIfResetOnRevisit();this.calculateWidths()},onItemsActiveChange:function onItemsActiveChange(item,_isActive){if(_isActive===true){this.setStage(item)}},onItemsVisitedChange:function onItemsVisitedChange(item,isVisited){if(!isVisited)return;this.$("[data-index=\""+item.get("_index")+"\"]").addClass("is-visited")},calculateMode:function calculateMode(){var mode=Adapt.device.screenSize==="large"?MODE.LARGE:MODE.SMALL;this.model.set("_mode",mode)},renderMode:function renderMode(){this.calculateMode();if(this.isLargeMode()){this.$el.addClass("mode-large").removeClass("mode-small")}else{this.$el.addClass("mode-small").removeClass("mode-large")}},isLargeMode:function isLargeMode(){return this.model.get("_mode")===MODE.LARGE},postRender:function postRender(){this.renderMode();this.setupNarrative();this.$(".narrative__slider").imageready(this.setReadyStatus.bind(this));if(Adapt.config.get("_disableAnimation")){this.$el.addClass("disable-animation")}},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},setupNarrative:function setupNarrative(){this.renderMode();var items=this.model.get("_children");if(!items||!items.length)return;var activeItem=this.model.getActiveItem();if(!activeItem){activeItem=this.model.getItem(0);activeItem.toggleActive(true)}else{items.trigger("change:_isActive",activeItem,true)}this.calculateWidths();if(!this.isLargeMode()&&!this.model.get("_wasHotgraphic")){this.replaceInstructions()}this.setupEventListeners();this._isInitial=false},calculateWidths:function calculateWidths(){var itemCount=this.model.get("_children").length;this.model.set({"_totalWidth":100*itemCount,"_itemWidth":100/itemCount})},resizeControl:function resizeControl(){var previousMode=this.model.get("_mode");this.renderMode();if(previousMode!==this.model.get("_mode"))this.replaceInstructions();this.evaluateNavigation();var activeItem=this.model.getActiveItem();if(activeItem)this.setStage(activeItem)},reRender:function reRender(){if(this.model.get("_wasHotgraphic")&&this.isLargeMode()){this.replaceWithHotgraphic()}else{this.resizeControl()}},closeNotify:function closeNotify(){this.evaluateCompletion()},replaceInstructions:function replaceInstructions(){if(this.isLargeMode()){this.$(".narrative__instruction-inner").html(this.model.get("instruction"))}else if(this.model.get("mobileInstruction")&&!this.model.get("_wasHotgraphic")){this.$(".narrative__instruction-inner").html(this.model.get("mobileInstruction"))}},replaceWithHotgraphic:function replaceWithHotgraphic(){if(!Adapt.componentStore.hotgraphic)throw"Hotgraphic not included in build";var HotgraphicView=Adapt.componentStore.hotgraphic.view;var model=this.prepareHotgraphicModel();var newHotgraphic=new HotgraphicView({model:model});var $container=$(".component__container",$("."+this.model.get("_parentId")));$container.append(newHotgraphic.$el);this.remove();$.a11y_update();_.defer(function(){Adapt.trigger("device:resize")})},prepareHotgraphicModel:function prepareHotgraphicModel(){var model=this.model;model.resetActiveItems();model.set({"_isPopupOpen":false,"_component":"hotgraphic","body":model.get("originalBody"),"instruction":model.get("originalInstruction")});return model},moveSliderToIndex:function moveSliderToIndex(itemIndex){var offset=this.model.get("_itemWidth")*itemIndex;if(Adapt.config.get("_defaultDirection")==="ltr"){offset*=-1}var cssValue="translateX("+offset+"%)";var $sliderElm=this.$(".narrative__slider");var $straplineHeaderElm=this.$(".narrative__strapline-header-inner");$sliderElm.css("transform",cssValue);$straplineHeaderElm.css("transform",cssValue);if(Adapt.config.get("_disableAnimation")||this._isInitial){this.onTransitionEnd()}else{$sliderElm.one("transitionend",this.onTransitionEnd.bind(this))}},onTransitionEnd:function onTransitionEnd(){if(this._isInitial)return;var index=this.model.getActiveItem().get("_index");if(this.isLargeMode()){this.$(".narrative__content-item[data-index=\""+index+"\"]").a11y_focus()}else{this.$(".narrative__strapline-btn").a11y_focus()}},setStage:function setStage(item){var index=item.get("_index");if(this.isLargeMode()){item.toggleVisited(true)}var $slideGraphics=this.$(".narrative__slider-image-container");this.$(".narrative__progress:visible").removeClass("is-selected").filter("[data-index=\""+index+"\"]").addClass("is-selected");$slideGraphics.children(".controls").a11y_cntrl_enabled(false);$slideGraphics.filter("[data-index=\""+index+"\"]").children(".controls").a11y_cntrl_enabled(true);this.$(".narrative__content-item").addClass("u-visibility-hidden u-display-none").a11y_on(false).filter("[data-index=\""+index+"\"]").removeClass("u-visibility-hidden u-display-none").a11y_on(true);this.$(".narrative__strapline-btn").a11y_cntrl_enabled(false).filter("[data-index=\""+index+"\"]").a11y_cntrl_enabled(true);this.evaluateNavigation();this.evaluateCompletion();this.moveSliderToIndex(index)},evaluateNavigation:function evaluateNavigation(){var active=this.model.getActiveItem();if(!active)return;var currentStage=active.get("_index");var itemCount=this.model.get("_children").length;var isAtStart=currentStage===0;var isAtEnd=currentStage===itemCount-1;this.$(".narrative__controls-left").toggleClass("u-visibility-hidden",isAtStart);this.$(".narrative__controls-right").toggleClass("u-visibility-hidden",isAtEnd)},evaluateCompletion:function evaluateCompletion(){if(this.model.areAllItemsCompleted()){this.trigger("allItems")}},openPopup:function openPopup(event){event&&event.preventDefault();var currentItem=this.model.getActiveItem();Adapt.trigger("notify:popup",{title:currentItem.get("title"),body:currentItem.get("body")});Adapt.on("popup:opened",function(){currentItem.toggleVisited(true)})},onNavigationClicked:function onNavigationClicked(event){var stage=this.model.getActiveItem().get("_index");if($(event.currentTarget).hasClass("narrative__controls-right")){this.model.setActiveItem(++stage)}else if($(event.currentTarget).hasClass("narrative__controls-left")){this.model.setActiveItem(--stage)}},onProgressClicked:function onProgressClicked(event){event&&event.preventDefault();var clickedIndex=$(event.target).data("index");this.model.setActiveItem(clickedIndex)},setupEventListeners:function setupEventListeners(){if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".component__widget")}}});return NarrativeView});define("components/adapt-contrib-narrative/js/adapt-contrib-narrative",["core/js/adapt","./narrativeView","core/js/models/itemsComponentModel"],function(Adapt,NarrativeView,ItemsComponentModel){return Adapt.register("narrative",{model:ItemsComponentModel,view:NarrativeView})});define("components/adapt-contrib-slider/js/sliderView",["core/js/adapt","core/js/views/questionView"],function(Adapt,QuestionView){var SliderView=QuestionView.extend({events:{"click .js-slider-number-click":"onNumberSelected","focus .js-slider-item-input":"onHandleFocus","blur .js-slider-item-input":"onHandleBlur"},resetQuestionOnRevisit:function resetQuestionOnRevisit(){this.setAllItemsEnabled();this.model.deselectAllItems();this.resetQuestion()},setupQuestion:function setupQuestion(){if(this.model.get("_isSubmitted"))return;this.selectItem(this.getIndexFromValue(this.model.get("_selectedItem").value),true)},setupRangeslider:function setupRangeslider(){this.$sliderScaleMarker=this.$(".js-slider-number-selection");this.$slider=this.$(".js-slider-item-input");if(this.model.has("_scaleStep")){this.$slider.attr({"step":this.model.get("_scaleStep")})}this.$slider.rangeslider({polyfill:false,onSlide:_.bind(this.handleSlide,this)});this.oldValue=0;if(this._deferEnable){this.setAllItemsEnabled()}},handleSlide:function handleSlide(position,value){if(this.oldValue===value){return}var itemIndex=this.getIndexFromValue(value);var pixels=this.mapIndexToPixels(itemIndex);this.selectItem(itemIndex,false);this.animateToPosition(pixels);this.oldValue=value},disableQuestion:function disableQuestion(){this.setAllItemsEnabled()},enableQuestion:function enableQuestion(){this.setAllItemsEnabled()},setAllItemsEnabled:function setAllItemsEnabled(){var isEnabled=this.model.get("_isEnabled");if(!this.$slider){this._deferEnable=true;return}if(!isEnabled){this.$(".slider__widget").addClass("is-disabled");this.$slider.prop("disabled",true).rangeslider("update",true);return}this.$(".slider__widget").removeClass("is-disabled");this.$slider.prop("disabled",false).rangeslider("update",true)},onQuestionRendered:function onQuestionRendered(){this.setupRangeslider();this.setScalePositions();this.onScreenSizeChanged();this.showScaleMarker(true);this.listenTo(Adapt,"device:resize",this.onScreenSizeChanged);this.setReadyStatus()},animateToPosition:function animateToPosition(newPosition){if(!this.$sliderScaleMarker)return;this.$sliderScaleMarker.velocity("stop").velocity({left:newPosition},{duration:200,easing:"linear",mobileHA:false})},getIndexFromValue:function getIndexFromValue(itemValue){var scaleStart=this.model.get("_scaleStart");var scaleEnd=this.model.get("_scaleEnd");return Math.round(this.mapValue(itemValue,scaleStart,scaleEnd,0,this.model.get("_items").length-1))},mapIndexToPixels:function mapIndexToPixels(value,$widthObject){var numberOfItems=this.model.get("_items").length;var width=$widthObject?$widthObject.width():this.$(".js-slider-scale").width();return Math.round(this.mapValue(value,0,numberOfItems-1,0,width))},mapPixelsToIndex:function mapPixelsToIndex(value){var numberOfItems=this.model.get("_items").length;var width=this.$(".slider-sliderange").width();return Math.round(this.mapValue(value,0,width,0,numberOfItems-1))},normalise:function normalise(value,low,high){var range=high-low;return(value-low)/range},mapValue:function mapValue(value,inputLow,inputHigh,outputLow,outputHigh){var normal=this.normalise(value,inputLow,inputHigh);return normal*(outputHigh-outputLow)+outputLow},onHandleFocus:function onHandleFocus(event){event.preventDefault();this.$slider.on("keydown",_.bind(this.onKeyDown,this))},onHandleBlur:function onHandleBlur(event){event.preventDefault();this.$slider.off("keydown")},onKeyDown:function onKeyDown(event){if(event.which===9)return;event.preventDefault();var newItemIndex=this.getIndexFromValue(this.model.get("_selectedItem").value);switch(event.which){case 40:case 37:newItemIndex=Math.max(newItemIndex-1,0);break;case 38:case 39:newItemIndex=Math.min(newItemIndex+1,this.model.get("_items").length-1);break;}this.selectItem(newItemIndex);if(typeof newItemIndex==="number")this.showScaleMarker(true);this.animateToPosition(this.mapIndexToPixels(newItemIndex));this.setSliderValue(this.getValueFromIndex(newItemIndex))},onNumberSelected:function onNumberSelected(event){event.preventDefault();if(this.model.get("_isInteractionComplete")){return}if(this.$slider.prop("disabled")){return}var itemValue=parseFloat($(event.currentTarget).attr("data-id"));var index=this.getIndexFromValue(itemValue);this.selectItem(index);this.animateToPosition(this.mapIndexToPixels(index));this.setSliderValue(itemValue)},getValueFromIndex:function getValueFromIndex(index){return this.model.get("_items")[index].value},resetControlStyles:function resetControlStyles(){this.$(".slider-handle").empty();this.showScaleMarker(false);this.$(".slider-bar").animate({width:"0px"});this.setSliderValue(this.model.get("_items")[0].value)},onCannotSubmit:function onCannotSubmit(){},setSliderValue:function setSliderValue(value){if(this.$slider){this.$slider.val(value).change()}},showMarking:function showMarking(){if(!this.model.get("_canShowMarking"))return;this.$(".slider__widget").removeClass("is-correct is-incorrect").addClass(this.model.get("_selectedItem").correct?"is-correct":"is-incorrect")},resetQuestion:function resetQuestion(){this.selectItem(0,true);this.animateToPosition(0);this.resetControlStyles();this.showScaleMarker(true)},setScalePositions:function setScalePositions(){var numberOfItems=this.model.get("_items").length;_.each(this.model.get("_items"),function(item,index){var normalisedPosition=this.normalise(index,0,numberOfItems-1);this.$(".js-slider-number").eq(index).data("normalisedPosition",normalisedPosition)},this)},showScale:function showScale(){var $markers=this.$(".js-slider-scale-notch-container").empty();if(this.model.get("_showScale")===false){$markers.eq(0).css({display:"none"});this.$(".js-slider-number").css(this.model.get("_showScaleIndicator")?{visibility:"hidden"}:{display:"none"});return}var $scaler=this.$(".js-slider-scale");for(var i=1,count=this.model.get("_items").length-1;i<count;i++){$markers.append("<div class='slider__scale-notch' style='left: "+this.mapIndexToPixels(i,$scaler)+"px'>")}this.showScaleNumbers()},showScaleNumbers:function showScaleNumbers(){var $scaler=this.$(".js-slider-scale");var $numbers=this.$(".js-slider-number");if(this.model.get("_showScaleNumbers")===false){$numbers.css("display","none");return}var scaleWidth=$scaler.width();this.model.get("_items").forEach(function(item,index){var $number=$numbers.eq(index);var newLeft=Math.round($number.data("normalisedPosition")*scaleWidth);$number.css({left:newLeft})})},showLabels:function showLabels(){if(!this.model.get("labelStart")&&!this.model.get("labelEnd")){this.$(".js-slider-label-container").eq(0).css({display:"none"})}},remapSliderBar:function remapSliderBar(){var $scaler=this.$(".js-slider-scale");var currentIndex=this.getIndexFromValue(this.model.get("_selectedItem").value);var left=this.mapIndexToPixels(currentIndex,$scaler);this.$(".slider-handle").css({left:left+"px"});this.$(".js-slider-number-selection").css({left:left+"px"});this.$(".slider-bar").width(left)},onScreenSizeChanged:function onScreenSizeChanged(){this.showScale();this.showLabels();this.remapSliderBar();if(this.$(".slider__widget").hasClass("show-user-answer")){this.hideCorrectAnswer()}else if(this.$(".slider__widget").hasClass("show-correct-answer")){this.showCorrectAnswer()}},showCorrectAnswer:function showCorrectAnswer(){var answers=[];if(this.model.has("_correctAnswer")){var correctAnswer=this.model.get("_correctAnswer")}if(this.model.has("_correctRange")){var bottom=this.model.get("_correctRange")._bottom;var top=this.model.get("_correctRange")._top;var step=this.model.has("_scaleStep")?this.model.get("_scaleStep"):1}this.showScaleMarker(false);if(correctAnswer){answers.push(correctAnswer)}else if(bottom!==undefined&&top!==undefined){var answer=this.model.get("_correctRange")._bottom;var topOfRange=this.model.get("_correctRange")._top;while(answer<=topOfRange){answers.push(answer);answer+=step}}else{console.log("adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON")}var middleAnswer=answers[Math.floor(answers.length/2)];this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(middleAnswer)));this.showModelAnswers(answers);this.setSliderValue(middleAnswer)},showModelAnswers:function showModelAnswers(correctAnswerArray){var $parentDiv=this.$(".js-slider-model-range");_.each(correctAnswerArray,function(correctAnswer,index){$parentDiv.append($("<div class='slider__number-model-answer'>"));var $element=$(this.$(".js-slider-model-range .slider__number-model-answer")[index]);var startingLeft=this.mapIndexToPixels(this.getIndexFromValue(this.model.get("_selectedItem").value));if(this.model.get("_showNumber"))$element.html(correctAnswer);$element.css({left:startingLeft}).fadeIn(0,_.bind(function(){$element.animate({left:this.mapIndexToPixels(this.getIndexFromValue(correctAnswer))})},this))},this)},hideCorrectAnswer:function hideCorrectAnswer(){var userAnswerIndex=this.getIndexFromValue(this.model.get("_userAnswer"));this.$(".js-slider-model-range").empty();this.showScaleMarker(true);this.selectItem(userAnswerIndex,true);this.animateToPosition(this.mapIndexToPixels(userAnswerIndex));this.setSliderValue(this.model.get("_userAnswer"))},selectItem:function selectItem(itemIndex,noFocus){_.each(this.model.get("_items"),function(item,index){item.selected=index===itemIndex;if(item.selected){this.model.set("_selectedItem",item);this.$(".js-slider-item-input").attr({"value":item.value,"aria-valuenow":item.value})}},this);this.showNumber(true)},showScaleMarker:function showScaleMarker(show){var $scaleMarker=this.$(".js-slider-number-selection");if(this.model.get("_showScaleIndicator")){this.showNumber(show);if(show){$scaleMarker.addClass("display-block")}else{$scaleMarker.removeClass("display-block")}}},showNumber:function showNumber(show){var $scaleMarker=this.$(".js-slider-number-selection");if(this.model.get("_showNumber")){if(show){$scaleMarker.html(this.model.get("_selectedItem").value)}else{$scaleMarker.html=""}}}});return SliderView});define("components/adapt-contrib-slider/js/sliderModel",["core/js/adapt","core/js/models/questionModel"],function(Adapt,QuestionModel){var SliderModel=QuestionModel.extend({init:function init(){QuestionModel.prototype.init.call(this);this.setupModelItems();this.set("_selectedItem",this.get("_items")[0])},getDecimalPlaces:function getDecimalPlaces(num){return(num.toString().split(".")[1]||[]).length},setupModelItems:function setupModelItems(){var items=[];var answer=this.get("_correctAnswer");var range=this.get("_correctRange");var start=this.get("_scaleStart");var end=this.get("_scaleEnd");var step=this.get("_scaleStep")||1;var dp=this.getDecimalPlaces(step);for(var i=start;i<=end;i+=step){if(dp!==0){i=parseFloat(i.toFixed(dp))}items.push({value:i,selected:false,correct:answer?i===Number(answer):i>=range._bottom&&i<=range._top})}this.set({"_items":items,"_marginDir":Adapt.config.get("_defaultDirection")==="rtl"?"right":"left"})},canSubmit:function canSubmit(){return true},restoreUserAnswers:function restoreUserAnswers(){if(!this.get("_isSubmitted")){this.set({_selectedItem:{},_userAnswer:undefined});return}var items=this.get("_items");var userAnswer=this.get("_userAnswer");for(var i=0,l=items.length;i<l;i++){var item=items[i];if(item.value===userAnswer){item.selected=true;this.set("_selectedItem",item);break}}this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},storeUserAnswer:function storeUserAnswer(){this.set("_userAnswer",this.get("_selectedItem").value)},resetUserAnswer:function resetUserAnswer(){this.set({_isAtLeastOneCorrectSelection:false,_selectedItem:{},_userAnswer:undefined})},deselectAllItems:function deselectAllItems(){_.each(this.get("_items"),function(item){item.selected=false},this)},isCorrect:function isCorrect(){var numberOfCorrectAnswers=0;_.each(this.get("_items"),function(item,index){if(item.selected&&item.correct){this.set("_isAtLeastOneCorrectSelection",true);numberOfCorrectAnswers++}},this);this.set("_numberOfCorrectAnswers",numberOfCorrectAnswers);return this.get("_isAtLeastOneCorrectSelection")?true:false},isPartlyCorrect:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")},setScore:function setScore(){var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var questionWeight=this.get("_questionWeight");var score=questionWeight*numberOfCorrectAnswers;this.set("_score",score)},getResponse:function getResponse(){return this.get("_userAnswer").toString()},getResponseType:function getResponseType(){return"numeric"}});return SliderModel});define("components/adapt-contrib-slider/js/adapt-contrib-slider",["core/js/adapt","./sliderView","./sliderModel","libraries/rangeslider"],function(Adapt,SliderView,SliderModel){return Adapt.register("slider",{view:SliderView,model:SliderModel})});define("components/adapt-contrib-text/js/adapt-contrib-text",["core/js/adapt","core/js/views/componentView","core/js/models/componentModel"],function(Adapt,ComponentView,ComponentModel){var TextView=ComponentView.extend({preRender:function preRender(){this.checkIfResetOnRevisit()},postRender:function postRender(){this.setReadyStatus();this.setupInview()},setupInview:function setupInview(){var selector=this.getInviewElementSelector();if(!selector){this.setCompletionStatus();return}this.setupInviewCompletion(selector)},getInviewElementSelector:function getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{template:"text"});return Adapt.register("text",{model:ComponentModel.extend({}),view:TextView})});define("components/adapt-contrib-textInput/js/textInputView",["core/js/views/questionView"],function(QuestionView){var TextInputView=QuestionView.extend({events:{"focus .js-textinput-textbox":"clearValidationError","change .js-textinput-textbox":"onInputChanged"},resetQuestionOnRevisit:function resetQuestionOnRevisit(){this.setAllItemsEnabled(false);this.resetQuestion()},setupQuestion:function setupQuestion(){this.model.setupRandomisation()},disableQuestion:function disableQuestion(){this.setAllItemsEnabled(false)},enableQuestion:function enableQuestion(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function setAllItemsEnabled(isEnabled){this.model.get("_items").forEach(function(item,index){var $itemInput=this.$(".js-textinput-textbox").eq(index);$itemInput.prop("disabled",!isEnabled)},this)},onQuestionRendered:function onQuestionRendered(){this.setReadyStatus()},clearValidationError:function clearValidationError(){this.$(".js-textinput-textbox").removeClass("has-error")},onCannotSubmit:function onCannotSubmit(){this.showValidationError()},showValidationError:function showValidationError(){this.$(".js-textinput-textbox").addClass("has-error")},showMarking:function showMarking(){if(!this.model.get("_canShowMarking"))return;this.model.get("_items").forEach(function(item,i){var $item=this.$(".js-textinput-item").eq(i);$item.removeClass("is-correct is-incorrect").addClass(item._isCorrect?"is-correct":"is-incorrect")},this)},resetQuestion:function resetQuestion(){this.$(".js-textinput-textbox").prop("disabled",!this.model.get("_isEnabled")).val("");this.model.set({_isAtLeastOneCorrectSelection:false,_isCorrect:undefined})},showCorrectAnswer:function showCorrectAnswer(){if(this.model.get("_answers")){var correctAnswers=this.model.get("_answers");this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(correctAnswers[index][0])},this)}else{this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(item._answers[0])},this)}},hideCorrectAnswer:function hideCorrectAnswer(){this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(item.userAnswer)},this)},onInputChanged:function onInputChanged(e){var $input=$(e.target);this.model.setItemUserAnswer($input.parents(".js-textinput-item").index(),$input.val())}});return TextInputView});define("components/adapt-contrib-textInput/js/textInputModel",["core/js/models/questionModel"],function(QuestionModel){var TextInputModel=QuestionModel.extend({init:function init(){QuestionModel.prototype.init.call(this);this.set("_genericAnswerIndexOffset",TextInputModel.genericAnswerIndexOffset);this.setupQuestionItemIndexes()},setupQuestionItemIndexes:function setupQuestionItemIndexes(){this.get("_items").forEach(function(item,index){if(item._index===undefined)item._index=index;if(item._answerIndex===undefined)item._answerIndex=-1})},restoreUserAnswers:function restoreUserAnswers(){if(!this.get("_isSubmitted"))return;var userAnswer=this.get("_userAnswer");var genericAnswers=this.get("_answers");this.get("_items").forEach(function(item){var answerIndex=userAnswer[item._index];if(answerIndex>=TextInputModel.genericAnswerIndexOffset){item.userAnswer=genericAnswers[answerIndex-TextInputModel.genericAnswerIndexOffset];item._answerIndex=answerIndex}else if(answerIndex>-1){item.userAnswer=item._answers[answerIndex];item._answerIndex=answerIndex}else{if(item.userAnswer===undefined)item.userAnswer="******";item._answerIndex=-1}if(item.userAnswer instanceof Array)item.userAnswer=item.userAnswer[0]});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},setupRandomisation:function setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;this.set("_items",_.shuffle(this.get("_items")))},canSubmit:function canSubmit(){var canSubmit=_.every(this.get("_items"),function(item){return item.userAnswer!==""});return canSubmit},setItemUserAnswer:function setItemUserAnswer(itemIndex,userAnswer){var item=this.get("_items")[itemIndex];item.userAnswer=userAnswer},storeUserAnswer:function storeUserAnswer(){var items=this.get("_items");this.isCorrect();var userAnswer=new Array(items.length);items.forEach(function(item,index){userAnswer[item._index]=item._answerIndex});this.set("_userAnswer",userAnswer)},isCorrect:function isCorrect(){if(this.get("_answers")){this.markGenericAnswers()}else{this.markSpecificAnswers()}return!_.contains(_.pluck(this.get("_items"),"_isCorrect"),false)},isPartlyCorrect:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")},markGenericAnswers:function markGenericAnswers(){var numberOfCorrectAnswers=0;var correctAnswers=this.get("_answers").slice();var usedAnswerIndexes=[];this.get("_items").forEach(function(item){correctAnswers.forEach(function(answerGroup,answerIndex){if(_.indexOf(usedAnswerIndexes,answerIndex)>-1)return;if(this.checkAnswerIsCorrect(answerGroup,item.userAnswer)==false)return;usedAnswerIndexes.push(answerIndex);item._isCorrect=true;item._answerIndex=answerIndex+TextInputModel.genericAnswerIndexOffset;this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})},this);if(!item._isCorrect)item._isCorrect=false},this)},markSpecificAnswers:function markSpecificAnswers(){var numberOfCorrectAnswers=0;this.get("_items").forEach(function(item){if(!item._answers)return;var userAnswer=item.userAnswer||"";if(this.checkAnswerIsCorrect(item._answers,userAnswer)){item._isCorrect=true;item._answerIndex=_.indexOf(item._answers,this.cleanupUserAnswer(userAnswer));this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})}else{item._isCorrect=false;item._answerIndex=-1}},this)},checkAnswerIsCorrect:function checkAnswerIsCorrect(possibleAnswers,userAnswer){var uAnswer=this.cleanupUserAnswer(userAnswer);var matched=possibleAnswers.filter(function(cAnswer){return this.cleanupUserAnswer(cAnswer)==uAnswer},this);var answerIsCorrect=matched&&matched.length>0;if(answerIsCorrect)this.set("_hasAtLeastOneCorrectSelection",true);return answerIsCorrect},cleanupUserAnswer:function cleanupUserAnswer(userAnswer){if(this.get("_allowsAnyCase")){userAnswer=userAnswer.toLowerCase()}if(this.get("_allowsPunctuation")){userAnswer=userAnswer.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");userAnswer=userAnswer.replace(/(  +)+/g," ")}return $.trim(userAnswer)},setScore:function setScore(){var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var questionWeight=this.get("_questionWeight");var itemLength=this.get("_items").length;var score=questionWeight*numberOfCorrectAnswers/itemLength;this.set("_score",score)},resetUserAnswer:function resetUserAnswer(){this.get("_items").forEach(function(item){item._isCorrect=false;item.userAnswer=""})},getResponse:function getResponse(){return _.pluck(this.get("_items"),"userAnswer").join("[,]")},getResponseType:function getResponseType(){return"fill-in"}},{genericAnswerIndexOffset:65536});return TextInputModel});define("components/adapt-contrib-textInput/js/adapt-contrib-textInput",["core/js/adapt","./textInputView","./textInputModel"],function(Adapt,TextInputView,TextInputModel){return Adapt.register("textinput",{view:TextInputView,model:TextInputModel})});define("components/adapt-expose/js/adapt-expose",["require","coreViews/componentView","coreJS/adapt"],function(require){function toHyphenCase(str){if(!str)return false;return str.replace(/([A-Z])/g,"-$1").toLowerCase()}var ComponentView=require("coreViews/componentView");var Adapt=require("coreJS/adapt");var Expose=ComponentView.extend({events:{"click .expose-item-cover":"toggleItem","click .expose-item-content":"toggleItem","click .expose-item-button":"toggleItem"},onDeviceResize:function onDeviceResize(){this.setupColumns();this.setEqualHeights()},preRender:function preRender(){this.animationType=toHyphenCase(this.model.get("_animationType"))||"fade"},postRender:function postRender(){this.$(".expose-item").children().addClass(this.animationType);this.setupColumns();this.setupEventListeners();this.$(".expose-item-img").imageready(_.bind(this.onImageReady,this))},onImageReady:function onImageReady(){this.setEqualHeights();this.setReadyStatus()},setupColumns:function setupColumns(){if(this.model.get("_columns")&&$(window).width()>760){var w=100/this.model.get("_columns")+"%";this.$(".expose-items").addClass("expose-columns");this.$(".expose-item").width(w).addClass("expose-column")}else{this.$(".expose-items").removeClass("expose-columns");this.$(".expose-item").width("auto").removeClass("expose-column")}},setEqualHeights:function setEqualHeights(){if(this.model.get("_equalHeights")===false)return;var $contentElements=this.$(".expose-item-content");$contentElements.height("auto");var hMax=0;_.each($contentElements,function(el){var h=$(el).outerHeight();if(h>hMax)hMax=h});$contentElements.height(hMax)},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"device:resize":this.onDeviceResize})},toggleItem:function toggleItem(e){if(e.target.tagName==="A")return;var $parent=$(e.currentTarget).parent();var $cover=$parent.children(".expose-item-cover");$cover.toggleClass(this.animationType);if(!$cover.is(".visited")){$cover.addClass("visited");var i=$cover.parents(".expose-item").index();this.model.get("_items")[i]._isVisited=true;this.evaluateCompletion()}},evaluateCompletion:function evaluateCompletion(){var incompleteItems=_.filter(this.model.get("_items"),function(item){return!item._isVisited});!incompleteItems.length&&this.onComplete()},onComplete:function onComplete(){this.setCompletionStatus()}});Adapt.register("expose",Expose);return Expose});define("components/adapt-narrativeCode/js/modeEnum",[],function(){return new ENUM(["SMALL","LARGE"])});define("components/adapt-narrativeCode/js/narrativeCodeView",["core/js/adapt","core/js/views/componentView","./modeEnum","core/libraries/prism"],function(Adapt,ComponentView,MODE,Prism){'use strict';var NarrativeCodeView=ComponentView.extend({_isInitial:true,events:{"click .narrativeCode-strapline-title":"openPopup","click .narrativeCode-controls":"onNavigationClicked","click .narrativeCode-indicators .narrativeCode-progress":"onProgressClicked"},preRender:function preRender(){this.listenTo(Adapt,{"device:changed device:resize":this.reRender,"notify:closed":this.closeNotify});this.renderMode();this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange});this.checkIfResetOnRevisit();this.calculateWidths()},onItemsActiveChange:function onItemsActiveChange(item,_isActive){if(_isActive===true){this.setStage(item)}},onItemsVisitedChange:function onItemsVisitedChange(item,isVisited){if(!isVisited)return;this.$("[data-index=\""+item.get("_index")+"\"]").addClass("visited")},calculateMode:function calculateMode(){var mode=Adapt.device.screenSize==="large"?MODE.LARGE:MODE.SMALL;this.model.set("_mode",mode)},renderMode:function renderMode(){this.calculateMode();if(this.isLargeMode()){this.$el.addClass("mode-large").removeClass("mode-small")}else{this.$el.addClass("mode-small").removeClass("mode-large")}},isLargeMode:function isLargeMode(){return this.model.get("_mode")===MODE.LARGE},postRender:function postRender(){this.renderMode();this.$(".narrativeCode-slider").imageready(this.setReadyStatus.bind(this));this.setupNarrativeCode();Prism.highlightAll();if(Adapt.config.get("_disableAnimation")){this.$el.addClass("disable-animation")}},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},setupNarrativeCode:function setupNarrativeCode(){this.renderMode();var items=this.model.get("_children");if(!items||!items.length)return;var activeItem=this.model.getActiveItem();if(!activeItem){activeItem=this.model.getItem(0);activeItem.toggleActive(true)}else{items.trigger("change:_isActive",activeItem,true)}this.calculateWidths();if(!this.isLargeMode()&&!this.model.get("_wasHotgraphic")){this.replaceInstructions()}this.setupEventListeners();this._isInitial=false},calculateWidths:function calculateWidths(){var itemCount=this.model.get("_children").length;this.model.set({"_totalWidth":100*itemCount,"_itemWidth":100/itemCount})},resizeControl:function resizeControl(){var previousMode=this.model.get("_mode");this.renderMode();if(previousMode!==this.model.get("_mode"))this.replaceInstructions();this.evaluateNavigation();var activeItem=this.model.getActiveItem();if(activeItem)this.setStage(activeItem)},reRender:function reRender(){if(this.model.get("_wasHotgraphic")&&this.isLargeMode()){this.replaceWithHotgraphic()}else{this.resizeControl()}},closeNotify:function closeNotify(){this.evaluateCompletion()},replaceInstructions:function replaceInstructions(){if(this.isLargeMode()){this.$(".narrativeCode-instruction-inner").html(this.model.get("instruction"))}else if(this.model.get("mobileInstruction")&&!this.model.get("_wasHotgraphic")){this.$(".narrativeCode-instruction-inner").html(this.model.get("mobileInstruction"))}},replaceWithHotgraphic:function replaceWithHotgraphic(){if(!Adapt.componentStore.hotgraphic)throw"Hotgraphic not included in build";var HotgraphicView=Adapt.componentStore.hotgraphic.view;var model=this.prepareHotgraphicModel();var newHotgraphic=new HotgraphicView({model:model});var $container=$(".component-container",$("."+this.model.get("_parentId")));$container.append(newHotgraphic.$el);this.remove();$.a11y_update();_.defer(function(){Adapt.trigger("device:resize")})},prepareHotgraphicModel:function prepareHotgraphicModel(){var model=this.model;model.resetActiveItems();model.set({"_isPopupOpen":false,"_component":"hotgraphic","body":model.get("originalBody"),"instruction":model.get("originalInstruction")});return model},moveSliderToIndex:function moveSliderToIndex(itemIndex,shouldAnimate){var offset=this.model.get("_itemWidth")*itemIndex;if(Adapt.config.get("_defaultDirection")==="ltr"){offset*=-1}var cssValue="translateX("+offset+"%)";var $sliderElm=this.$(".narrativeCode-slider");var $straplineHeaderElm=this.$(".narrativeCode-strapline-header-inner");$sliderElm.css("transform",cssValue);$straplineHeaderElm.css("transform",cssValue);if(Adapt.config.get("_disableAnimation")||this._isInitial){this.onTransitionEnd()}else{$sliderElm.one("transitionend",this.onTransitionEnd.bind(this))}},onTransitionEnd:function onTransitionEnd(){if(this._isInitial)return;var index=this.model.getActiveItem().get("_index");if(this.isLargeMode()){this.$(".narrativeCode-content-item[data-index=\""+index+"\"]").a11y_focus()}else{this.$(".narrativeCode-strapline-title").a11y_focus()}},setStage:function setStage(item){var index=item.get("_index");if(this.isLargeMode()){item.toggleVisited(true)}var $slideGraphics=this.$(".narrativeCode-slider-graphic");this.$(".narrativeCode-progress:visible").removeClass("selected").filter("[data-index=\""+index+"\"]").addClass("selected");$slideGraphics.children(".controls").a11y_cntrl_enabled(false);$slideGraphics.filter("[data-index=\""+index+"\"]").children(".controls").a11y_cntrl_enabled(true);this.$(".narrativeCode-content-item").addClass("narrativeCode-hidden").a11y_on(false).filter("[data-index=\""+index+"\"]").removeClass("narrativeCode-hidden").a11y_on(true);this.$(".narrativeCode-strapline-title").a11y_cntrl_enabled(false).filter("[data-index=\""+index+"\"]").a11y_cntrl_enabled(true);this.evaluateNavigation();this.evaluateCompletion();this.moveSliderToIndex(index,!this._isInitial)},evaluateNavigation:function evaluateNavigation(){var active=this.model.getActiveItem();if(!active)return;var currentStage=active.get("_index");var itemCount=this.model.get("_children").length;var isAtStart=currentStage===0;var isAtEnd=currentStage===itemCount-1;this.$(".narrativeCode-control-left").toggleClass("narrativeCode-hidden",isAtStart);this.$(".narrativeCode-control-right").toggleClass("narrativeCode-hidden",isAtEnd)},evaluateCompletion:function evaluateCompletion(){if(this.model.areAllItemsCompleted()){this.trigger("allItems")}},openPopup:function openPopup(event){event&&event.preventDefault();var currentItem=this.model.getActiveItem();Adapt.trigger("notify:popup",{title:currentItem.get("title"),body:currentItem.get("body")});Adapt.on("popup:opened",function(){currentItem.toggleVisited(true)})},onNavigationClicked:function onNavigationClicked(event){var stage=this.model.getActiveItem().get("_index");if($(event.currentTarget).hasClass("narrativeCode-control-right")){this.model.setActiveItem(++stage)}else if($(event.currentTarget).hasClass("narrativeCode-control-left")){this.model.setActiveItem(--stage)}},onProgressClicked:function onProgressClicked(event){event&&event.preventDefault();var clickedIndex=$(event.target).data("index");this.model.setActiveItem(clickedIndex)},inview:function inview(event,visible,visiblePartX,visiblePartY){if(!visible)return;if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}var wasAllInview=this._isVisibleTop&&this._isVisibleBottom;if(!wasAllInview)return;this.$(".component-inner").off("inview");this.setCompletionStatus()},setupEventListeners:function setupEventListeners(){if(this.model.get("_setCompletionOn")==="inview"){this.$(".component-widget").on("inview",this.inview.bind(this))}},remove:function remove(){if(this.model.get("_setCompletionOn")==="inview"){this.$(".component-widget").off("inview")}ComponentView.prototype.remove.apply(this,arguments)}});return NarrativeCodeView});define("components/adapt-narrativeCode/js/adapt-narrativeCode",["core/js/adapt","./narrativeCodeView","core/js/models/itemsComponentModel"],function(Adapt,NarrativeCodeView,ItemsComponentModel){return Adapt.register("narrativeCode",{model:ItemsComponentModel,view:NarrativeCodeView})});define("components/adapt-textWithCode/js/adapt-textWithCode",["core/js/adapt","core/js/views/componentView","core/libraries/prism"],function(Adapt,ComponentView){var TextWithCode=ComponentView.extend({preRender:function preRender(){this.checkIfResetOnRevisit()},postRender:function postRender(){this.setReadyStatus();this.setupInview();Prism.highlightAll()},setupInview:function setupInview(){var selector=this.getInviewElementSelector();if(!selector){this.setCompletionStatus()}else{this.model.set("inviewElementSelector",selector);this.$(selector).on("inview",_.bind(this.inview,this))}},getInviewElementSelector:function getInviewElementSelector(){if(this.model.get("body"))return".component-body";if(this.model.get("instruction"))return".component-instruction";if(this.model.get("displayTitle"))return".component-title";return null},checkIfResetOnRevisit:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},inview:function inview(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(this.model.get("inviewElementSelector")).off("inview");this.setCompletionStatus()}};},remove:function remove(){if(this.model.has("inviewElementSelector")){this.$(this.model.get("inviewElementSelector")).off("inview")}ComponentView.prototype.remove.call(this)}},{template:"textWithCode"});Adapt.register("textWithCode",TextWithCode);return TextWithCode});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView",["core/js/adapt","core/js/views/articleView"],function(Adapt,AdaptArticleView){var AssessmentView={postRender:function postRender(){AdaptArticleView.prototype.postRender.call(this);if(this.model.isAssessmentEnabled()){this._setupEventListeners();var config=this.model.getConfig();if(config&&config._questions&&config._questions._canShowMarking===false){this.$el.addClass("has-no-marking")}}this.$el.addClass("is-assessment")},_setupEventListeners:function _setupEventListeners(){this.listenTo(Adapt,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset,remove:this._onRemove})},_removeEventListeners:function _removeEventListeners(){this.stopListening(Adapt,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset})},_onAssessmentComplete:function _onAssessmentComplete(state,model){if(state.id!=this.model.get("_assessment")._id)return;console.log("assessment complete",state,model)},_onAssessmentReset:function _onAssessmentReset(state,model){if(state.id!=this.model.get("_assessment")._id)return;console.log("assessment reset",state,model)},_onRemove:function _onRemove(){this._removeEventListeners()}};return AssessmentView});define("extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank",["require"],function(require){var QuestionBank=function QuestionBank(quizBankid,articleId,numQuestionBlocks,uniqueQuestions){this._id=quizBankid;this._articleId=articleId;this._numQuestionBlocks=numQuestionBlocks;this._uniqueQuestions=uniqueQuestions;this.questionBlocks=[];this.unUsedQuestionBlocks=undefined;this.usedQuestionBlocks=[]};QuestionBank.prototype={getID:function getID(){return this._id},addBlock:function addBlock(block){this.questionBlocks.push(block)},getRandomQuestionBlocks:function getRandomQuestionBlocks(){this.checkResetUnunsedBlocks();var questionBlocks=[];var usedQuestionBlocks=this.usedQuestionBlocks.slice(0);for(var i=0;i<this._numQuestionBlocks;i++){var question=this.getRandomQuestion();if(question!==undefined){questionBlocks.push(question)}else{if(usedQuestionBlocks.length===0)break;var index=Math.floor(Math.random()*(usedQuestionBlocks.length-1));question=usedQuestionBlocks.splice(index,1)[0];questionBlocks.push(question)}}return questionBlocks},checkResetUnunsedBlocks:function checkResetUnunsedBlocks(){if(this.unUsedQuestionBlocks!==undefined&&this._uniqueQuestions)return;this.unUsedQuestionBlocks=this.questionBlocks.slice(0)},getRandomQuestion:function getRandomQuestion(){if(this.unUsedQuestionBlocks!==undefined&&this.unUsedQuestionBlocks.length<1){console.warn("assessment:"+this._articleId+" No more unique questions for _assessment._quizBankID "+this._id);return undefined}var index=Math.round(Math.random()*(this.unUsedQuestionBlocks.length-1));var questionBlock=this.unUsedQuestionBlocks[index];this.usedQuestionBlocks.push(questionBlock);this.unUsedQuestionBlocks.splice(index,1);return questionBlock}};return QuestionBank});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel",["core/js/adapt","./adapt-assessmentQuestionBank"],function(Adapt,QuestionBank){var givenIdCount=0;var assessmentConfigDefaults={_isEnabled:true,_questions:{_resetType:"soft",_canShowFeedback:false,_canShowMarking:false,_canShowModelAnswer:false},_suppressMarking:false,_isPercentageBased:true,_scoreToPass:100,_includeInTotalScore:true,_assessmentWeight:1,_isResetOnRevisit:true,_reloadPageOnReset:true,_attempts:"infinite",_allowResetIfPassed:false};var AssessmentModel={_postInitialize:function _postInitialize(){if(!this.isAssessmentEnabled())return;var assessmentConfig=this.getConfig();_.extend(this,{_currentQuestionComponents:null,_originalChildModels:null,_questionBanks:null,_forceResetOnRevisit:false});var attemptsLeft;switch(assessmentConfig._attempts){case"infinite":case 0:case undefined:case-1:case null:attemptsLeft="infinite";break;default:attemptsLeft=assessmentConfig._attempts;break;}this.set({_currentQuestionComponentIds:[],_assessmentCompleteInSession:false,_attemptInProgress:false,_isAssessmentComplete:false,_numberOfQuestionsAnswered:0,_lastAttemptScoreAsPercent:0,_attempts:attemptsLeft,_attemptsLeft:attemptsLeft,_attemptsSpent:0});this.listenToOnce(Adapt,"app:dataReady",this._onDataReady);this.listenTo(Adapt,"remove",this._onRemove)},init:function init(){this._originalChildModels=this.getChildren().models;this._currentQuestionComponents=this.findDescendantModels("components",{where:{_isQuestionType:true}});this.set("_currentQuestionComponentIds",this._currentQuestionComponents.map(function(comp){return comp.get("_id")}));this._setAssessmentOwnershipOnChildrenModels()},_setAssessmentOwnershipOnChildrenModels:function _setAssessmentOwnershipOnChildrenModels(){var assessmentConfig=this.get("_assessment");var childConfig={_isPartOfAssessment:true,_assessmentId:assessmentConfig._id};for(var i=0,l=this._originalChildModels.length;i<l;i++){var blockModel=this._originalChildModels[i];blockModel.set(childConfig);blockModel.setOnChildren(childConfig)}},_onDataReady:function _onDataReady(){Adapt.assessment.register(this)},_setupAssessmentData:function _setupAssessmentData(force,callback){var assessmentConfig=this.getConfig();var state=this.getState();var shouldResetAssessment=!this.get("_attemptInProgress")&&!state.isPass||force===true;var shouldResetQuestions=assessmentConfig._isResetOnRevisit&&(state.allowResetIfPassed||!state.isPass)||force===true;if(shouldResetAssessment||shouldResetQuestions){Adapt.trigger("assessments:preReset",this.getState(),this)}var quizModels;if(shouldResetAssessment){this.set({_numberOfQuestionsAnswered:0,_isAssessmentComplete:false,_assessmentCompleteInSession:false,_score:0});this.getChildren().models=this._originalChildModels;if(assessmentConfig._banks&&assessmentConfig._banks._isEnabled&&assessmentConfig._banks._split.length>1){quizModels=this._setupBankedAssessment()}else if(assessmentConfig._randomisation&&assessmentConfig._randomisation._isEnabled){quizModels=this._setupRandomisedAssessment()}}if(!quizModels){quizModels=this.getChildren().models}else if(quizModels.length===0){quizModels=this.getChildren().models;console.warn("assessment: Not enough unique questions to create a fresh assessment, using last selection")}this.getChildren().models=quizModels;this._currentQuestionComponents=this.findDescendantModels("components",{where:{_isQuestionType:true}});this.set("_currentQuestionComponentIds",this._currentQuestionComponents.map(function(comp){return comp.get("_id")}));if(shouldResetAssessment||shouldResetQuestions){this._resetQuestions(function(){this.set("_attemptInProgress",true);Adapt.trigger("assessments:reset",this.getState(),this);finalise.apply(this)}.bind(this))}else{finalise.apply(this)}function finalise(){if(!state.isComplete){this.set("_attemptInProgress",true)}this._overrideQuestionComponentSettings();this._setupQuestionListeners();this._checkNumberOfQuestionsAnswered();this._updateQuestionsState();Adapt.assessment.saveState();if(typeof callback=="function")callback.apply(this);if(shouldResetAssessment||shouldResetQuestions){Adapt.trigger("assessments:postReset",this.getState(),this)}}},_setupBankedAssessment:function _setupBankedAssessment(){var assessmentConfig=this.getConfig();this._setupBanks();var questionModels=[];for(var bankId in this._questionBanks){if(this._questionBanks.hasOwnProperty(bankId)){var questionBank=this._questionBanks[bankId];var questions=questionBank.getRandomQuestionBlocks();questionModels=questionModels.concat(questions)}}if(assessmentConfig._banks._randomisation){questionModels=_.shuffle(questionModels)}return questionModels},_setupBanks:function _setupBanks(){var assessmentConfig=this.getConfig();var banks=assessmentConfig._banks._split.split(",");var bankId;this._questionBanks=[];for(var i=0,l=banks.length;i<l;i++){var bank=banks[i];bankId=i+1;var questionBank=new QuestionBank(bankId,this.get("_id"),bank,true);this._questionBanks[bankId]=questionBank}var children=this.getChildren().models;for(var j=0,count=children.length;j<count;j++){var blockModel=children[j];var blockAssessmentConfig=blockModel.get("_assessment");bankId=blockAssessmentConfig._quizBankID;this._questionBanks[bankId].addBlock(blockModel)}},_setupRandomisedAssessment:function _setupRandomisedAssessment(){var assessmentConfig=this.getConfig();var randomisationModel=assessmentConfig._randomisation;var blockModels=this.getChildren().models;var questionModels=_.shuffle(blockModels);if(randomisationModel._blockCount>0){questionModels=questionModels.slice(0,randomisationModel._blockCount)}return questionModels},_overrideQuestionComponentSettings:function _overrideQuestionComponentSettings(){var newSettings=this._getMarkingSettings();var questionConfig=this.getConfig()._questions;if(questionConfig.hasOwnProperty("_canShowFeedback")){newSettings._canShowFeedback=questionConfig._canShowFeedback}if(!_.isEmpty(newSettings)){for(var i=0,l=this._currentQuestionComponents.length;i<l;i++){this._currentQuestionComponents[i].set(newSettings,{pluginName:"_assessment"})}}},_setupQuestionListeners:function _setupQuestionListeners(){var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isInteractionComplete"))continue;this.listenTo(question,"change:_isInteractionComplete",this._onQuestionCompleted)}},_checkNumberOfQuestionsAnswered:function _checkNumberOfQuestionsAnswered(){var questionComponents=this._currentQuestionComponents;var numberOfQuestionsAnswered=0;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isInteractionComplete")){numberOfQuestionsAnswered++}}this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered)},_removeQuestionListeners:function _removeQuestionListeners(){var questionComponents=this._currentQuestionComponents;if(!questionComponents)return;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];this.stopListening(question,"change:_isInteractionComplete",this._onQuestionCompleted)}},_onQuestionCompleted:function _onQuestionCompleted(questionModel,value){if(value===false)return;if(!questionModel.get("_isInteractionComplete"))return;var numberOfQuestionsAnswered=this.get("_numberOfQuestionsAnswered");numberOfQuestionsAnswered++;this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered);this._updateQuestionsState();Adapt.assessment.saveState();this._checkAssessmentComplete()},_checkAssessmentComplete:function _checkAssessmentComplete(){var numberOfQuestionsAnswered=this.get("_numberOfQuestionsAnswered");var allQuestionsAnswered=numberOfQuestionsAnswered>=this._currentQuestionComponents.length;if(!allQuestionsAnswered)return;this._onAssessmentComplete()},_onAssessmentComplete:function _onAssessmentComplete(){var assessmentConfig=this.getConfig();this.set("_attemptInProgress",false);this._spendAttempt();var scoreAsPercent=this._getScoreAsPercent();var score=this._getScore();var maxScore=this._getMaxScore();this.set({_scoreAsPercent:scoreAsPercent,_score:score,_maxScore:maxScore,_lastAttemptScoreAsPercent:scoreAsPercent,_assessmentCompleteInSession:true,_isAssessmentComplete:true});this._updateQuestionsState();this._checkIsPass();this._removeQuestionListeners();if(this._isMarkingSuppressionEnabled()&&!this._isAttemptsLeft()){_.defer(function(){this._overrideMarkingSettings();this._refreshQuestions()}.bind(this))}Adapt.trigger("assessments:complete",this.getState(),this)},_updateQuestionsState:function _updateQuestionsState(){var questions=[];var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var questionComponent=questionComponents[i];var questionModel={_id:questionComponent.get("_id"),_isCorrect:questionComponent.get("_isCorrect")===undefined?null:questionComponent.get("_isCorrect")};questions.push(questionModel)}this.set("_questions",questions)},_checkIsPass:function _checkIsPass(){var assessmentConfig=this.getConfig();var isPercentageBased=assessmentConfig._isPercentageBased;var scoreToPass=assessmentConfig._scoreToPass;var scoreAsPercent=this.get("_scoreAsPercent");var score=this.get("_score");var isPass=isPercentageBased?scoreAsPercent>=scoreToPass:score>=scoreToPass;this.set("_isPass",isPass)},_getMarkingSettings:function _getMarkingSettings(){var markingSettings={};if(this._shouldSuppressMarking()){markingSettings={_canShowMarking:false,_canShowModelAnswer:false}}else{var questionConfig=this.getConfig()._questions;if(questionConfig.hasOwnProperty("_canShowModelAnswer")){markingSettings._canShowModelAnswer=questionConfig._canShowModelAnswer}if(questionConfig.hasOwnProperty("_canShowMarking")){markingSettings._canShowMarking=questionConfig._canShowMarking}}return markingSettings},_overrideMarkingSettings:function _overrideMarkingSettings(){var newMarkingSettings=this._getMarkingSettings();for(var i=0,l=this._currentQuestionComponents.length;i<l;i++){this._currentQuestionComponents[i].set(newMarkingSettings,{pluginName:"_assessment"})}},_refreshQuestions:function _refreshQuestions(){for(var a=0,b=this._currentQuestionComponents.length;a<b;a++){var question=this._currentQuestionComponents[a];question.refresh()}},_shouldSuppressMarking:function _shouldSuppressMarking(){return this._isMarkingSuppressionEnabled()&&this._isAttemptsLeft()},_isMarkingSuppressionEnabled:function _isMarkingSuppressionEnabled(){var assessmentConfig=this.getConfig();return assessmentConfig._suppressMarking},_isAttemptsLeft:function _isAttemptsLeft(){if(this.get("_isAssessmentComplete")&&this.get("_isPass"))return false;if(this.get("_attemptsLeft")===0)return false;return true},_spendAttempt:function _spendAttempt(){if(!this._isAttemptsLeft())return false;var attemptsSpent=this.get("_attemptsSpent");this.set("_attemptsSpent",++attemptsSpent);if(this.get("_attempts")=="infinite")return true;var attemptsLeft=this.get("_attemptsLeft");this.set("_attemptsLeft",--attemptsLeft);return true},_getScore:function _getScore(){var score=0;var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isCorrect")&&question.get("_questionWeight")){score+=question.get("_questionWeight")}}return score},_getMaxScore:function _getMaxScore(){var maxScore=0;var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_questionWeight")){maxScore+=question.get("_questionWeight")}}return maxScore},_getScoreAsPercent:function _getScoreAsPercent(){if(this._getMaxScore()===0)return 0;return Math.round(this._getScore()/this._getMaxScore()*100)},_getLastAttemptScoreAsPercent:function _getLastAttemptScoreAsPercent(){return this.get("_lastAttemptScoreAsPercent")},_checkReloadPage:function _checkReloadPage(){if(!this.canResetInPage())return false;var parentId=this.getParent().get("_id");var currentLocation=Adapt.location._currentId;if(currentLocation!=parentId)return false;if(!this.get("_isReady"))return false;return true},_reloadPage:function _reloadPage(callback){this._forceResetOnRevisit=true;this.listenToOnce(Adapt,"pageView:ready",callback);_.delay(function(){Backbone.history.navigate("#/id/"+Adapt.location._currentId,{replace:true,trigger:true})},250)},_resetQuestions:function _resetQuestions(callback){var assessmentConfig=this.getConfig();var syncIterations=1;var i=0,qs=this._currentQuestionComponents,len=qs.length;function step(){for(var j=0,count=Math.min(syncIterations,len-i);j<count;i++,j++){var question=qs[i];question.reset(assessmentConfig._questions._resetType,true)}i==len?callback():setTimeout(step)}step()},_onRemove:function _onRemove(){this._removeQuestionListeners()},_setCompletionStatus:function _setCompletionStatus(){this.set({_isComplete:true,_isInteractionComplete:true})},_checkIfQuestionsWereRestored:function _checkIfQuestionsWereRestored(){if(this.get("_assessmentCompleteInSession"))return;if(!this.get("_isAssessmentComplete"))return;var wereQuestionsRestored=true;var questions=this.get("_questions");for(var i=0,l=questions.length;i<l;i++){var question=questions[i];var questionModel=Adapt.findById(question._id);if(!questionModel.get("_isSubmitted")){wereQuestionsRestored=false;break}}if(!wereQuestionsRestored){this.set("_assessmentCompleteInSession",true);return true}return false},isAssessmentEnabled:function isAssessmentEnabled(){if(this.get("_assessment")&&this.get("_assessment")._isEnabled)return true;return false},canResetInPage:function canResetInPage(){var assessmentConfig=this.getConfig();if(assessmentConfig._reloadPageOnReset===false)return false;return true},reset:function reset(force,callback){if(this._isResetInProgress){this.once("reset",function(){this._isResetInProgress=false;if(typeof callback=="function"){callback(true)}});return}var assessmentConfig=this.getConfig();force=this._forceResetOnRevisit||force===true;this._forceResetOnRevisit=false;var isPageReload=this._checkReloadPage();if(this.get("_assessmentCompleteInSession")&&!assessmentConfig._isResetOnRevisit&&!isPageReload&&!force){if(typeof callback=="function"){callback(false)}return false}var wereQuestionsRestored=this._checkIfQuestionsWereRestored();force=force||wereQuestionsRestored;if(force&&!this._isAttemptsLeft()){this.set({_attemptsLeft:this.get("_attempts"),_attemptsSpent:0})}var allowResetIfPassed=this.get("_assessment")._allowResetIfPassed;if(!this._isAttemptsLeft()&&!force&&!allowResetIfPassed){if(typeof callback=="function")callback(false);return false}if(!isPageReload){this.once("reset",function(){this._isResetInProgress=false;if(typeof callback=="function"){callback(true)}});this._isResetInProgress=true;this._setupAssessmentData(force,function(){this.trigger("reset")})}else{this._reloadPage(function(){if(typeof callback=="function"){callback(true)}})}return true},getSaveState:function getSaveState(){var state=this.getState();var indexByIdQuestions=[];var cfg=this.getConfig();var banksActive=cfg._banks&&cfg._banks._isEnabled&&cfg._banks._split.length>1;var randomisationActive=cfg._randomisation&&cfg._randomisation._isEnabled;if(!banksActive&&!randomisationActive){this.findDescendantModels("components").forEach(function(component){var componentModel={_id:component.get("_id"),_isCorrect:component.get("_isCorrect")===undefined?null:component.get("_isCorrect")};indexByIdQuestions.push(componentModel)});indexByIdQuestions=_.indexBy(indexByIdQuestions,"_id")}else{indexByIdQuestions=_.indexBy(state.questions,"_id")}for(var id in indexByIdQuestions){if(indexByIdQuestions.hasOwnProperty(id)){indexByIdQuestions[id]=indexByIdQuestions[id]._isCorrect}}var saveState=[state.isComplete?1:0,state.attemptsSpent,state.maxScore,state.score,state.attemptInProgress?1:0,indexByIdQuestions];return saveState},setRestoreState:function setRestoreState(restoreState){var id;var isComplete=restoreState[0]==1?true:false;var attempts=this.get("_attempts");var attemptsSpent=restoreState[1];var maxScore=restoreState[2];var score=restoreState[3];var attemptInProgress=restoreState[4]==1?true:false;var scoreAsPercent;var indexByIdQuestions=restoreState[5];var blockIds={};for(id in indexByIdQuestions){if(indexByIdQuestions.hasOwnProperty(id)){var blockId=Adapt.findById(id).get("_parentId");blockIds[blockId]=Adapt.findById(blockId)}}var restoredChildrenModels=_.values(blockIds);if(indexByIdQuestions)this.getChildren().models=restoredChildrenModels;this.set({_isAssessmentComplete:isComplete,_assessmentCompleteInSession:false,_attemptsSpent:attemptsSpent,_attemptInProgress:attemptInProgress,_attemptsLeft:attempts==="infinite"?attempts:attempts-attemptsSpent,_maxScore:maxScore||this._getMaxScore(),_score:score||0});if(score){scoreAsPercent=Math.round(score/maxScore*100)}else{scoreAsPercent=0}this.set({_scoreAsPercent:scoreAsPercent,_lastAttemptScoreAsPercent:scoreAsPercent});var questions=[];for(id in indexByIdQuestions){if(indexByIdQuestions.hasOwnProperty(id)&&Adapt.findById(id).get("_isQuestionType")){questions.push({_id:id,_isCorrect:indexByIdQuestions[id]})}}this.set("_questions",questions);if(isComplete)this._checkIsPass();Adapt.trigger("assessments:restored",this.getState(),this)},getState:function getState(){var assessmentConfig=this.getConfig();var state={id:assessmentConfig._id,type:"article-assessment",pageId:this.getParent().get("_id"),articleId:this.get("_id"),isEnabled:assessmentConfig._isEnabled,isComplete:this.get("_isAssessmentComplete"),isPercentageBased:assessmentConfig._isPercentageBased,scoreToPass:assessmentConfig._scoreToPass,score:this.get("_score"),scoreAsPercent:this.get("_scoreAsPercent"),maxScore:this.get("_maxScore"),isPass:this.get("_isPass"),includeInTotalScore:assessmentConfig._includeInTotalScore,assessmentWeight:assessmentConfig._assessmentWeight,attempts:this.get("_attempts"),attemptsSpent:this.get("_attemptsSpent"),attemptsLeft:this.get("_attemptsLeft"),attemptInProgress:this.get("_attemptInProgress"),lastAttemptScoreAsPercent:this.get("_lastAttemptScoreAsPercent"),questions:this.get("_questions"),resetType:assessmentConfig._questions._resetType,allowResetIfPassed:assessmentConfig._allowResetIfPassed,questionModels:new Backbone.Collection(this._currentQuestionComponents)};return state},getConfig:function getConfig(){var assessmentConfig=this.get("_assessment");if(!assessmentConfig){assessmentConfig=$.extend(true,{},assessmentConfigDefaults)}else{assessmentConfig=$.extend(true,{},assessmentConfigDefaults,assessmentConfig)}if(assessmentConfig._id===undefined){assessmentConfig._id="givenId"+givenIdCount++}this.set("_assessment",assessmentConfig);return assessmentConfig}};return AssessmentModel});define("extensions/adapt-contrib-assessment/js/assessment",["core/js/adapt"],function(Adapt){var assessmentsConfigDefaults={_isPercentageBased:true,_scoreToPass:100,_isDefaultsLoaded:true};Adapt.assessment=_.extend({_assessments:_.extend([],{_byPageId:{},_byAssessmentId:{}}),initialize:function initialize(){this.listenTo(Adapt,{"assessments:complete":this._onAssessmentsComplete,"router:location":this._checkResetAssessmentsOnRevisit,"router:plugin":this._handleRoute,"app:dataReady":this._onDataReady})},_onAssessmentsComplete:function _onAssessmentsComplete(state){var assessmentId=state.id;state.isComplete=true;if(assessmentId===undefined)return;if(!this._getStateByAssessmentId(assessmentId)){Adapt.log.warn("assessments: state was not registered when assessment was created")}this.saveState();this._setPageProgress();this._checkAssessmentsComplete()},_restoreModelState:function _restoreModelState(assessmentModel){if(!this._saveStateModel){this._saveStateModel=Adapt.offlineStorage.get("assessment")}if(this._saveStateModel){var state=assessmentModel.getState();if(this._saveStateModel[state.id]){assessmentModel.setRestoreState(this._saveStateModel[state.id])}}},_handleRoute:function _handleRoute(plugin,id){if(plugin!=="assessment"&&plugin!=="article-assessment"||id===undefined){return}if(!Adapt.findById(id)){var assessment=Adapt.assessment._assessments._byAssessmentId[id];if(assessment){id=assessment.get("_id")}else{Adapt.log.warn("Assessment not found with _id: "+id);return}}_.defer(function(){Backbone.history.navigate("#/id/"+id,{trigger:true,replace:true})})},_checkResetAssessmentsOnRevisit:function _checkResetAssessmentsOnRevisit(toObject){if(toObject._contentType!=="page")return;var pageAssessmentModels=this._getAssessmentByPageId(toObject._currentId);if(pageAssessmentModels===undefined)return;Adapt.wait.for(function resetAllAssessments(allAssessmentHaveReset){var numberOfAssessments=pageAssessmentModels.length;var numberOfResetAssessments=0;var forceAssessmentReset=false;pageAssessmentModels.forEach(function(model){model.reset(forceAssessmentReset,function(){numberOfResetAssessments++;var haveAllModelsReset=numberOfResetAssessments===numberOfAssessments;if(!haveAllModelsReset){return}allAssessmentHaveReset()})})});this._setPageProgress()},_onDataReady:function _onDataReady(){this._assessments=_.extend([],{_byPageId:{},_byAssessmentId:{}});this._restoredCount=0},_checkAssessmentsComplete:function _checkAssessmentsComplete(){var allAssessmentsComplete=true;var assessmentToPostBack=0;var states=this._getStatesByAssessmentId();var assessmentStates=[];for(var id in states){var state=states[id];if(!state.includeInTotalScore)continue;if(!state.isComplete){allAssessmentsComplete=false;break}assessmentToPostBack++;assessmentStates.push(state)}if(!allAssessmentsComplete||assessmentToPostBack===0)return false;if(assessmentToPostBack===1){this._setupSingleAssessmentConfiguration(assessmentStates[0])}_.defer(function(){Adapt.trigger("assessment:complete",this.getState())}.bind(this));return true},_setupSingleAssessmentConfiguration:function _setupSingleAssessmentConfiguration(assessmentState){var assessmentsConfig=Adapt.course.get("_assessment");$.extend(true,assessmentsConfig,{_isPercentageBased:assessmentState.isPercentageBased,_scoreToPass:assessmentState.scoreToPass});Adapt.course.set("_assessment",assessmentsConfig)},_getAssessmentByPageId:function _getAssessmentByPageId(pageId){return this._assessments._byPageId[pageId]},_getStateByAssessmentId:function _getStateByAssessmentId(assessmentId){if(assessmentId===undefined){return null}return this._assessments._byAssessmentId[assessmentId].getState()},_getStatesByAssessmentId:function _getStatesByAssessmentId(){var states={};for(var i=0,l=this._assessments.length;i<l;i++){var assessmentModel=this._assessments[i];if(!assessmentModel.get("_isAvailable"))continue;var state=assessmentModel.getState();states[state.id]=state}return states},_setPageProgress:function _setPageProgress(){for(var k in this._assessments._byPageId){var assessments=this._assessments._byPageId[k];var assessmentsTotal=assessments.length;var assessmentsPassed=0;for(var i=0,l=assessments.length;i<l;i++){var assessmentState=assessments[i].getState();if(assessmentState.includeInTotalScore&&!assessmentState.isPass)continue;if(assessmentState.isComplete){assessmentsPassed++}}try{var pageModel=Adapt.findById(k);pageModel.set({_subProgressTotal:assessmentsTotal,_subProgressComplete:assessmentsPassed})}catch(e){}}},_addToAssessmentIdMap:function _addToAssessmentIdMap(id,model){if(id===undefined){Adapt.log.warn("An assessment has been registered with an undefined value for \"_id\"");return}if(id===""){Adapt.log.warn("An assessment has been registered with an empty value for \"_id\"")}if(!this._assessments._byAssessmentId[id]){this._assessments._byAssessmentId[id]=model}else{Adapt.log.warn("An assessment with an _id of \""+id+"\" already exists!")}},_setupQuestionNumbering:function _setupQuestionNumbering(){var getRelatedQuestions=function getRelatedQuestions(data){var currentAssessmentId=data._assessmentId;var currentAssessment=Adapt.assessment.get(currentAssessmentId);return currentAssessment.getState().questions};Handlebars.registerHelper("questionNumber",function getQuestionNumber(){var data=this.view?this.view.model.toJSON():this;if(!data._isPartOfAssessment)return;var related=_.pluck(getRelatedQuestions(data),"_id");return related.indexOf(data._id)+1});Handlebars.registerHelper("questionCount",function getTotalQuestions(){var data=this.view?this.view.model.toJSON():this;if(!data._isPartOfAssessment)return;return getRelatedQuestions(data).length})},register:function register(assessmentModel){var state=assessmentModel.getState();var assessmentId=state.id;var pageId=state.pageId;if(this._assessments._byPageId[pageId]===undefined){this._assessments._byPageId[pageId]=[]}this._assessments._byPageId[pageId].push(assessmentModel);this._addToAssessmentIdMap(assessmentId,assessmentModel);this._assessments.push(assessmentModel);this._restoreModelState(assessmentModel);this._restoredCount++;Adapt.trigger("assessments:register",state,assessmentModel);this._setPageProgress();this._setupQuestionNumbering();if(this._restoredCount===this._assessments.length){Adapt.trigger("assessment:restored",this.getState())}},get:function get(id){if(id===undefined){return this._assessments.slice(0)}else{return this._assessments._byAssessmentId[id]}},saveState:function saveState(){this._saveStateModel={};for(var i=0,assessmentModel;assessmentModel=this._assessments[i++];){var state=assessmentModel.getState();this._saveStateModel[state.id]=assessmentModel.getSaveState()}Adapt.offlineStorage.set("assessment",this._saveStateModel)},getConfig:function getConfig(){var assessmentsConfig=Adapt.course.get("_assessment");if(assessmentsConfig&&assessmentsConfig._isDefaultsLoaded){return assessmentsConfig}if(assessmentsConfig===undefined){assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults)}else{assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults,assessmentsConfig)}Adapt.course.set("_assessment",assessmentsConfig);return assessmentsConfig},getState:function getState(){var assessmentsConfig=this.getConfig();var score=0;var maxScore=0;var isPass=false;var totalAssessments=0;var states=this._getStatesByAssessmentId();var assessmentsComplete=0;for(var id in states){var state=states[id];if(!state.includeInTotalScore)continue;if(state.isComplete)assessmentsComplete++;totalAssessments++;maxScore+=state.maxScore/state.assessmentWeight;score+=state.score/state.assessmentWeight}var isComplete=assessmentsComplete==totalAssessments;var scoreAsPercent=Math.round(score/maxScore*100);if((assessmentsConfig._scoreToPass||100)&&isComplete){if(assessmentsConfig._isPercentageBased!==false){if(scoreAsPercent>=assessmentsConfig._scoreToPass)isPass=true}else{if(score>=assessmentsConfig._scoreToPass)isPass=true}}return{isComplete:isComplete,isPercentageBased:assessmentsConfig._isPercentageBased,isPass:isPass,scoreAsPercent:scoreAsPercent,maxScore:maxScore,score:score,scoreToPass:assessmentsConfig._scoreToPass,assessmentsComplete:assessmentsComplete,assessments:totalAssessments}}},Backbone.Events);Adapt.assessment.initialize()});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension",["core/js/views/articleView","core/js/models/articleModel","./adapt-assessmentArticleView","./adapt-assessmentArticleModel","./assessment"],function(ArticleView,ArticleModel,AdaptAssessmentArticleView,AdaptAssessmentArticleModel){var ArticleViewInitialize=ArticleView.prototype.initialize;ArticleView.prototype.initialize=function(options){if(this.model.get("_assessment")&&this.model.get("_assessment")._isEnabled===true){_.extend(this,AdaptAssessmentArticleView)}return ArticleViewInitialize.apply(this,arguments)};var ArticleModelInitialize=ArticleModel.prototype.initialize;ArticleModel.prototype.initialize=function(options){if(this.get("_assessment")&&this.get("_assessment")._isEnabled===true){_.extend(this,AdaptAssessmentArticleModel);var returnValue=ArticleModelInitialize.apply(this,arguments);this._postInitialize();return returnValue}return ArticleModelInitialize.apply(this,arguments)}});define("extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking",["core/js/adapt"],function(Adapt){var Bookmarking=Backbone.Controller.extend({bookmarkLevel:null,watchViewIds:null,watchViews:[],restoredLocationID:null,currentLocationID:null,initialize:function initialize(){this.listenToOnce(Adapt,"router:location",this.onAdaptInitialize)},onAdaptInitialize:function onAdaptInitialize(){if(!this.checkIsEnabled())return;this.setupEventListeners();this.checkRestoreLocation()},checkIsEnabled:function checkIsEnabled(){var courseBookmarkModel=Adapt.course.get("_bookmarking");if(!courseBookmarkModel||!courseBookmarkModel._isEnabled)return false;if(!Adapt.offlineStorage)return false;return true},setupEventListeners:function setupEventListeners(){this._onScroll=_.debounce(this.checkLocation.bind(this),1000);this.listenTo(Adapt,{"menuView:ready":this.setupMenu,"pageView:preRender":this.setupPage})},checkRestoreLocation:function checkRestoreLocation(){this.restoredLocationID=Adapt.offlineStorage.get("location");if(!this.restoredLocationID||this.restoredLocationID==="undefined")return;this.listenToOnce(Adapt,"pageView:ready menuView:ready",this.restoreLocation)},restoreLocation:function restoreLocation(){_.defer(function(){this.stopListening(Adapt,"pageView:ready menuView:ready",this.restoreLocation);if(this.restoredLocationID===Adapt.location._currentId||!Adapt.findById(this.restoredLocationID)){return}var locationOnscreen=$("."+this.restoredLocationID).onscreen();var isLocationOnscreen=locationOnscreen&&locationOnscreen.percentInview>0;var isLocationFullyInview=locationOnscreen&&locationOnscreen.percentInview===100;if(isLocationOnscreen&&isLocationFullyInview){return}if(Adapt.course.get("_bookmarking")._showPrompt===false){this.navigateToPrevious();return}this.showPrompt()}.bind(this))},showPrompt:function showPrompt(){var courseBookmarkModel=Adapt.course.get("_bookmarking");var buttons=courseBookmarkModel._buttons||{yes:"Yes",no:"No"};this.listenToOnce(Adapt,{"bookmarking:continue":this.navigateToPrevious,"bookmarking:cancel":this.navigateCancel});var promptObject={title:courseBookmarkModel.title,body:courseBookmarkModel.body,_prompts:[{promptText:buttons.yes||"Yes",_callbackEvent:"bookmarking:continue"},{promptText:buttons.no||"No",_callbackEvent:"bookmarking:cancel"}],_showIcon:true};var accessibility=Adapt.config.get("_accessibility");if(!accessibility||!accessibility._isActive){Adapt.trigger("notify:prompt",promptObject);return}$(".js-loading").show();$("#a11y-focuser").focus();$("body").attr("aria-hidden",true);_.delay(function(){$(".js-loading").hide();$("body").removeAttr("aria-hidden");Adapt.trigger("notify:prompt",promptObject)},3000)},navigateToPrevious:function navigateToPrevious(){_.defer(function(){var isSinglePage=Adapt.contentObjects.models.length==1;Backbone.history.navigate("#/id/"+this.restoredLocationID,{trigger:true,replace:isSinglePage})}.bind(this));this.stopListening(Adapt,"bookmarking:cancel")},navigateCancel:function navigateCancel(){this.stopListening(Adapt,"bookmarking:continue")},resetLocationID:function resetLocationID(){this.setLocationID("")},setupMenu:function setupMenu(menuView){var menuModel=menuView.model;if(!menuModel.get("_parentId")){this.resetLocationID();return}this.setLocationID(menuModel.get("_id"))},getBookmarkLevel:function getBookmarkLevel(pageModel){var defaultLevel=Adapt.course.get("_bookmarking")._level||"component";var bookmarkModel=pageModel.get("_bookmarking");var isInherit=!bookmarkModel||!bookmarkModel._level||bookmarkModel._level==="inherit";return isInherit?defaultLevel:bookmarkModel._level},setupPage:function setupPage(pageView){var pageBookmarkModel=pageView.model.get("_bookmarking");if(pageBookmarkModel&&pageBookmarkModel._isEnabled===false){this.resetLocationID();return}this.setLocationID(pageView.model.get("_id"));this.bookmarkLevel=this.getBookmarkLevel(pageView.model);if(this.bookmarkLevel==="page"){return}this.watchViewIds=pageView.model.findDescendantModels(this.bookmarkLevel+"s").map(function(desc){return desc.get("_id")});this.listenTo(Adapt,this.bookmarkLevel+"View:postRender",this.captureViews);this.listenToOnce(Adapt,"remove",this.releaseViews);$(window).on("scroll",this._onScroll)},captureViews:function captureViews(view){this.watchViews.push(view)},setLocationID:function setLocationID(id){if(!Adapt.offlineStorage)return;if(this.currentLocationID==id)return;Adapt.offlineStorage.set("location",id);this.currentLocationID=id},releaseViews:function releaseViews(){this.watchViews.length=0;this.watchViewIds.length=0;this.stopListening(Adapt,"remove",this.releaseViews);this.stopListening(Adapt,this.bookmarkLevel+"View:postRender",this.captureViews);$(window).off("scroll",this._onScroll)},checkLocation:function checkLocation(){var highestOnscreen=0;var highestOnscreenLocation="";for(var i=0,l=this.watchViews.length;i<l;i++){var view=this.watchViews[i];var isViewAPageChild=this.watchViewIds.indexOf(view.model.get("_id"))>-1;if(!isViewAPageChild)continue;var element=$("."+view.model.get("_id"));var measurements=element.onscreen();if(!measurements.onscreen)continue;if(measurements.percentInview>highestOnscreen){highestOnscreen=measurements.percentInview;highestOnscreenLocation=view.model.get("_id")}}if(highestOnscreenLocation)this.setLocationID(highestOnscreenLocation)}});return new Bookmarking});define("extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView",["core/js/adapt"],function(Adapt){var NavigationView=Backbone.View.extend({className:"nav",attributes:{role:"navigation"},initialize:function initialize(){this.template="languagePickerNavigation";this.setupHelpers();this.preRender()},preRender:function preRender(){Adapt.trigger("navigationView:preRender",this);this.render()},render:function render(){var template=Handlebars.templates[this.template];this.$el.html(template({_config:this.model.get("_accessibility"),_accessibility:Adapt.config.get("_accessibility")})).insertBefore("#app");_.defer(function(){Adapt.trigger("navigationView:postRender",this)}.bind(this));return this},setupHelpers:function setupHelpers(){Handlebars.registerHelper("a11y_aria_label",function(text){return"<div class=\"aria-label\">"+text+"</div>"})}});return NavigationView});define("extensions/adapt-contrib-languagePicker/js/languagePickerView",["core/js/adapt","./languagePickerNavigationView"],function(Adapt,NavigationView){var LanguagePickerView=Backbone.View.extend({events:{"click .js-languagepicker-btn-click":"onLanguageClick"},className:"languagepicker",initialize:function initialize(){this.initializeNavigation();$("html").addClass("in-languagepicker");this.listenTo(Adapt,"remove",this.remove);this.render()},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data));this.$el.addClass(data._classes);document.title=this.model.get("title")||"";_.defer(this.postRender.bind(this))},postRender:function postRender(){$(".js-loading").hide()},onLanguageClick:function onLanguageClick(event){this.destroyNavigation();this.model.setLanguage($(event.target).val())},initializeNavigation:function initializeNavigation(){this.navigationView=new NavigationView({model:this.model})},destroyNavigation:function destroyNavigation(){this.navigationView.remove()},remove:function remove(){$("html").removeClass("in-languagepicker");Backbone.View.prototype.remove.apply(this,arguments)}},{template:"languagePickerView"});return LanguagePickerView});define("extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView",["core/js/adapt"],function(Adapt){var LanguagePickerDrawerView=Backbone.View.extend({events:{"click .js-languagepicker-item-btn":"onButtonClick"},initialize:function initialize(){this.listenTo(Adapt,{remove:this.remove,"languagepicker:changelanguage:yes":this.onDoChangeLanguage,"languagepicker:changelanguage:no":this.onDontChangeLanguage});this.render()},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},onButtonClick:function onButtonClick(event){var newLanguage=$(event.currentTarget).attr("data-language");this.model.set("newLanguage",newLanguage);var data=this.model.getLanguageDetails(newLanguage);var promptObject={_attributes:{lang:newLanguage},_classes:"is-lang-".concat(newLanguage," ").concat(data._direction==="rtl"?"is-rtl":"is-ltr"),title:data.warningTitle,body:data.warningMessage,_prompts:[{promptText:data._buttons.yes,_callbackEvent:"languagepicker:changelanguage:yes"},{promptText:data._buttons.no,_callbackEvent:"languagepicker:changelanguage:no"}],_showIcon:true};if($.a11y){this.$finishFocus=$.a11y.state.focusStack.pop();$.a11y.state.focusStack.push($("#focuser"))}else{this.$finishFocus=Adapt.a11y._popup._focusStack.pop();Adapt.a11y._popup._focusStack.push($("#a11y-focuser"))}Adapt.once("drawer:closed",function(){_.delay(function(){Adapt.once("popup:opened",function(){if($.a11y){$.a11y.state.focusStack.pop();$.a11y.state.focusStack.push($("#focuser"));return}Adapt.a11y._popup._focusStack.pop();Adapt.a11y._popup._focusStack.push($("#a11y-focuser"))});Adapt.trigger("notify:prompt",promptObject)},250)});Adapt.trigger("drawer:closeDrawer")},onDoChangeLanguage:function onDoChangeLanguage(){var newLanguage=this.model.get("newLanguage");this.model.setTrackedData();this.model.setLanguage(newLanguage);this.remove()},onDontChangeLanguage:function onDontChangeLanguage(){this.remove();_.delay(function(){this.$finishFocus.a11y_focus()}.bind(this),500)}},{template:"languagePickerDrawerView"});return LanguagePickerDrawerView});define("extensions/adapt-contrib-languagePicker/js/languagePickerNavView",["core/js/adapt","./languagePickerDrawerView"],function(Adapt,LanguagePickerDrawerView){var LanguagePickerNavView=Backbone.View.extend({tagName:"button",className:function className(){var classNames="btn-icon nav__btn nav__languagepicker-btn js-languagepicker-nav-btn icon";var customClass=this.model.get("_languagePickerIconClass")||"icon-language-2";return classNames+" "+customClass},events:{"click":"onClick"},initialize:function initialize(){this.listenTo(Adapt,"remove",this.remove)},onClick:function onClick(event){Adapt.drawer.triggerCustomView(new LanguagePickerDrawerView({model:this.model}).$el,false)}});return LanguagePickerNavView});define("extensions/adapt-contrib-languagePicker/js/languagePickerModel",["core/js/adapt"],function(Adapt){var LanguagePickerModel=Backbone.Model.extend({defaults:{_isEnabled:false,displayTitle:"",body:"",_languages:[]},trackedData:{components:[],blocks:[]},locationId:null,initialize:function initialize(){this.listenTo(Adapt.config,"change:_activeLanguage",this.markLanguageAsSelected);this.listenTo(Adapt,"app:dataLoaded",this.onDataLoaded)},getLanguageDetails:function getLanguageDetails(language){var _languages=this.get("_languages");return _.find(_languages,function(item){return item._language===language})},setLanguage:function setLanguage(language){Adapt.config.set({"_activeLanguage":language,"_defaultDirection":this.getLanguageDetails(language)._direction})},markLanguageAsSelected:function markLanguageAsSelected(model,language){this.get("_languages").forEach(function(item){item._isSelected=item._language===language})},onDataLoaded:function onDataLoaded(){if(!this.get("_restoreStateOnLanguageChange")){return}_.defer(function(){this.locationId=Adapt.offlineStorage.get("location")||null;this.restoreState()}.bind(this))},restoreLocation:function restoreLocation(){if(!Adapt.mapById(this.locationId))return;_.defer(function(){Adapt.navigateToElement("."+this.locationId)}.bind(this))},restoreState:function restoreState(){if(this.isTrackedDataEmpty())return;if(this.trackedData.components){this.trackedData.components.forEach(this.setTrackableState)}if(this.trackedData.blocks){this.trackedData.blocks.forEach(this.setTrackableState)}},isTrackedDataEmpty:function isTrackedDataEmpty(){return _.isEqual(this.trackedData,{components:[],blocks:[]})},getTrackableState:function getTrackableState(){var components=this.getState(Adapt.components.models);var blocks=this.getState(Adapt.blocks.models);return{components:_.compact(components),blocks:_.compact(blocks)}},getState:function getState(models){return models.map(function(model){if(model.get("_isComplete")){return model.getTrackableState()}})},setTrackedData:function setTrackedData(){if(this.get("_restoreStateOnLanguageChange")){this.listenToOnce(Adapt,"menuView:ready",this.restoreLocation);this.trackedData=this.getTrackableState()}},setTrackableState:function setTrackableState(stateObject){var restoreModel=Adapt.findById(stateObject._id);if(restoreModel){restoreModel.setTrackableState(stateObject)}else{Adapt.log.warn("LanguagePicker unable to restore state for: "+stateObject._id)}}});return LanguagePickerModel});define("extensions/adapt-contrib-languagePicker/js/adapt-languagePicker",["core/js/adapt","./languagePickerView","./languagePickerNavView","./languagePickerModel"],function(Adapt,LanguagePickerView,LanguagePickerNavView,LanguagePickerModel){var languagePickerModel;Adapt.once("configModel:dataLoaded",onConfigLoaded);function onConfigLoaded(){if(!Adapt.config.has("_languagePicker"))return;if(!Adapt.config.get("_languagePicker")._isEnabled)return;Adapt.config.set("_canLoadData",false);languagePickerModel=new LanguagePickerModel(Adapt.config.get("_languagePicker"));Adapt.on("router:menu router:page",setupNavigationView);if(Adapt.offlineStorage.ready){onOfflineStorageReady()}else{Adapt.once("offlineStorage:ready",onOfflineStorageReady)}}function onOfflineStorageReady(){var storedLanguage=Adapt.offlineStorage.get("lang");if(storedLanguage){languagePickerModel.setLanguage(storedLanguage)}else if(languagePickerModel.get("_showOnCourseLoad")===false){languagePickerModel.setLanguage(Adapt.config.get("_defaultLanguage"))}else{showLanguagePickerView()}}function showLanguagePickerView(){var languagePickerView=new LanguagePickerView({model:languagePickerModel});languagePickerView.$el.appendTo("#wrapper")}function setupNavigationView(){var courseGlobals=Adapt.course.get("_globals")._extensions;var navigationBarLabel="";if(courseGlobals._languagePicker){navigationBarLabel=courseGlobals._languagePicker.navigationBarLabel}var languagePickerNavView=new LanguagePickerNavView({model:languagePickerModel,attributes:{"aria-label":navigationBarLabel}});languagePickerNavView.$el.appendTo(".nav__inner")}});define("extensions/adapt-contrib-pageLevelProgress/js/completionCalculations",["core/js/adapt"],function(Adapt){var Completion=Backbone.Controller.extend({subProgressCompleted:0,subProgressTotal:0,nonAssessmentCompleted:0,nonAssessmentTotal:0,assessmentCompleted:0,assessmentTotal:0});function calculateCompletion(contentObjectModel){var completion=new Completion;var viewType=contentObjectModel.get("_type");var isComplete=contentObjectModel.get("_isComplete")?1:0;var children;switch(viewType){case"page":children=contentObjectModel.getAllDescendantModels().filter(function(model){return model.get("_isAvailable")&&!model.get("_isOptional")});var availableChildren=filterAvailableChildren(children);var components=getPageLevelProgressEnabledModels(availableChildren);var nonAssessmentComponents=getNonAssessmentComponents(components);completion.nonAssessmentTotal=nonAssessmentComponents.length;completion.nonAssessmentCompleted=getComponentsCompleted(nonAssessmentComponents).length;var assessmentComponents=getAssessmentComponents(components);completion.assessmentTotal=assessmentComponents.length;completion.assessmentCompleted=getComponentsInteractionCompleted(assessmentComponents).length;if(contentObjectModel.get("_pageLevelProgress")._excludeAssessments!==true){completion.subProgressCompleted=contentObjectModel.get("_subProgressComplete")||0;completion.subProgressTotal=contentObjectModel.get("_subProgressTotal")||0}var showPageCompletionCourse=Adapt.course.get("_pageLevelProgress")&&Adapt.course.get("_pageLevelProgress")._showPageCompletion!==false;var showPageCompletionPage=contentObjectModel.get("_pageLevelProgress")&&contentObjectModel.get("_pageLevelProgress")._showPageCompletion!==false;if(showPageCompletionCourse&&showPageCompletionPage){completion.nonAssessmentCompleted+=isComplete;completion.nonAssessmentTotal+=1}break;case"menu":case"course":children=contentObjectModel.get("_children").models;children.forEach(function(contentObject){var completionObject=calculateCompletion(contentObject);completion.subProgressCompleted+=completionObject.subProgressCompleted||0;completion.subProgressTotal+=completionObject.subProgressTotal||0;completion.nonAssessmentTotal+=completionObject.nonAssessmentTotal;completion.nonAssessmentCompleted+=completionObject.nonAssessmentCompleted;completion.assessmentTotal+=completionObject.assessmentTotal;completion.assessmentCompleted+=completionObject.assessmentCompleted});break;}return completion}function getNonAssessmentComponents(models){return models.filter(function(model){return!model.get("_isPartOfAssessment")})}function getAssessmentComponents(models){return models.filter(function(model){return model.get("_isPartOfAssessment")})}function getComponentsCompleted(models){return models.filter(function(item){return item.get("_isComplete")})}function getComponentsInteractionCompleted(models){return models.filter(function(item){return item.get("_isComplete")})}function getPageLevelProgressEnabledModels(models){return models.filter(function(model){var config=model.get("_pageLevelProgress");return config&&config._isEnabled})}function unavailableInHierarchy(parents){if(!parents)return;return parents.some(function(parent){return!parent.get("_isAvailable")})}function filterAvailableChildren(children){var availableChildren=[];for(var i=0,count=children.length;i<count;i++){var parents=children[i].getAncestorModels();if(unavailableInHierarchy(parents))continue;availableChildren.push(children[i])}return availableChildren}function calculatePercentageComplete(model){var completionObject=calculateCompletion(model);var completed=completionObject.nonAssessmentCompleted+completionObject.assessmentCompleted+completionObject.subProgressCompleted;var total=completionObject.nonAssessmentTotal+completionObject.assessmentTotal+completionObject.subProgressTotal;var percentageComplete=Math.floor(completed/total*100);return percentageComplete}return{calculateCompletion:calculateCompletion,calculatePercentageComplete:calculatePercentageComplete,getPageLevelProgressEnabledModels:getPageLevelProgressEnabledModels,filterAvailableChildren:filterAvailableChildren}});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView",["core/js/adapt"],function(Adapt){var PageLevelProgressIndicatorView=Backbone.View.extend({initialize:function initialize(options){options=options||{};this.parent=options.parent;this.calculatePercentage=options.calculatePercentage||this.calculatePercentage;this.ariaLabel=options.ariaLabel||"";this.type=options.type||this.model.get("_type");this.addClasses();this.setUpEventListeners();this.setPercentageComplete();this.render();this.refresh()},addClasses:function addClasses(){this.$el.addClass(["pagelevelprogress__indicator","is-"+this.type].join(" "))},checkAria:function checkAria(){if(!this.ariaLabel){this.$el.attr("aria-hidden",true);return}var data=this.getRenderData();this.$(".js-indicator-aria-label").html(Handlebars.compile(this.ariaLabel)(data))},setUpEventListeners:function setUpEventListeners(){if(this.parent){this.listenToOnce(this.parent,"postRemove",this.remove)}else{this.listenTo(Adapt,"remove",this.remove)}this.listenTo(this.model,"change:_isComplete",this.refresh);if(!this.collection)return;this.listenTo(this.collection,"change:_isComplete",this.refresh)},setPercentageComplete:function setPercentageComplete(){var percentage=this.calculatePercentage();this.model.set("percentageComplete",percentage);return percentage},calculatePercentage:function calculatePercentage(){return this.model.get("_isComplete")?100:0},render:function render(){var data=this.getRenderData();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},getRenderData:function getRenderData(){var data=this.model.toJSON();data.ariaLabel=this.ariaLabel;data.type=this.type;return data},refresh:function refresh(){this.checkCompletion();this.checkAria();this.$(".js-indicator-bar").css({width:this.calculatePercentage()+"%"})},checkCompletion:function checkCompletion(){var percentage=this.setPercentageComplete();this.$el.toggleClass("is-complete",percentage===100).toggleClass("is-incomplete",percentage!==100)}},{template:"pageLevelProgressIndicator"});return PageLevelProgressIndicatorView});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView",["core/js/adapt","./PageLevelProgressIndicatorView"],function(Adapt,PageLevelProgressIndicatorView){var PageLevelProgressItemView=Backbone.View.extend({className:function className(){return["pagelevelprogress__item drawer__item",this.model.get("_type")+"__indicator"].join(" ")},attributes:{"role":"listitem"},initialize:function initialize(){this.listenTo(Adapt,"remove",this.remove);this.render();this.addIndicator()},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},addIndicator:function addIndicator(){if(this.model.get("_isOptional"))return;var item=new PageLevelProgressIndicatorView({model:this.model});this.$(".js-indicator").append(item.$el)}},{template:"pageLevelProgressItem"});return PageLevelProgressItemView});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView",["core/js/adapt","./PageLevelProgressItemView"],function(Adapt,PageLevelProgressItemView){var PageLevelProgressView=Backbone.View.extend({className:"pagelevelprogress",events:{"click .js-pagelevelprogress-item-click":"scrollToPageElement"},initialize:function initialize(){this.listenTo(Adapt,"remove",this.remove);this.render();this.addChildren()},scrollToPageElement:function scrollToPageElement(event){if(event&&event.preventDefault)event.preventDefault();var $target=$(event.currentTarget);if($target.is(".is-disabled"))return;var currentComponentSelector="."+$target.attr("data-pagelevelprogress-id");Adapt.once("drawer:closed",function(){Adapt.scrollTo(currentComponentSelector,{duration:400})}).trigger("drawer:closeDrawer",$(currentComponentSelector))},render:function render(){var template=Handlebars.templates["pageLevelProgress"];this.$el.html(template({}))},addChildren:function addChildren(){var $children=this.$(".js-children");this.collection.each(function(model){$children.append(new PageLevelProgressItemView({model:model}).$el)}.bind(this))}});return PageLevelProgressView});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView",["core/js/adapt","./completionCalculations","./PageLevelProgressView","./PageLevelProgressIndicatorView"],function(Adapt,completionCalculations,PageLevelProgressView,PageLevelProgressIndicatorView){var PageLevelProgressNavigationView=Backbone.View.extend({tagName:"button",className:"btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn",events:{"click":"onProgressClicked"},initialize:function initialize(){_.bindAll(this,"updateProgressBar");this.setUpEventListeners();this.render();this.addIndicator();this.deferredUpdate()},setUpEventListeners:function setUpEventListeners(){this.listenTo(Adapt,{"remove":this.remove,"router:location":this.updateProgressBar,"pageLevelProgress:update":this.refreshProgressBar})},render:function render(){var template=Handlebars.templates["pageLevelProgressNavigation"];this.$el.html(template({}))},addIndicator:function addIndicator(){this.indicatorView=new PageLevelProgressIndicatorView({model:this.model,collection:this.collection,calculatePercentage:this._getPageCompletionPercentage,ariaLabel:Adapt.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar});this.$el.prepend(this.indicatorView.$el)},_getPageCompletionPercentage:function _getPageCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)},deferredUpdate:function deferredUpdate(){_.defer(this.updateProgressBar)},updateProgressBar:function updateProgressBar(){this.indicatorView.refresh()},refreshProgressBar:function refreshProgressBar(){this.collection.repopulate();this.updateProgressBar()},onProgressClicked:function onProgressClicked(event){if(event&&event.preventDefault)event.preventDefault();Adapt.drawer.triggerCustomView(new PageLevelProgressView({collection:this.collection}).$el,false)},remove:function remove(){Backbone.View.prototype.remove.call(this);this.collection.reset()}});return PageLevelProgressNavigationView});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection",["core/js/adapt","./completionCalculations"],function(Adapt,completionCalculations){var PageLevelProgressCollection=Backbone.Collection.extend({initialize:function initialize(models,options){this.listenTo(Adapt,"remove",this.reset);if(!options||!options.pageModel)return;this._pageModel=options.pageModel;this.repopulate()},repopulate:function repopulate(){this.reset();if(!this._pageModel)return;var allDescendants=this._pageModel.getAllDescendantModels(true);var currentPageItems=allDescendants.filter(function(item){return item.get("_isAvailable")===true});var availableItems=completionCalculations.filterAvailableChildren(currentPageItems);var enabledProgressItems=completionCalculations.getPageLevelProgressEnabledModels(availableItems);this.add(enabledProgressItems)}});return PageLevelProgressCollection});define("extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress",["core/js/adapt","./completionCalculations","./PageLevelProgressNavigationView","./PageLevelProgressIndicatorView","./PageLevelProgressCollection"],function(Adapt,completionCalculations,PageLevelProgressNavigationView,PageLevelProgressIndicatorView,PageLevelProgressCollection){var PageLevelProgress=Backbone.Controller.extend({initialize:function initialize(){Adapt.on({"app:dataReady":this.onDataReady.bind(this),"app:languageChanged":function(){this.stopListening()}.bind(this)})},getCourseConfig:function getCourseConfig(){return Adapt.course.get("_pageLevelProgress")},onDataReady:function onDataReady(){var coursePLPConfig=this.getCourseConfig();if(!coursePLPConfig||!coursePLPConfig._isEnabled){return}this.setUpEventListeners()},setUpEventListeners:function setUpEventListeners(){var headerIndicatorTypes=["menu","menuItem","page","article","block","component"];var headerIndicatorEventNames=headerIndicatorTypes.concat([""]).join("View:render ");this.listenTo(Adapt,headerIndicatorEventNames,this.renderHeaderIndicatorView);this.listenTo(Adapt,{"menuItemView:postRender":this.renderMenuItemIndicatorView,"router:page":this.renderNavigationView});this.listenTo(Adapt.course,"bubble:change:_isComplete",this.onCompletionChange)},onCompletionChange:function onCompletionChange(event){if(!Adapt.location._currentId)return;var currentModel=Adapt.findById(Adapt.location._currentId);var completionState={currentLocation:completionCalculations.calculatePercentageComplete(currentModel),course:completionCalculations.calculatePercentageComplete(Adapt.course)};var hasChanged=!_.isMatch(this._previousCompletionState,completionState);if(!hasChanged)return;this._previousCompletionState=completionState;Adapt.trigger("pageLevelProgress:percentageCompleteChange",completionState)},renderHeaderIndicatorView:function renderHeaderIndicatorView(view){var model=view.model;var config=model.get("_pageLevelProgress");if(!config||!config._isEnabled||!config._isCompletionIndicatorEnabled){return}var pageModel=model.findAncestor("contentObjects");var pageConfig=pageModel&&pageModel.get("_pageLevelProgress");if(pageConfig&&!pageConfig._isEnabled){return}var $headings=view.$(".js-heading");$headings.each(function(index,el){var $el=$(el);var indicatorView=new PageLevelProgressIndicatorView({parent:view,model:model});indicatorView.$el.insertAfter($el)})},renderMenuItemIndicatorView:function renderMenuItemIndicatorView(view){if(view.model.get("_id")===Adapt.location._currentId){return}var viewType=view.model.get("_type");if(viewType==="course"){return}var pageLevelProgress=view.model.get("_pageLevelProgress");if(!pageLevelProgress||!pageLevelProgress._isEnabled){return}view.$el.find(".js-menu-item-progress").append(new PageLevelProgressIndicatorView({parent:view,model:view.model,type:"menu-item",calculatePercentage:this._getMenuItemCompletionPercentage.bind(view),ariaLabel:Adapt.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar}).$el)},_getMenuItemCompletionPercentage:function _getMenuItemCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)},renderNavigationView:function renderNavigationView(pageModel){var coursePLPConfig=this.getCourseConfig();if(coursePLPConfig&&coursePLPConfig._isShownInNavigationBar===false){return}var pagePLPConfig=pageModel.get("_pageLevelProgress");if(!pagePLPConfig||!pagePLPConfig._isEnabled){return}var collection=new PageLevelProgressCollection(null,{pageModel:pageModel});if(collection.length===0){return}$(".nav__drawer-btn").after(new PageLevelProgressNavigationView({model:pageModel,collection:collection}).$el)}});Adapt.pageLevelProgress=new PageLevelProgress});define("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView",["core/js/adapt"],function(Adapt){var ResourcesView=Backbone.View.extend({className:"resources",initialize:function initialize(){this.listenTo(Adapt,"remove",this.remove);this.render()},events:{"click .js-resources-filter-btn-click":"onFilterClicked"},render:function render(){this.$el.html(Handlebars.templates.resources({model:this.model.toJSON(),resources:this.collection.toJSON()}));_.defer(function(){this.listenTo(Adapt,"drawer:triggerCustomView",this.remove)}.bind(this));return this},onFilterClicked:function onFilterClicked(e){if(e&&e.preventDefault)e.preventDefault();this.$(".js-resources-filter-btn-click").removeClass("is-selected");var items;var filter=$(e.currentTarget).addClass("is-selected").attr("data-filter");if(filter==="all"){items=this.$(".js-resources-item").removeClass("u-display-none")}else{this.$(".js-resources-item").removeClass("u-display-none").not(".is-"+filter).addClass("u-display-none");items=this.$(".js-resources-item.is-"+filter)}if(items.length>0)$(items[0]).a11y_focus()}});return ResourcesView});define("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers",["handlebars","core/js/adapt"],function(Handlebars,Adapt){var helpers={resources_has_type:function resources_has_type(resources,type,block){var hasType=_.some(resources,_.matcher({_type:type}));return hasType?block.fn(this):block.inverse(this)},resources_has_multiple_types:function resources_has_multiple_types(resources,block){if(resources.length===1)return block.inverse(this);var allSameType=_.every(resources,_.matcher({_type:resources[0]._type}));return allSameType?block.inverse(this):block.fn(this)},resources_get_column_count:function resources_get_column_count(resources){return _.uniq(_.pluck(resources,"_type")).length+1},resources_force_download:function resources_force_download(resource,block){if(Adapt.device.browser==="internet explorer"||Adapt.device.OS==="ios"){return block.inverse(this)}return resource._forceDownload||resource.filename?block.fn(this):block.inverse(this)}};for(var name in helpers){if(helpers.hasOwnProperty(name)){Handlebars.registerHelper(name,helpers[name])}}});define("extensions/adapt-contrib-resources/js/adapt-contrib-resources",["core/js/adapt","./adapt-contrib-resourcesView","./adapt-contrib-resourcesHelpers"],function(Adapt,ResourcesView,ResourcesHelpers){function setupResources(resourcesData){var resourcesModel=new Backbone.Model(resourcesData);var resourcesCollection=new Backbone.Collection(resourcesModel.get("_resourcesItems"));Adapt.on("resources:showResources",function(){Adapt.drawer.triggerCustomView(new ResourcesView({model:resourcesModel,collection:resourcesCollection}).$el)})}function initResources(){var courseResources=Adapt.course.get("_resources");if(!courseResources||courseResources._isEnabled===false)return;var drawerObject={title:courseResources.title,description:courseResources.description,className:"is-resources",drawerOrder:courseResources._drawerOrder||0};Adapt.drawer.addItem(drawerObject,"resources:showResources");setupResources(courseResources)}Adapt.on("adapt:start",initResources)});define("extensions/adapt-contrib-spoor/js/scorm/wrapper",["libraries/SCORM_API_wrapper"],function(pipwerks){var ScormWrapper=function ScormWrapper(){this.setCompletedWhenFailed=true;this.commitOnStatusChange=true;this.timedCommitFrequency=10;this.maxCommitRetries=5;this.commitRetryDelay=1000;this.commitRetryPending=false;this.commitRetries=0;this.lastCommitSuccessTime=null;this.exitStateIfIncomplete="auto";this.exitStateIfComplete="auto";this.timedCommitIntervalID=null;this.retryCommitTimeoutID=null;this.logOutputWin=null;this.startTime=null;this.endTime=null;this.lmsConnected=false;this.finishCalled=false;this.logger=Logger.getInstance();this.scorm=pipwerks.SCORM;this.scorm.handleExitMode=false;this.suppressErrors=false;if(window.__debug)this.showDebugWindow();if(window.API&&window.API.__offlineAPIWrapper||window.API_1484_11&&window.API_1484_11.__offlineAPIWrapper)this.logger.error("Offline SCORM API is being used. No data will be reported to the LMS!")};ScormWrapper.instance=null;ScormWrapper.getInstance=function(){if(ScormWrapper.instance===null)ScormWrapper.instance=new ScormWrapper;return ScormWrapper.instance};ScormWrapper.prototype.getVersion=function(){return this.scorm.version};ScormWrapper.prototype.setVersion=function(value){this.logger.debug("ScormWrapper::setVersion: "+value);this.scorm.version=value};ScormWrapper.prototype.initialize=function(){this.logger.debug("ScormWrapper::initialize");this.lmsConnected=this.scorm.init();if(this.lmsConnected){this.startTime=new Date;this.initTimedCommit()}else{this.handleError("Course could not connect to the LMS")}return this.lmsConnected};ScormWrapper.prototype.isFirstSession=function(){return this.getValue(this.isSCORM2004()?"cmi.entry":"cmi.core.entry")==="ab-initio"};ScormWrapper.prototype.setIncomplete=function(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","incomplete");if(this.commitOnStatusChange)this.commit()};ScormWrapper.prototype.setCompleted=function(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","completed");if(this.commitOnStatusChange)this.commit()};ScormWrapper.prototype.setPassed=function(){if(this.isSCORM2004()){this.setValue("cmi.completion_status","completed");this.setValue("cmi.success_status","passed")}else{this.setValue("cmi.core.lesson_status","passed")}if(this.commitOnStatusChange)this.commit()};ScormWrapper.prototype.setFailed=function(){if(this.isSCORM2004()){this.setValue("cmi.success_status","failed");if(this.setCompletedWhenFailed){this.setValue("cmi.completion_status","completed")}}else{this.setValue("cmi.core.lesson_status","failed")}if(this.commitOnStatusChange)this.commit()};ScormWrapper.prototype.getStatus=function(){var status=this.getValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status");switch(status.toLowerCase()){case"passed":case"completed":case"incomplete":case"failed":case"browsed":case"not attempted":case"not_attempted":case"unknown":return status;default:this.handleError("ScormWrapper::getStatus: invalid lesson status '"+status+"' received from LMS");return null;}};ScormWrapper.prototype.setStatus=function(status){switch(status.toLowerCase()){case"incomplete":this.setIncomplete();break;case"completed":this.setCompleted();break;case"passed":this.setPassed();break;case"failed":this.setFailed();break;default:this.handleError("ScormWrapper::setStatus: the status '"+status+"' is not supported.");}};ScormWrapper.prototype.getScore=function(){return this.getValue(this.isSCORM2004()?"cmi.score.raw":"cmi.core.score.raw")};ScormWrapper.prototype.setScore=function(_score,_minScore,_maxScore){if(this.isSCORM2004()){this.setValue("cmi.score.raw",_score);this.setValue("cmi.score.min",_minScore);this.setValue("cmi.score.max",_maxScore);var range=_maxScore-_minScore;var scaledScore=((_score-_minScore)/range).toFixed(7);this.setValue("cmi.score.scaled",scaledScore)}else{this.setValue("cmi.core.score.raw",_score);if(this.isSupported("cmi.core.score.min"))this.setValue("cmi.core.score.min",_minScore);if(this.isSupported("cmi.core.score.max"))this.setValue("cmi.core.score.max",_maxScore)}};ScormWrapper.prototype.getLessonLocation=function(){return this.getValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location")};ScormWrapper.prototype.setLessonLocation=function(_location){this.setValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location",_location)};ScormWrapper.prototype.getSuspendData=function(){return this.getValue("cmi.suspend_data")};ScormWrapper.prototype.setSuspendData=function(_data){this.setValue("cmi.suspend_data",_data)};ScormWrapper.prototype.getStudentName=function(){return this.getValue(this.isSCORM2004()?"cmi.learner_name":"cmi.core.student_name")};ScormWrapper.prototype.getStudentId=function(){return this.getValue(this.isSCORM2004()?"cmi.learner_id":"cmi.core.student_id")};ScormWrapper.prototype.setLanguage=function(_lang){if(this.isSCORM2004()){this.setValue("cmi.learner_preference.language",_lang)}else{if(this.isSupported("cmi.student_preference.language")){this.setValue("cmi.student_preference.language",_lang)}}};ScormWrapper.prototype.commit=function(){this.logger.debug("ScormWrapper::commit");if(this.lmsConnected){if(this.commitRetryPending){this.logger.debug("ScormWrapper::commit: skipping this commit call as one is already pending.")}else{if(this.scorm.save()){this.commitRetries=0;this.lastCommitSuccessTime=new Date}else{if(this.commitRetries<this.maxCommitRetries&&!this.finishCalled){this.commitRetries++;this.initRetryCommit()}else{var _errorCode=this.scorm.debug.getCode();var _errorMsg="Course could not commit data to the LMS";_errorMsg+="\nError "+_errorCode+": "+this.scorm.debug.getInfo(_errorCode);_errorMsg+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(_errorCode);this.handleError(_errorMsg)}}}}else{this.handleError("Course is not connected to the LMS")}};ScormWrapper.prototype.finish=function(){this.logger.debug("ScormWrapper::finish");if(this.lmsConnected&&!this.finishCalled){this.finishCalled=true;if(this.timedCommitIntervalID!==null){window.clearInterval(this.timedCommitIntervalID)}if(this.commitRetryPending){window.clearTimeout(this.retryCommitTimeoutID);this.commitRetryPending=false}if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.endTime=new Date;if(this.isSCORM2004()){this.scorm.set("cmi.session_time",this.convertToSCORM2004Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.exit",this.getExitState())}else{this.scorm.set("cmi.core.session_time",this.convertToSCORM12Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.core.exit",this.getExitState())}this.lmsConnected=false;if(!this.scorm.quit()){this.handleError("Course could not finish")}}else{this.handleError("Course is not connected to the LMS")}};ScormWrapper.prototype.recordInteraction=function(id,response,correct,latency,type){if(this.isSupported("cmi.interactions._count")){switch(type){case"choice":this.recordInteractionMultipleChoice.apply(this,arguments);break;case"matching":this.recordInteractionMatching.apply(this,arguments);break;case"numeric":this.isSCORM2004()?this.recordInteractionScorm2004.apply(this,arguments):this.recordInteractionScorm12.apply(this,arguments);break;case"fill-in":this.recordInteractionFillIn.apply(this,arguments);break;default:console.error("ScormWrapper.recordInteraction: unknown interaction type of '"+type+"' encountered...");}}else{this.logger.info("ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...")}};ScormWrapper.prototype.getValue=function(_property){this.logger.debug("ScormWrapper::getValue: _property="+_property);if(this.finishCalled){this.logger.debug("ScormWrapper::getValue: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var _value=this.scorm.get(_property);var _errorCode=this.scorm.debug.getCode();var _errorMsg="";if(_errorCode!==0){if(_errorCode===403){this.logger.warn("ScormWrapper::getValue: data model element not initialized")}else{_errorMsg+="Course could not get "+_property;_errorMsg+="\nError Info: "+this.scorm.debug.getInfo(_errorCode);_errorMsg+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(_errorCode);this.handleError(_errorMsg)}}this.logger.debug("ScormWrapper::getValue: returning "+_value);return _value+""}else{this.handleError("Course is not connected to the LMS")}};ScormWrapper.prototype.setValue=function(_property,_value){this.logger.debug("ScormWrapper::setValue: _property="+_property+" _value="+_value);if(this.finishCalled){this.logger.debug("ScormWrapper::setValue: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var _success=this.scorm.set(_property,_value);var _errorCode=this.scorm.debug.getCode();var _errorMsg="";if(!_success){if(_errorCode!==0){_errorMsg+="Course could not set "+_property+" to "+_value;_errorMsg+="\nError Info: "+this.scorm.debug.getInfo(_errorCode);_errorMsg+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(_errorCode);this.handleError(_errorMsg)}else{this.logger.warn("ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!")}}return _success}else{this.handleError("Course is not connected to the LMS")}};ScormWrapper.prototype.isSupported=function(_property){this.logger.debug("ScormWrapper::isSupported: _property="+_property);if(this.finishCalled){this.logger.debug("ScormWrapper::isSupported: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var _value=this.scorm.get(_property);var _errorCode=this.scorm.debug.getCode();return _errorCode===401?false:true}else{this.handleError("Course is not connected to the LMS");return false}};ScormWrapper.prototype.initTimedCommit=function(){this.logger.debug("ScormWrapper::initTimedCommit");if(this.timedCommitFrequency>0){var delay=this.timedCommitFrequency*(60*1000);this.timedCommitIntervalID=window.setInterval(this.commit.bind(this),delay)}};ScormWrapper.prototype.initRetryCommit=function(){this.logger.debug("ScormWrapper::initRetryCommit "+this.commitRetries+" out of "+this.maxCommitRetries);this.commitRetryPending=true;this.retryCommitTimeoutID=window.setTimeout(this.doRetryCommit.bind(this),this.commitRetryDelay)};ScormWrapper.prototype.doRetryCommit=function(){this.logger.debug("ScormWrapper::doRetryCommit");this.commitRetryPending=false;this.commit()};ScormWrapper.prototype.handleError=function(_msg){this.logger.error(_msg);if(!this.suppressErrors&&(!this.logOutputWin||this.logOutputWin.closed)&&confirm("An error has occured:\n\n"+_msg+"\n\nPress 'OK' to view debug information to send to technical support."))this.showDebugWindow()};ScormWrapper.prototype.getInteractionCount=function(){var count=this.getValue("cmi.interactions._count");return count===""?0:count};ScormWrapper.prototype.recordInteractionScorm12=function(id,response,correct,latency,type){id=this.trim(id);var cmiPrefix="cmi.interactions."+this.getInteractionCount();this.setValue(cmiPrefix+".id",id);this.setValue(cmiPrefix+".type",type);this.setValue(cmiPrefix+".student_response",response);this.setValue(cmiPrefix+".result",correct?"correct":"wrong");if(latency!==null&&latency!==undefined)this.setValue(cmiPrefix+".latency",this.convertToSCORM12Time(latency));this.setValue(cmiPrefix+".time",this.getCMITime())};ScormWrapper.prototype.recordInteractionScorm2004=function(id,response,correct,latency,type){id=this.trim(id);var cmiPrefix="cmi.interactions."+this.getInteractionCount();this.setValue(cmiPrefix+".id",id);this.setValue(cmiPrefix+".type",type);this.setValue(cmiPrefix+".learner_response",response);this.setValue(cmiPrefix+".result",correct?"correct":"incorrect");if(latency!==null&&latency!==undefined)this.setValue(cmiPrefix+".latency",this.convertToSCORM2004Time(latency));this.setValue(cmiPrefix+".timestamp",this.getISO8601Timestamp())};ScormWrapper.prototype.recordInteractionMultipleChoice=function(id,response,correct,latency,type){if(this.isSCORM2004()){response=response.replace(/,|#/g,"[,]")}else{response=response.replace(/#/g,",");response=this.checkResponse(response,"choice")}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)};ScormWrapper.prototype.recordInteractionMatching=function(id,response,correct,latency,type){response=response.replace(/#/g,",");if(this.isSCORM2004()){response=response.replace(/,/g,"[,]");response=response.replace(/\./g,"[.]")}else{response=this.checkResponse(response,"matching")}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)};ScormWrapper.prototype.recordInteractionFillIn=function(id,response,correct,latency,type){var maxLength=this.isSCORM2004()?250:255;if(response.length>maxLength){response=response.substr(0,maxLength);this.logger.warn("ScormWrapper::recordInteractionFillIn: response data for "+id+" is longer than the maximum allowed length of "+maxLength+" characters; data will be truncated to avoid an error.")}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)};ScormWrapper.prototype.showDebugWindow=function(){if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.logOutputWin=window.open("log_output.html","Log","width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0");if(this.logOutputWin)this.logOutputWin.focus();return};ScormWrapper.prototype.convertToSCORM12Time=function(msConvert){var msPerSec=1000;var msPerMin=msPerSec*60;var msPerHour=msPerMin*60;var ms=msConvert%msPerSec;msConvert=msConvert-ms;var secs=msConvert%msPerMin;msConvert=msConvert-secs;secs=secs/msPerSec;var mins=msConvert%msPerHour;msConvert=msConvert-mins;mins=mins/msPerMin;var hrs=msConvert/msPerHour;if(hrs>9999){return"9999:99:99.99"}else{var str=[this.padWithZeroes(hrs,4),this.padWithZeroes(mins,2),this.padWithZeroes(secs,2)].join(":");return str+"."+Math.floor(ms/10)}};ScormWrapper.prototype.convertToSCORM2004Time=function(msConvert){var csConvert=Math.floor(msConvert/10);var csPerSec=100;var csPerMin=csPerSec*60;var csPerHour=csPerMin*60;var csPerDay=csPerHour*24;var days=Math.floor(csConvert/csPerDay);csConvert-=days*csPerDay;days=days?days+"D":"";var hours=Math.floor(csConvert/csPerHour);csConvert-=hours*csPerHour;hours=hours?hours+"H":"";var mins=Math.floor(csConvert/csPerMin);csConvert-=mins*csPerMin;mins=mins?mins+"M":"";var secs=Math.floor(csConvert/csPerSec);csConvert-=secs*csPerSec;secs=secs?secs:"0";var cs=csConvert;cs=cs?"."+cs:"";var seconds=secs+cs+"S";var hms=[hours,mins,seconds].join("");return"P"+days+"T"+hms};ScormWrapper.prototype.getCMITime=function(){var date=new Date;var hours=this.padWithZeroes(date.getHours(),2);var min=this.padWithZeroes(date.getMinutes(),2);var sec=this.padWithZeroes(date.getSeconds(),2);return[hours,min,sec].join(":")};ScormWrapper.prototype.getISO8601Timestamp=function(){var date=new Date().toISOString();return date.replace(/.\d\d\dZ/,"")};ScormWrapper.prototype.padWithZeroes=function(numToPad,padBy){var len=padBy;while(--len){numToPad="0"+numToPad}return numToPad.slice(-padBy)};ScormWrapper.prototype.trim=function(str){return str.replace(/^\s*|\s*$/g,"")};ScormWrapper.prototype.isSCORM2004=function(){return this.scorm.version==="2004"};ScormWrapper.prototype.checkResponse=function(response,responseType){if(!response)return response;if(responseType!="choice"&&responseType!="matching")return response;response=response.split(/,|#/);var self=this;if(responseType=="choice"){response=response.map(checkIdentifier)}else{response=response.map(function(r){var identifiers=r.split(".");return checkIdentifier(identifiers[0])+"."+checkIdentifier(identifiers[1])})}function checkIdentifier(r){var i;if(r.length==1&&r>="0"&&r<="9")return r;if(r.length==1&&r>="a"&&r<="z")return r;i=parseInt(r);if(isNaN(i)||i<10||i>35){self.handleError("Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2")}return Number(i).toString(36)}return response.join(",")};ScormWrapper.prototype.getExitState=function(){var completionStatus=this.scorm.data.completionStatus;var isIncomplete=completionStatus==="incomplete"||completionStatus==="not attempted";var exitState=isIncomplete?this.exitStateIfIncomplete:this.exitStateIfComplete;if(exitState!=="auto")return exitState;if(this.isSCORM2004())return isIncomplete?"suspend":"normal";return""};return ScormWrapper});Logger=function Logger(){this.logArr=[];this.registeredViews=[]};Logger.instance=null;Logger.LOG_TYPE_INFO=0;Logger.LOG_TYPE_WARN=1;Logger.LOG_TYPE_ERROR=2;Logger.LOG_TYPE_DEBUG=3;Logger.getInstance=function(){if(Logger.instance==null)Logger.instance=new Logger;return Logger.instance};Logger.prototype.getEntries=function(){return this.logArr};Logger.prototype.getLastEntry=function(){return this.logArr[this.logArr.length-1]};Logger.prototype.info=function(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_INFO,time:Date.now()};this.updateViews()};Logger.prototype.warn=function(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_WARN,time:Date.now()};this.updateViews()};Logger.prototype.error=function(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_ERROR,time:Date.now()};this.updateViews()};Logger.prototype.debug=function(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_DEBUG,time:Date.now()};this.updateViews()};Logger.prototype.registerView=function(_view){this.registeredViews[this.registeredViews.length]=_view};Logger.prototype.unregisterView=function(_view){for(var i=0;i<this.registeredViews.length;i++){if(this.registeredViews[i]==_view){this.registeredViews.splice(i,1);i--}}};Logger.prototype.updateViews=function(){for(var i=0;i<this.registeredViews.length;i++){if(this.registeredViews[i])this.registeredViews[i].update(this)}};define("extensions/adapt-contrib-spoor/js/scorm/logger",function(){});define("extensions/adapt-contrib-spoor/js/scorm",["libraries/SCORM_API_wrapper","./scorm/wrapper","./scorm/logger"],function(API,wrapper,logger){return wrapper.getInstance()});define("extensions/adapt-contrib-spoor/js/serializers/default",["core/js/adapt"],function(Adapt){var serializer={serialize:function serialize(){return this.serializeSaveState("_isComplete")},serializeSaveState:function serializeSaveState(attribute){if(Adapt.course.get("_latestTrackingId")===undefined){var message="This course is missing a latestTrackingID.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(message)}var excludeAssessments=Adapt.config.get("_spoor")&&Adapt.config.get("_spoor")._tracking&&Adapt.config.get("_spoor")._tracking._excludeAssessments;var data=[];var length=Adapt.course.get("_latestTrackingId")+1;for(var i=0;i<length;i++){data[i]="-"}_.each(Adapt.blocks.models,function(model,index){var _trackingId=model.get("_trackingId"),isPartOfAssessment=model.getParent().get("_assessment"),state=model.get(attribute)?1:0;if(excludeAssessments&&isPartOfAssessment){state=0}if(_trackingId===undefined){var message="Block '"+model.get("_id")+"' doesn't have a tracking ID assigned.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(message)}else{data[_trackingId]=state}},this);return data.join("")},deserialize:function deserialize(completion,callback){var syncIterations=1;var i=0,arr=this.deserializeSaveState(completion),len=arr.length;function step(){var state;for(var j=0,count=Math.min(syncIterations,len-i);j<count;i++,j++){state=arr[i];if(state===1){markBlockAsComplete(Adapt.blocks.findWhere({_trackingId:i}))}}i==len?callback():setTimeout(step)}function markBlockAsComplete(block){if(!block){return}block.getChildren().each(function(child){child.set("_isComplete",true)})}step()},deserializeSaveState:function deserializeSaveState(string){var completionArray=string.split("");for(var i=0;i<completionArray.length;i++){if(completionArray[i]==="-"){completionArray[i]=-1}else{completionArray[i]=parseInt(completionArray[i],10)}}return completionArray}};return serializer});(function(){var _this76=this;var ZeroString={};function makeZeroString(length){ZeroString[length]=ZeroString[length]||new Array(length+1).join("0");return ZeroString[length]}for(var _i8=1,l=64;_i8<=l;_i8++){makeZeroString(_i8)}function zeroPadRightToLength(string,length){var padLength=length-string.length;if(padLength>0){string+=makeZeroString(padLength)}return string}function zeroPadLeftToLength(string,length){var padLength=length-string.length;if(padLength>0){string=makeZeroString(padLength)+string}return string}function zeroPadRightToMultiple(string,multiple){var padLength=multiple-string.length%multiple;if(padLength!==multiple){string+=makeZeroString(padLength)}return string}function binaryToUnsignedInteger(binary,binaryLength){if(binaryLength===0){return 0}binary=zeroPadLeftToLength(binary,binaryLength);var integer=parseInt(binary.slice(0,binaryLength),2);return integer}function shiftUnsignedIntegerFromBinary(binary,binaryLength){if(binaryLength===0){return[0,binary]}binary=zeroPadLeftToLength(binary,binaryLength);var integer=parseInt(binary.slice(0,binaryLength),2);binary=binary.slice(binaryLength);return[integer,binary]}function shiftBinary(binary,binaryLength){if(binaryLength===0){return["",binary]}binary=zeroPadLeftToLength(binary,binaryLength);var shifted=binary.slice(0,binaryLength);binary=binary.slice(binaryLength);return[shifted,binary]}function unsignedIntegerToBinary(integer,binaryLength){if(binaryLength===0){return""}var binary=Math.abs(integer).toString(2);if(typeof binaryLength==="undefined"){return binary}var length=binary.length;if(length>binaryLength){throw new Error("Integer too big for specified binary length. integer: ".concat(integer," binarylen: ").concat(binaryLength))}binary=zeroPadLeftToLength(binary,binaryLength);return binary}function byteArrayToString(array){var arrayLength=array.length;var string=new Array(arrayLength);for(var _i9=0,_l=arrayLength;_i9<_l;_i9++){string[_i9]=String.fromCharCode(array[_i9])}string=string.join("");return string}function stringToByteArray(string){var stringLength=string.length;var array=new Array(stringLength);for(var _i10=0,_l2=stringLength;_i10<_l2;_i10++){array[_i10]=string.charCodeAt(_i10)}return array}var BYTE_BIT_LENGTH=8;function binaryToBase64(binary){binary=_.flatten(binary).join("");binary=zeroPadRightToMultiple(binary,BYTE_BIT_LENGTH);var bytesCount=binary.length/BYTE_BIT_LENGTH;var charCodes=new Array(bytesCount);for(var _i11=0,_l3=bytesCount;_i11<_l3;_i11++){var _shiftUnsignedInteger=shiftUnsignedIntegerFromBinary(binary,BYTE_BIT_LENGTH);var _shiftUnsignedInteger2=_slicedToArray(_shiftUnsignedInteger,2);charCodes[_i11]=_shiftUnsignedInteger2[0];binary=_shiftUnsignedInteger2[1]}var base64=btoa(byteArrayToString(charCodes));base64=base64.replace(/=/g,"");base64=base64.replace(/\+/g,"-");return base64}function base64ToBinary(base64){base64=base64.replace(/-/g,"+");var charCodes=stringToByteArray(atob(base64));var bytesCount=charCodes.length;var binary=new Array(bytesCount);for(var _i12=0,_l4=bytesCount;_i12<_l4;_i12++){binary[_i12]=unsignedIntegerToBinary(charCodes[_i12],BYTE_BIT_LENGTH)}binary=binary.join("");return binary}var logs={usedTypes:{},typeLengths:{},binarySamples:{}};var AbstractValueType=function(){"use strict";function AbstractValueType(options){_classCallCheck(this,AbstractValueType);Object.assign(this,options);this.binaryTypeLength=this.binaryType.length}_createClass(AbstractValueType,[{key:"log",value:function log(binary){var name=this.name;logs.usedTypes[name]=logs.usedTypes[name]||0;logs.usedTypes[name]++;logs.binarySamples[name]=logs.binarySamples[name]||[];logs.binarySamples[name].push(binary)}}]);return AbstractValueType}();;var FixedIntegerType=function(_AbstractValueType){"use strict";_inherits(FixedIntegerType,_AbstractValueType);var _super38=_createSuper(FixedIntegerType);function FixedIntegerType(options){var _this68;_classCallCheck(this,FixedIntegerType);_this68=_super38.call(this,options);_this68.esType="number";if(!_this68.valueBinaryLength){return _possibleConstructorReturn(_this68)}_this68.minValue=options.minValue||0;_this68.maxValue=options.maxValue||Math.pow(2,_this68.valueBinaryLength)-1;return _this68}_createClass(FixedIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var binary=unsignedIntegerToBinary(integer,this.valueBinaryLength);if(logStats){this.log(binary)}binary=[binary];return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var integer;var _shiftUnsignedInteger3=shiftUnsignedIntegerFromBinary(binary,this.valueBinaryLength);var _shiftUnsignedInteger4=_slicedToArray(_shiftUnsignedInteger3,2);integer=_shiftUnsignedInteger4[0];binary=_shiftUnsignedInteger4[1];return[integer,binary]}}]);return FixedIntegerType}(AbstractValueType);var FixedBooleanType=function(_FixedIntegerType){"use strict";_inherits(FixedBooleanType,_FixedIntegerType);var _super39=_createSuper(FixedBooleanType);function FixedBooleanType(options){var _this69;_classCallCheck(this,FixedBooleanType);options.valueBinaryLength=1;_this69=_super39.call(this,options);_this69.esType="boolean";return _this69}_createClass(FixedBooleanType,[{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var bool=binary[0]==="1";binary=binary.slice(1);return[bool,binary]}}]);return FixedBooleanType}(FixedIntegerType);var LengthAndValueBinary=function(){"use strict";function LengthAndValueBinary(parent,name,bitSizes){var _this70=this;_classCallCheck(this,LengthAndValueBinary);this.parent=parent;this.name=name;this.bitSizes=bitSizes;this.maxValues=_.flatten(this.bitSizes).map(function(value){_newArrowCheck(this,_this70);return Math.pow(2,value)-1}.bind(this));this.maxValue=this.maxValues[this.maxValues.length-1];this.sizeBinaryLength=unsignedIntegerToBinary(this.bitSizes.length-1).length}_createClass(LengthAndValueBinary,[{key:"valueToBinary",value:function valueToBinary(integer){var _this71=this;var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var parentName=this.parent.name;var sizeIndex=this.maxValues.findIndex(function(maxValue){_newArrowCheck(this,_this71);return integer<=maxValue}.bind(this));if(sizeIndex===-1){throw new Error("Value is too large for type: ".concat(parentName," value: ").concat(integer," max: ").concat(this.maxValue))}var sizeBinary=unsignedIntegerToBinary(sizeIndex,this.sizeBinaryLength);var valueLength=this.bitSizes[sizeIndex];var name=this.name;if(logStats){logs.typeLengths[parentName]=logs.typeLengths[parentName]||{};logs.typeLengths[parentName][name]=logs.typeLengths[parentName][name]||{};logs.typeLengths[parentName][name][valueLength]=logs.typeLengths[parentName][name][valueLength]||0;logs.typeLengths[parentName][name][valueLength]++}var integerBinary=unsignedIntegerToBinary(integer,valueLength);var binary=[sizeBinary,integerBinary];return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var sizeBinary;var _shiftBinary=shiftBinary(binary,this.sizeBinaryLength);var _shiftBinary2=_slicedToArray(_shiftBinary,2);sizeBinary=_shiftBinary2[0];binary=_shiftBinary2[1];var sizeIndex=binaryToUnsignedInteger(sizeBinary);var valueLength=this.bitSizes[sizeIndex];var integer;var _shiftUnsignedInteger5=shiftUnsignedIntegerFromBinary(binary,valueLength);var _shiftUnsignedInteger6=_slicedToArray(_shiftUnsignedInteger5,2);integer=_shiftUnsignedInteger6[0];binary=_shiftUnsignedInteger6[1];return[integer,binary]}}]);return LengthAndValueBinary}();var VariableIntegerType=function(_FixedIntegerType2){"use strict";_inherits(VariableIntegerType,_FixedIntegerType2);var _super40=_createSuper(VariableIntegerType);function VariableIntegerType(options){var _this72;_classCallCheck(this,VariableIntegerType);_this72=_super40.call(this,options);_this72.isNegative=_this72.minValue<0&&_this72.maxValue===0;_this72.integer=new LengthAndValueBinary(_assertThisInitialized(_this72),"integer",options.integerBitSizes);return _this72}_createClass(VariableIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);var binary=this.integer.valueToBinary(Math.abs(integer),logStats);if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var integer;var _this$integer$shiftVa=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa2=_slicedToArray(_this$integer$shiftVa,2);integer=_this$integer$shiftVa2[0];binary=_this$integer$shiftVa2[1];if(this.isNegative){integer=-integer}return[integer,binary]}}]);return VariableIntegerType}(FixedIntegerType);var VariableArrayType=function(_VariableIntegerType){"use strict";_inherits(VariableArrayType,_VariableIntegerType);var _super41=_createSuper(VariableArrayType);function VariableArrayType(options){var _this73;_classCallCheck(this,VariableArrayType);_this73=_super41.call(this,options);_this73.esType="array";return _this73}_createClass(VariableArrayType,[{key:"valueToBinary",value:function valueToBinary(array){var _this74=this;var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var arrayLength=array.length;var binary=_get(_getPrototypeOf(VariableArrayType.prototype),"valueToBinary",this).call(this,arrayLength);if(arrayLength){var valueType=findValueTypeFromValues(array);binary.push(valueType.binaryType);binary.type=valueType.name;binary.push(array.map(function(value){_newArrowCheck(this,_this74);return valueType.valueToBinary(value,logStats)}.bind(this)))}if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var arrayLength;var _get$call=_get(_getPrototypeOf(VariableArrayType.prototype),"shiftValueFromBinary",this).call(this,binary);var _get$call2=_slicedToArray(_get$call,2);arrayLength=_get$call2[0];binary=_get$call2[1];var value=new Array(arrayLength);if(arrayLength){var valueType;var _shiftValueTypeFromBi=shiftValueTypeFromBinary(binary);var _shiftValueTypeFromBi2=_slicedToArray(_shiftValueTypeFromBi,2);valueType=_shiftValueTypeFromBi2[0];binary=_shiftValueTypeFromBi2[1];for(var _i13=0,_l5=arrayLength;_i13<_l5;_i13++){var _valueType$shiftValue=valueType.shiftValueFromBinary(binary);var _valueType$shiftValue2=_slicedToArray(_valueType$shiftValue,2);value[_i13]=_valueType$shiftValue2[0];binary=_valueType$shiftValue2[1]}}return[value,binary]}}]);return VariableArrayType}(VariableIntegerType);var VariableSignedIntegerType=function(_VariableIntegerType2){"use strict";_inherits(VariableSignedIntegerType,_VariableIntegerType2);var _super42=_createSuper(VariableSignedIntegerType);function VariableSignedIntegerType(){_classCallCheck(this,VariableSignedIntegerType);return _super42.apply(this,arguments)}_createClass(VariableSignedIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);var isNegative=integer<0;var signBinary=isNegative?"1":"0";var integerBinary=this.integer.valueToBinary(Math.abs(integer),logStats);var binary=[signBinary,integerBinary];if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var isNegative;var _shiftUnsignedInteger7=shiftUnsignedIntegerFromBinary(binary,1);var _shiftUnsignedInteger8=_slicedToArray(_shiftUnsignedInteger7,2);isNegative=_shiftUnsignedInteger8[0];binary=_shiftUnsignedInteger8[1];var integer;var _this$integer$shiftVa3=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa4=_slicedToArray(_this$integer$shiftVa3,2);integer=_this$integer$shiftVa4[0];binary=_this$integer$shiftVa4[1];if(isNegative){integer=-integer}return[integer,binary]}}]);return VariableSignedIntegerType}(VariableIntegerType);var VariableDecimalType=function(_VariableIntegerType3){"use strict";_inherits(VariableDecimalType,_VariableIntegerType3);var _super43=_createSuper(VariableDecimalType);function VariableDecimalType(options){var _this75;_classCallCheck(this,VariableDecimalType);_this75=_super43.call(this,options);_this75.isFloat=true;_this75.decimal=new LengthAndValueBinary(_assertThisInitialized(_this75),"decimal",options.decimalBitSizes);return _this75}_createClass(VariableDecimalType,[{key:"valueToBinary",value:function valueToBinary(float){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;float=float.toFixed(2);var isNegative=float<0;float=Math.abs(float);var parts=String(float).split(".");var higherInteger=parseInt(parts[0]);var lowerInteger=parseInt(zeroPadRightToLength(parts[1]||0,2));var signBinary=isNegative?"1":"0";var integerValueBinary=this.integer.valueToBinary(higherInteger,logStats);var decimalValueBinary=this.decimal.valueToBinary(lowerInteger,logStats);var binary=[signBinary,integerValueBinary,decimalValueBinary];if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var isNegative;var _shiftUnsignedInteger9=shiftUnsignedIntegerFromBinary(binary,1);var _shiftUnsignedInteger10=_slicedToArray(_shiftUnsignedInteger9,2);isNegative=_shiftUnsignedInteger10[0];binary=_shiftUnsignedInteger10[1];var higherInteger;var _this$integer$shiftVa5=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa6=_slicedToArray(_this$integer$shiftVa5,2);higherInteger=_this$integer$shiftVa6[0];binary=_this$integer$shiftVa6[1];var lowerInteger;var _this$decimal$shiftVa=this.decimal.shiftValueFromBinary(binary);var _this$decimal$shiftVa2=_slicedToArray(_this$decimal$shiftVa,2);lowerInteger=_this$decimal$shiftVa2[0];binary=_this$decimal$shiftVa2[1];lowerInteger=zeroPadLeftToLength(String(lowerInteger),2);var float=parseFloat(higherInteger+"."+lowerInteger);if(isNegative){float=-float}return[float,binary]}}]);return VariableDecimalType}(VariableIntegerType);var arrayType=new VariableArrayType({name:"array",binaryType:"10",integerBitSizes:[4,16]});var booleanType=new FixedBooleanType({name:"boolean",binaryType:"0"});var integerTypes=[new FixedIntegerType({name:"uint3",binaryType:"1110",valueBinaryLength:3}),new VariableIntegerType({name:"vint8+",binaryType:"110",minValue:0,maxValue:255,integerBitSizes:[2,8]}),new VariableIntegerType({name:"vint8-",binaryType:"111100",minValue:-255,maxValue:0,integerBitSizes:[2,8]}),new VariableSignedIntegerType({name:"sint32",binaryType:"111110",minValue:-4294967295,maxValue:4294967295,integerBitSizes:[2,4,16,32]})];var decimalTypes=[new VariableDecimalType({name:"sdec15",binaryType:"111101",minValue:-255.99,maxValue:255.99,integerBitSizes:[2,8],decimalBitSizes:[0,7]}),new VariableDecimalType({name:"sdec39",binaryType:"111111",minValue:-4294967295.99,maxValue:4294967295.99,integerBitSizes:[2,4,16,32],decimalBitSizes:[0,7]})];var ValueTypes=[booleanType,arrayType].concat(integerTypes).concat(decimalTypes);ValueTypes.nameIndex={};ValueTypes.forEach(function(valueType){_newArrowCheck(this,_this76);return ValueTypes.nameIndex[valueType.name]=valueType}.bind(this));function esTypeOf(value){if(Array.isArray(value)){return"array"}if(value===null){return"null"}return _typeof(value)}function findValueTypeFromName(name){return ValueTypes.nameIndex[name.toLowerCase()]}function findValueTypeFromValue(value){var _this77=this;var esType=esTypeOf(value);switch(esType){case"array":return arrayType;case"boolean":return booleanType;}value=value.toFixed(2);var isFloat=!Number.isInteger(value);var isValueInValueTypeRange=function isValueInValueTypeRange(valueType){_newArrowCheck(this,_this77);return value>=valueType.minValue&&value<=valueType.maxValue}.bind(this);var valueType=isFloat?decimalTypes.find(isValueInValueTypeRange):integerTypes.find(isValueInValueTypeRange);if(!valueType){throw new Error("Cannot find type from value: ".concat(value))}return valueType}function findValueTypeFromValues(values){var _this78=this;if(!values.length){return}var minValue=0;var maxValue=0;var isFloat=false;var esTypes=values.map(function(value){_newArrowCheck(this,_this78);var valueType=findValueTypeFromValue(value,isFloat);if(valueType.esType==="number"){minValue=_.min([value,minValue]);maxValue=_.max([value,maxValue]);isFloat=isFloat||!Number.isInteger(value)}return valueType.esType}.bind(this));var uniqESTypes=_.uniq(esTypes);if(uniqESTypes.length>1){throw new Error("Cannot resolve array to one type: ".concat(uniqESTypes.join()))}var esType=uniqESTypes[0];switch(esType){case"array":return arrayType;case"boolean":return booleanType;}var isRangeInValueTypeRange=function isRangeInValueTypeRange(valueType){_newArrowCheck(this,_this78);return minValue>=valueType.minValue&&maxValue<=valueType.maxValue}.bind(this);var valueType=isFloat?decimalTypes.find(isRangeInValueTypeRange):integerTypes.find(isRangeInValueTypeRange);if(!valueType){throw new Error("Cannot find type from value. min: ".concat(minValue," max: ").concat(maxValue," isfloat: ").concat(isFloat))}return valueType}function shiftValueTypeFromBinary(binary){var _this79=this;var valueType=ValueTypes.find(function(valueType){_newArrowCheck(this,_this79);var binaryType=binary.slice(0,valueType.binaryTypeLength);return binaryType===valueType.binaryType}.bind(this));if(!valueType){throw new Error("Cannot find type from binary: ".concat(binary.slice(0,6),"..."))}binary=binary.slice(valueType.binaryTypeLength);return[valueType,binary]}function convertValuesToNumbers(value){var esType=esTypeOf(value);switch(esType){case"array":return value.map(convertValuesToNumbers);case"undefined":case"null":return value?1:0;case"boolean":case"number":return value;}throw new Error("Cannot convert ".concat(esType," to number"))}var Converter=function(){"use strict";function Converter(){_classCallCheck(this,Converter)}_createClass(Converter,[{key:"getInvalidTypeError",value:function getInvalidTypeError(value){try{value=convertValuesToNumbers(value);esTypeOf(value)==="array"?findValueTypeFromValues(value):findValueTypeFromValue(value);return}catch(err){return err}}},{key:"valueToBinary",value:function valueToBinary(value){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this.clearLog();var hasInitialType=typeof typeName==="string";value=convertValuesToNumbers(value);var valueType=hasInitialType?findValueTypeFromName(typeName):findValueTypeFromValue(value);if(!valueType){throw new Error("Could not find value type from ".concat(hasInitialType?"name ".concat(typeName):"value ".concat(value)," accepts: ").concat(Object.keys(ValueTypes.nameIndex),". Leave typeName empty for auto-detect."))}var binary=valueType.valueToBinary(value,logStats);if(!hasInitialType){binary.unshift(valueType.binaryType)}if(logStats){this.printLog()}return binary}},{key:"valueFromBinary",value:function valueFromBinary(binary){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;binary=_.flatten(binary).join("");var hasInitialType=typeof typeName==="string";var valueType;if(hasInitialType){valueType=findValueTypeFromName(typeName)}else{var _shiftValueTypeFromBi3=shiftValueTypeFromBinary(binary);var _shiftValueTypeFromBi4=_slicedToArray(_shiftValueTypeFromBi3,2);valueType=_shiftValueTypeFromBi4[0];binary=_shiftValueTypeFromBi4[1]}if(!valueType||!(valueType instanceof AbstractValueType)){throw new Error("Could not find value type from ".concat(hasInitialType?"name \"".concat(typeName,"\""):"binary \"".concat(binary.slice(0,8),"\"...")," accepts: ").concat(Object.keys(ValueTypes.nameIndex),". Leave typeName empty for auto-detect."))}var _valueType$shiftValue3=valueType.shiftValueFromBinary(binary),_valueType$shiftValue4=_slicedToArray(_valueType$shiftValue3,1),value=_valueType$shiftValue4[0];return value}},{key:"clearLog",value:function clearLog(){logs.usedTypes={};logs.typeLengths={};logs.binarySamples={}}},{key:"printLog",value:function printLog(){console.log("Types used count:",logs.usedTypes);console.log("Type lengths used count:",logs.typeLengths);console.log("Type binary samples:",logs.binarySamples)}},{key:"serialize",value:function serialize(value){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var binary=this.valueToBinary(value,typeName,logStats);var base64=binaryToBase64(binary);return base64}},{key:"deserialize",value:function deserialize(base64){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var binary=base64ToBinary(base64);var value=this.valueFromBinary(binary,typeName);return value}}]);return Converter}();window.SCORMSuspendData=new Converter})();define("extensions/adapt-contrib-spoor/js/serializers/scormSuspendDataSerializer",function(){});define("extensions/adapt-contrib-spoor/js/serializers/questions",["core/js/adapt","./scormSuspendDataSerializer"],function(Adapt){var includes={"_isQuestionType":true};var serializer={serialize:function serialize(){return this.serializeSaveState()},serializeSaveState:function serializeSaveState(){if(Adapt.course.get("_latestTrackingId")===undefined){var message="This course is missing a latestTrackingID.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(message);return""}var rtn="";try{var data=this.captureData();if(data.length===0)return"";rtn=SCORMSuspendData.serialize(data)}catch(e){console.error(e)}return rtn},captureData:function captureData(){var _this80=this;var data=[];var trackingIds=Adapt.blocks.pluck("_trackingId").filter(function(id){_newArrowCheck(this,_this80);return Number.isInteger(id)&&id>=0}.bind(this));var blocks={};var countInBlock={};var config=Adapt.config.get("_spoor");var shouldStoreAttempts=config&&config._tracking&&config._tracking._shouldStoreAttempts;for(var i=0,l=trackingIds.length;i<l;i++){var trackingId=trackingIds[i];var blockModel=Adapt.blocks.findWhere({_trackingId:trackingId});var componentModels=blockModel.getChildren().where(includes);for(var c=0,cl=componentModels.length;c<cl;c++){var component=componentModels[c].toJSON();var blockId=component._parentId;if(!blocks[blockId]){blocks[blockId]=blockModel.toJSON()}var block=blocks[blockId];if(countInBlock[blockId]===undefined)countInBlock[blockId]=-1;countInBlock[blockId]++;var blockLocation=countInBlock[blockId];var hasUserAnswer=component._userAnswer!==undefined;var isUserAnswerArray=Array.isArray(component._userAnswer);if(hasUserAnswer&&isUserAnswerArray&&component._userAnswer.length===0){hasUserAnswer=false;isUserAnswerArray=false}var hasAttemptStates=component._attemptStates!==undefined;var isAttemptStatesArray=Array.isArray(component._attemptStates);if(hasAttemptStates&&isAttemptStatesArray&&component._attemptStates.length===0){hasAttemptStates=false;isAttemptStatesArray=false}var numericParameters=[blockLocation,block._trackingId,component._score||0,component._attemptsLeft||0];var booleanParameters=[hasUserAnswer,isUserAnswerArray,hasAttemptStates,isAttemptStatesArray,component._isComplete,component._isInteractionComplete,component._isSubmitted,component._isCorrect||false];var dataItem=[numericParameters,booleanParameters];var invalidError;if(hasUserAnswer){var userAnswer=isUserAnswerArray?component._userAnswer:[component._userAnswer];invalidError=SCORMSuspendData.getInvalidTypeError(userAnswer);if(invalidError){console.log("Cannot store _userAnswers from component "+component._id+" as array is invalid",invalidError);continue}dataItem.push(userAnswer)}else{dataItem.push([])}if(shouldStoreAttempts&&hasAttemptStates){var attemptStates=isAttemptStatesArray?component._attemptStates:[component_attemptStates];invalidError=SCORMSuspendData.getInvalidTypeError(userAnswer);if(invalidError){console.log("Cannot store _attemptStates from component ".concat(component._id," as array is invalid"),invalidError);continue}dataItem.push(attemptStates)}else{dataItem.push([])}data.push(dataItem)}}return data},deserialize:function deserialize(str){try{var data=SCORMSuspendData.deserialize(str);this.releaseData(data)}catch(e){console.error(e)}},releaseData:function releaseData(arr){var config=Adapt.config.get("_spoor");var shouldStoreAttempts=config&&config._tracking&&config._tracking._shouldStoreAttempts;for(var i=0,l=arr.length;i<l;i++){var dataItem=arr[i];var numericParameters=dataItem[0];var booleanParameters=dataItem[1];var blockLocation=numericParameters[0];var trackingId=numericParameters[1];var _score=numericParameters[2];var _attemptsLeft=numericParameters[3]||0;var hasUserAnswer=booleanParameters[0];var isUserAnswerArray=booleanParameters[1];var hasAttemptStates=booleanParameters[2];var isAttemptStatesArray=booleanParameters[3];var _isComplete=booleanParameters[4];var _isInteractionComplete=booleanParameters[5];var _isSubmitted=booleanParameters[6];var _isCorrect=booleanParameters[7];var block=Adapt.blocks.findWhere({_trackingId:trackingId});var components=block.getChildren();components=components.where(includes);var component=components[blockLocation];component.set({_isComplete:_isComplete,_isInteractionComplete:_isInteractionComplete,_isSubmitted:_isSubmitted,_score:_score,_isCorrect:_isCorrect,_attemptsLeft:_attemptsLeft});if(hasUserAnswer){var userAnswer=dataItem[2];if(!isUserAnswerArray)userAnswer=userAnswer[0];component.set("_userAnswer",userAnswer)}if(shouldStoreAttempts&&hasAttemptStates){var attemptStates=dataItem[3];if(!isAttemptStatesArray)attemptStates=attemptStates[0];component.set("_attemptStates",attemptStates)}}}};return serializer});define("extensions/adapt-contrib-spoor/js/adapt-stateful-session",["core/js/adapt","./serializers/default","./serializers/questions","core/js/enums/completionStateEnum"],function(Adapt,serializer,questions,COMPLETION_STATE){var AdaptStatefulSession=_.extend({_config:null,_shouldStoreResponses:true,_shouldRecordInteractions:true,initialize:function initialize(callback){this._onWindowUnload=this.onWindowUnload.bind(this);this.getConfig();this.getLearnerInfo();this.restoreSessionState(function(){_.defer(this.setupEventListeners.bind(this));callback()}.bind(this))},getConfig:function getConfig(){this._config=Adapt.config.has("_spoor")?Adapt.config.get("_spoor"):false;this._shouldStoreResponses=this._config&&this._config._tracking&&this._config._tracking._shouldStoreResponses;if(this._config&&this._config._tracking&&this._config._tracking._shouldRecordInteractions===false){this._shouldRecordInteractions=false}},getLearnerInfo:function getLearnerInfo(){var globals=Adapt.course.get("_globals");if(!globals._learnerInfo){globals._learnerInfo={}}_.extend(globals._learnerInfo,Adapt.offlineStorage.get("learnerinfo"))},saveSessionState:function saveSessionState(){var sessionPairs=this.getSessionState();Adapt.offlineStorage.set(sessionPairs)},restoreSessionState:function restoreSessionState(callback){var sessionPairs=Adapt.offlineStorage.get();var hasNoPairs=_.keys(sessionPairs).length===0;var courseState;var doSynchronousPart=function(){if(sessionPairs.q&&this._shouldStoreResponses)questions.deserialize(sessionPairs.q);if(courseState)Adapt.course.set("_isComplete",courseState[0]);if(courseState)Adapt.course.set("_isAssessmentPassed",courseState[1]);callback()}.bind(this);if(hasNoPairs)return callback();if(sessionPairs.c){courseState=SCORMSuspendData.deserialize(sessionPairs.c)}if(courseState){serializer.deserialize(courseState.slice(2).map(Number).map(String).join(""),doSynchronousPart)}else{doSynchronousPart()}},getSessionState:function getSessionState(){var blockCompletion=serializer.serialize();var courseComplete=Adapt.course.get("_isComplete")||false;var assessmentPassed=Adapt.course.get("_isAssessmentPassed")||false;Adapt.log.info("course._isComplete: ".concat(courseComplete,", course._isAssessmentPassed: ").concat(assessmentPassed,", BlockCompletion: ").concat(blockCompletion));var courseState=SCORMSuspendData.serialize([courseComplete,assessmentPassed].concat(_toConsumableArray(blockCompletion.split("").map(Number).map(Boolean))));var sessionPairs={"c":courseState,"q":this._shouldStoreResponses===true?questions.serialize():""};return sessionPairs},setupEventListeners:function setupEventListeners(){$(window).on("beforeunload unload",this._onWindowUnload);if(this._shouldStoreResponses){this.listenTo(Adapt.components,"change:_isSubmitted",_.debounce(this.saveSessionState.bind(this),1))}if(this._shouldRecordInteractions){this.listenTo(Adapt,"questionView:recordInteraction",this.onQuestionRecordInteraction)}this.listenTo(Adapt.blocks,"change:_isComplete",this.onBlockComplete);this.listenTo(Adapt,{"assessment:complete":this.onAssessmentComplete,"app:languageChanged":this.onLanguageChanged,"tracking:complete":this.onTrackingComplete});this.listenTo(Adapt.course,"change:_isComplete",this.saveSessionState)},removeEventListeners:function removeEventListeners(){$(window).off("beforeunload unload",this._onWindowUnload);this.stopListening()},reattachEventListeners:function reattachEventListeners(){this.removeEventListeners();this.setupEventListeners()},onBlockComplete:function onBlockComplete(block){this.saveSessionState()},onTrackingComplete:function onTrackingComplete(completionData){this.saveSessionState();var completionStatus=completionData.status.asLowerCase;switch(completionData.status){case COMPLETION_STATE.COMPLETED:case COMPLETION_STATE.PASSED:{if(!this._config._reporting._onTrackingCriteriaMet){Adapt.log.warn("No value defined for '_onTrackingCriteriaMet', so defaulting to '"+completionStatus+"'")}else{completionStatus=this._config._reporting._onTrackingCriteriaMet}break}case COMPLETION_STATE.FAILED:{if(!this._config._reporting._onAssessmentFailure){Adapt.log.warn("No value defined for '_onAssessmentFailure', so defaulting to '"+completionStatus+"'")}else{completionStatus=this._config._reporting._onAssessmentFailure}}}Adapt.offlineStorage.set("status",completionStatus)},onAssessmentComplete:function onAssessmentComplete(stateModel){Adapt.course.set("_isAssessmentPassed",stateModel.isPass);this.saveSessionState();this.submitScore(stateModel)},onQuestionRecordInteraction:function onQuestionRecordInteraction(questionView){var responseType=questionView.getResponseType();if(_.isEmpty(responseType))return;var id=questionView.model.get("_id");var response=questionView.getResponse();var result=questionView.isCorrect();var latency=questionView.getLatency();Adapt.offlineStorage.set("interaction",id,response,result,latency,responseType)},onLanguageChanged:function onLanguageChanged(){this.reattachEventListeners();this.saveSessionState();if(this._config._reporting&&this._config._reporting._resetStatusOnLanguageChange===true){Adapt.offlineStorage.set("status","incomplete")}},submitScore:function submitScore(stateModel){if(this._config&&!this._config._tracking._shouldSubmitScore)return;if(stateModel.isPercentageBased){Adapt.offlineStorage.set("score",stateModel.scoreAsPercent,0,100)}else{Adapt.offlineStorage.set("score",stateModel.score,0,stateModel.maxScore)}},onWindowUnload:function onWindowUnload(){this.removeEventListeners()}},Backbone.Events);return AdaptStatefulSession});define("extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm",["core/js/adapt","./scorm","core/js/offlineStorage","./adapt-stateful-session"],function(Adapt,scorm,AdaptStatefulSession){var temporaryStore={};var suspendDataStore={};var suspendDataRestored=false;Adapt.offlineStorage.initialize({save:function save(){AdaptStatefulSession.saveSessionState()},serialize:SCORMSuspendData.serialize.bind(SCORMSuspendData),deserialize:SCORMSuspendData.deserialize.bind(SCORMSuspendData),get:function get(name){if(name===undefined){if(this.useTemporaryStore())return temporaryStore;suspendDataStore=this.getCustomStates();var data=_.extend(_.clone(suspendDataStore),{location:scorm.getLessonLocation(),score:scorm.getScore(),status:scorm.getStatus(),student:scorm.getStudentName(),learnerInfo:this.getLearnerInfo()});suspendDataRestored=true;return data}if(this.useTemporaryStore())return temporaryStore[name];var courseState;switch(name.toLowerCase()){case"location":return scorm.getLessonLocation();case"score":return scorm.getScore();case"status":return scorm.getStatus();case"student":return scorm.getStudentName();case"learnerinfo":return this.getLearnerInfo();case"coursestate":courseState=this.getCustomState("c");var stateArray=courseState&&SCORMSuspendData.deserialize(courseState)||[];return{_isCourseComplete:Boolean(stateArray.slice(0,1).map(Number)[0]),_isAssessmentPassed:Boolean(stateArray.slice(1,2).map(Number)[0]),completion:stateArray.slice(2).map(Number).map(String).join("")||""};case"completion":courseState=this.getCustomState("c");return courseState&&SCORMSuspendData.deserialize(courseState).slice(2).map(Number).map(String).join("")||"";case"_iscoursecomplete":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(0,1).map(Number)[0]);case"_isassessmentpassed":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(1,2).map(Number)[0]);case"questions":var questionsState=this.getCustomState("q");return questionsState||"";default:return this.getCustomState(name);}},set:function set(name,value){var args=[].slice.call(arguments,1);var isObject=_typeof(name)=="object";if(isObject){value=name;name="suspendData"}if(this.useTemporaryStore()){if(isObject){temporaryStore=_.extend(temporaryStore,value)}else{temporaryStore[name]=value}return true}switch(name.toLowerCase()){case"interaction":return scorm.recordInteraction.apply(scorm,args);case"location":return scorm.setLessonLocation.apply(scorm,args);case"score":return scorm.setScore.apply(scorm,args);case"status":return scorm.setStatus.apply(scorm,args);case"student":case"learnerinfo":return false;case"lang":scorm.setLanguage(value);case"suspenddata":default:if(isObject){suspendDataStore=_.extend(suspendDataStore,value)}else{suspendDataStore[name]=value}var dataAsString=JSON.stringify(suspendDataStore);return suspendDataRestored?scorm.setSuspendData(dataAsString):false;}},getCustomStates:function getCustomStates(){var isSuspendDataStoreEmpty=_.isEmpty(suspendDataStore);if(!isSuspendDataStoreEmpty&&suspendDataRestored)return _.clone(suspendDataStore);var dataAsString=scorm.getSuspendData();if(dataAsString===""||dataAsString===" "||dataAsString===undefined)return{};var dataAsJSON=JSON.parse(dataAsString);if(!isSuspendDataStoreEmpty&&!suspendDataRestored)dataAsJSON=_.extend(dataAsJSON,suspendDataStore);return dataAsJSON},getCustomState:function getCustomState(name){var dataAsJSON=this.getCustomStates();return dataAsJSON[name]},useTemporaryStore:function useTemporaryStore(){var cfg=Adapt.config.get("_spoor");if(!scorm.lmsConnected||cfg&&cfg._isEnabled===false)return true;return false},getLearnerInfo:function getLearnerInfo(){var name=scorm.getStudentName();var firstname="",lastname="";if(name&&name!=="undefined"&&name.indexOf(",")>-1){var nameSplit=name.split(",");lastname=$.trim(nameSplit[0]);firstname=$.trim(nameSplit[1]);name=firstname+" "+lastname}else{console.log("SPOOR: LMS learner_name not in 'lastname, firstname' format")}return{name:name,lastname:lastname,firstname:firstname,id:scorm.getStudentId()}}})});define("extensions/adapt-contrib-spoor/js/adapt-contrib-spoor",["core/js/adapt","./scorm","./adapt-stateful-session","./adapt-offlineStorage-scorm"],function(Adapt,scorm,adaptStatefulSession){var Spoor=_.extend({_config:null,initialize:function initialize(){this.listenToOnce(Adapt,{"offlineStorage:prepare":this.onPrepareOfflineStorage,"app:dataReady":function appDataReady(){Adapt.wait.for(adaptStatefulSession.initialize.bind(adaptStatefulSession))}})},onPrepareOfflineStorage:function onPrepareOfflineStorage(){if(!this.checkConfig()){Adapt.offlineStorage.setReadyStatus();return}this.configureAdvancedSettings();scorm.initialize();Adapt.offlineStorage.get();Adapt.offlineStorage.setReadyStatus();this.setupEventListeners()},checkConfig:function checkConfig(){this._config=Adapt.config.get("_spoor")||false;if(this._config&&this._config._isEnabled!==false)return true;return false},configureAdvancedSettings:function configureAdvancedSettings(){if(this._config._advancedSettings){var settings=this._config._advancedSettings;if(settings._showDebugWindow)scorm.showDebugWindow();scorm.setVersion(settings._scormVersion||"1.2");if(settings._suppressErrors){scorm.suppressErrors=settings._suppressErrors}if(settings._commitOnStatusChange){scorm.commitOnStatusChange=settings._commitOnStatusChange}if(_.isFinite(settings._timedCommitFrequency)){scorm.timedCommitFrequency=settings._timedCommitFrequency}if(_.isFinite(settings._maxCommitRetries)){scorm.maxCommitRetries=settings._maxCommitRetries}if(_.isFinite(settings._commitRetryDelay)){scorm.commitRetryDelay=settings._commitRetryDelay}if("_exitStateIfIncomplete"in settings){scorm.exitStateIfIncomplete=settings._exitStateIfIncomplete}if("_exitStateIfComplete"in settings){scorm.exitStateIfComplete=settings._exitStateIfComplete}}else{scorm.setVersion("1.2")}if(window.location.search.indexOf("nolmserrors")!=-1)scorm.suppressErrors=true},setupEventListeners:function setupEventListeners(){var advancedSettings=this._config._advancedSettings;var shouldCommitOnVisibilityChange=(!advancedSettings||advancedSettings._commitOnVisibilityChangeHidden!==false)&&document.addEventListener;this._onWindowUnload=this.onWindowUnload.bind(this);$(window).on("beforeunload unload",this._onWindowUnload);if(shouldCommitOnVisibilityChange){document.addEventListener("visibilitychange",this.onVisibilityChange)}require(["libraries/jquery.keycombo"],function(){$.onKeyCombo([68,69,86],function(){scorm.showDebugWindow()})})},removeEventListeners:function removeEventListeners(){$(window).off("beforeunload unload",this._onWindowUnload);document.removeEventListener("visibilitychange",this.onVisibilityChange)},onVisibilityChange:function onVisibilityChange(){if(document.visibilityState==="hidden")scorm.commit()},onWindowUnload:function onWindowUnload(){this.removeEventListeners();if(!scorm.finishCalled){scorm.finish()}}},Backbone.Events);Spoor.initialize()});define("extensions/adapt-contrib-trickle/js/trickleView",["core/js/adapt"],function(Adapt){var TrickleView=Backbone.View.extend({isSteplocked:false,completionAttribute:null,initialize:function initialize(options){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){var AdaptEvents={"trickle:kill":this.onKill,"remove":this.onRemove};this.onPreRender(this);AdaptEvents[this.model.get("_type")+"View:postRender"]=this.onPostRender;this.listenTo(Adapt,AdaptEvents);this.on("steplock",this.onStepLock);this.on("stepunlock",this.onStepUnlock)},onPreRender:function onPreRender(view){this.completionAttribute=Adapt.trickle.getCompletionAttribute();if(!this.isElementEnabled())return;Adapt.trigger("trickle:preRender",this)},onPostRender:function onPostRender(view){if(view.model.get("_id")!==this.model.get("_id"))return;if(!this.isElementEnabled())return;Adapt.trigger("trickle:postRender",this)},isElementEnabled:function isElementEnabled(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle)return false;if(this.model.get(this.completionAttribute))return false;var isArticleWithOnChildren=this.model.get("_type")==="article"&&trickle._onChildren;if(isArticleWithOnChildren){return false}if(trickle._isEnabled===true)return true;return false},onStepLock:function onStepLock(){if(!this.isElementEnabled()){this.continueToNext();return}var trickle=Adapt.trickle.getModelConfig(this.model);var isSteplocking=trickle._stepLocking&&trickle._stepLocking._isEnabled;if(!isSteplocking){this.continueToNext();return}Adapt.trigger("trickle:steplock",this);this.isSteplocked=true},continueToNext:function continueToNext(){Adapt.trigger("trickle:continue",this)},onStepUnlock:function onStepUnlock(){if(!this.isSteplocked)return;this.isSteplocked=false;Adapt.trigger("trickle:stepunlock",this)},onKill:function onKill(){this.detachFromElement()},onRemove:function onRemove(){this.detachFromElement()},detachFromElement:function detachFromElement(){this.undelegateEvents();this.stopListening();this.model=null;this.articleModel=null;this.$el=null;this.el=null}});return TrickleView});define("extensions/adapt-contrib-trickle/js/pageView",["core/js/adapt","./trickleView"],function(Adapt,TrickleView){var PageView=Backbone.View.extend({currentDescendantIndex:0,currentLocksOnDescendant:0,currentDescendant:null,initialize:function initialize(options){if(!this.isPageEnabled()){return this.detachFromPage()}this.setupDescendants();if(!this.haveDescendantsGotTrickle()){return this.detachFromPage()}this.addClassToHtml();this.setupEventListeners()},isPageEnabled:function isPageEnabled(){var trickleConfig=Adapt.trickle.getModelConfig(this.model);if(trickleConfig&&trickleConfig._isEnabled===false)return false;return true},setupDescendants:function setupDescendants(){this.currentDescendant=null;this.descendantViews={};this.getDescendants();Adapt.trigger("trickle:descendants",this)},descendantsChildFirst:null,descendantsParentFirst:null,descendantViews:null,getDescendants:function getDescendants(){this.descendantsChildFirst=this.model.getAllDescendantModels();this.descendantsParentFirst=this.model.getAllDescendantModels(true);this.setDescendantsTrickleDefaults();this.descendantsChildFirst=this.filterComponents(this.descendantsChildFirst);this.descendantsParentFirst=this.filterComponents(this.descendantsParentFirst)},filterComponents:function filterComponents(descendants){return descendants.filter(function(descendant){if(descendant.get("_type")==="component")return false;if(!descendant.get("_isAvailable"))return false;return true})},setDescendantsTrickleDefaults:function setDescendantsTrickleDefaults(){this.descendantsParentFirst.forEach(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);if(!trickle){return}trickle._stepLocking=_.extend({"_isEnabled":true,"_isCompletionRequired":true,"_isLockedOnRevisit":false},trickle._stepLocking);trickle=_.extend({"_isEnabled":true,"_autoScroll":true,"_scrollDuration":500,"_onChildren":true,"_scrollTo":"@block +1"},trickle);Adapt.trickle.setModelConfig(descendant,trickle);if(trickle._onChildren&&descendant.get("_type")==="article"){this.setupArticleOnChildren(descendant,trickle)}descendant.set("_isTrickleConfigured",true)}.bind(this))},setupArticleOnChildren:function setupArticleOnChildren(articleModel,articleTrickleConfig){var articleBlocks=articleModel.getChildren();articleBlocks.each(function(blockModel,index){var blockTrickleConfig=Adapt.trickle.getModelConfig(blockModel);for(var k in blockTrickleConfig){if(_typeof(blockTrickleConfig[k])==="object"){blockTrickleConfig[k]=_.extend({},articleTrickleConfig[k],blockTrickleConfig[k])}}blockTrickleConfig=_.extend({},articleTrickleConfig,blockTrickleConfig);if(articleBlocks.length===index+1){blockTrickleConfig._isFinal=true}if(index===0){blockTrickleConfig._isStart=true}Adapt.trickle.setModelConfig(blockModel,blockTrickleConfig)})},haveDescendantsGotTrickle:function haveDescendantsGotTrickle(){return this.descendantsChildFirst.some(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);return trickle&&trickle._isEnabled===true})},addClassToHtml:function addClassToHtml(){$("html").addClass("trickle")},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"remove":this.onRemove,"articleView:preRender":this.onDescendantPreRender,"blockView:preRender":this.onDescendantPreRender,"trickle:unwait":this.onUnwait,"trickle:wait":this.onWait,"trickle:continue":this.onContinue,"trickle:skip":this.onSkip,"trickle:kill":this.onKill});this.listenToOnce(this.model,"change:_isReady",this.onPageReady)},onDescendantPreRender:function onDescendantPreRender(view){if(view.model.get("_type")==="component")return;var descendantView=new TrickleView({model:view.model,el:view.el});this.descendantViews[view.model.get("_id")]=descendantView},onPageReady:function onPageReady(model,value){if(!value)return;this.currentDescendant=null;Adapt.trigger("trickle:started");this.gotoNextDescendant()},gotoNextDescendant:function gotoNextDescendant(){this.getDescendants();if(this.currentDescendant){this.currentDescendant.trigger("stepunlock");this.currentDescendant=null}for(var index=this.currentDescendantIndex||0,l=this.descendantsChildFirst.length;index<l;index++){var descendant=this.descendantsChildFirst[index];switch(descendant.get("_type")){case"block":case"article":this.currentLocksOnDescendant=0;this.currentDescendantIndex=index;var currentId=descendant.get("_id");this.currentDescendant=this.descendantViews[currentId];this.currentDescendant.trigger("steplock");return;}}this.finished()},onContinue:function onContinue(view){if(!this.currentDescendant)return;if(view.model.get("_id")!==this.currentDescendant.model.get("_id"))return;this.onSkip()},onWait:function onWait(){this.currentLocksOnDescendant++},onUnwait:function onUnwait(){this.currentLocksOnDescendant--;if(this.currentLocksOnDescendant>0)return;var lastDescendant=this.currentDescendant.model;this.currentDescendantIndex++;this.gotoNextDescendant();Adapt.trickle.scroll(lastDescendant)},onSkip:function onSkip(){this.currentDescendantIndex++;this.gotoNextDescendant()},onKill:function onKill(){this.finished();this.detachFromPage()},finished:function finished(){Adapt.trigger("trickle:finished");this.detachFromPage()},onRemove:function onRemove(){this.finished()},detachFromPage:function detachFromPage(){$("html").removeClass("trickle");this.undelegateEvents();this.stopListening();this.model=null;this.$el=null;this.el=null;this.currentDescendant=null;this.descendantViews=null;this.descendantsChildFirst=null;this.descendantsParentFirst=null;Adapt.trickle.pageView=null}});return PageView});define("extensions/adapt-contrib-trickle/js/handlers/buttonView",["core/js/adapt","core/js/views/componentView"],function(Adapt,ComponentView){var completionAttribute="_isComplete";var TrickleButtonView=Backbone.View.extend({isStepLocking:false,hasStepLocked:false,isStepLocked:false,isStepLockFinished:false,hasStepPreCompleted:false,isWaitingForClick:false,allowVisible:false,allowEnabled:true,overlayShownCount:0,el:function el(){this.setupPreRender();return Handlebars.templates["trickle-button"](this.model.toJSON())},setupPreRender:function setupPreRender(){this.setupButtonVisible();this.setupButtonEnabled()},setupButtonVisible:function setupButtonVisible(){var trickle=Adapt.trickle.getModelConfig(this.model);this.allowVisible=false;trickle._button._isVisible=false;if(trickle._button._styleBeforeCompletion==="visible"){this.allowVisible=true;if(trickle._button._autoHide&&trickle._button._isFullWidth){trickle._button._isVisible=false}else{trickle._button._isVisible=true}}},setupButtonEnabled:function setupButtonEnabled(){var trickle=Adapt.trickle.getModelConfig(this.model);if(trickle._stepLocking._isCompletionRequired===false){this.allowEnabled=true;trickle._button._isDisabled=false}else if(trickle._button._styleBeforeCompletion==="visible"){this.allowEnabled=false;trickle._button._isDisabled=true}else{trickle._button._isDisabled=false;this.allowEnabled=true}},events:{"click .js-trickle-btn":"onButtonClick"},initialize:function initialize(options){this.getCompletionAttribute();this.debounceCheckAutoHide();this.setupStepLocking();this.setupEventListeners()},getCompletionAttribute:function getCompletionAttribute(){var trickle=Adapt.trickle.getModelConfig(Adapt.config);if(!trickle)return;if(!trickle._completionAttribute)return;completionAttribute=trickle._completionAttribute},setupStepLocking:function setupStepLocking(){var trickle=Adapt.trickle.getModelConfig(this.model);this.isStepLocked=Boolean(trickle._stepLocking._isEnabled)},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:overlay":this.onOverlay,"trickle:unoverlay":this.onUnoverlay,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:skip":this.onSkip,"trickle:kill":this.onKill,"trickle:update":this.onUpdate,"remove":this.onRemove});this.listenTo(this.model,"change:"+completionAttribute,this.onCompletion)},debounceCheckAutoHide:function debounceCheckAutoHide(){this.checkButtonAutoHideSync=this.checkButtonAutoHide.bind(this);this.checkButtonAutoHide=_.debounce(this.checkButtonAutoHideSync,100)},checkButtonAutoHide:function checkButtonAutoHide(){if(!this.allowVisible){this.setButtonVisible(false);return}var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._button._autoHide){this.setButtonVisible(true);return}else if(this.overlayShownCount>0){this.setButtonVisible(false);return}var measurements=this.$el.onscreen();var isJustOffscreen=measurements.bottom>-100;if(measurements.onscreen||isJustOffscreen){this.setButtonVisible(true)}else{this.setButtonVisible(false)}},setButtonVisible:function setButtonVisible(isVisible){var trickle=Adapt.trickle.getModelConfig(this.model);trickle._button._isVisible=Boolean(isVisible);this.$(".js-trickle-btn-container").toggleClass("u-display-none",!trickle._button._isVisible)},checkButtonEnabled:function checkButtonEnabled(){this.setButtonEnabled(this.allowEnabled)},setButtonEnabled:function setButtonEnabled(isEnabled){var trickle=Adapt.trickle.getModelConfig(this.model);var $button=this.$(".js-trickle-btn");if(isEnabled){$button.removeClass("is-disabled").removeAttr("disabled");trickle._button._isDisabled=true;if(document.activeElement&&document.activeElement.isSameNode(this.$(".aria-label")[0])){this.$(".aria-label").focusNext()}this.$(".aria-label").a11y_cntrl(false)}else{$button.addClass("is-disabled").attr("disabled","disabled");trickle._button._isDisabled=false}},onStepLock:function onStepLock(view){if(!this.isViewMatch(view))return;this.hasStepLocked=true;this.isStepLocking=true;this.overlayShownCount=0;var trickle=Adapt.trickle.getModelConfig(this.model);if(!this.isButtonEnabled())return;var isCompleteAndShouldRelock=trickle._stepLocking._isLockedOnRevisit&&this.model.get(completionAttribute);if(isCompleteAndShouldRelock){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);Adapt.trigger("trickle:wait");this.allowVisible=true;this.checkButtonAutoHide()}else if(this.hasStepPreCompleted){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);this.allowVisible=true;this.stepCompleted()}this.setupOnScreenListener()},onOverlay:function onOverlay(){this.overlayShownCount++},onUnoverlay:function onUnoverlay(){this.overlayShownCount--;this.checkButtonAutoHide()},setupOnScreenListener:function setupOnScreenListener(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._button._autoHide)return;this.$el.on("onscreen",this.checkButtonAutoHideSync)},isViewMatch:function isViewMatch(view){return view.model.get("_id")===this.model.get("_id")},isButtonEnabled:function isButtonEnabled(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._isEnabled||!trickle._button._isEnabled)return false;return true},onCompletion:function onCompletion(model,value){if(value===false)return;this.hasStepPreCompleted=true;if(!this.hasStepLocked)return;this.stepCompleted()},stepCompleted:function stepCompleted(){if(this.isStepLockFinished)return;this.isStepLocked=false;this.allowVisible=false;this.allowEnabled=false;if(this.isButtonEnabled()){if(this.isStepLocking){this.isStepLocked=true;this.isWaitingForClick=true;Adapt.trigger("trickle:wait")}else{this.isStepLockFinished=true}this.allowVisible=true;this.allowEnabled=true}this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHideSync();this.checkButtonEnabled()},onButtonClick:function onButtonClick(){if(this.isStepLocked){Adapt.trigger("trickle:unwait");this.isStepLocked=false;this.isStepLockFinished=true}else{this.model.set("_isTrickleAutoScrollComplete",false);Adapt.trickle.scroll(this.model)}var trickle=this.model.get("_trickle");switch(trickle._button._styleAfterClick){case"hidden":this.allowVisible=false;this.checkButtonAutoHideSync();break;case"disabled":this.allowEnabled=false;this.checkButtonAutoHideSync();}},onUpdate:function onUpdate(){var trickle=Adapt.trickle.getModelConfig(this.model);if(trickle._button._autoHide&&this.isStepLocking){this.$el.off("onscreen",this.checkButtonAutoHideSync)}var $original=this.$el;var $newEl=$(Handlebars.templates["trickle-button"](this.model.toJSON()));$original.replaceWith($newEl);this.setElement($newEl);if(trickle._button._autoHide&&this.isStepLocking){this.$el.on("onscreen",this.checkButtonAutoHideSync)}},onStepUnlock:function onStepUnlock(view){if(!this.isViewMatch(view))return;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=false;this.overlayShownCount=0;if(document.activeElement&&document.activeElement.isSameNode(this.$(".aria-label")[0])){this.$(".aria-label").focusNext()}this.$(".aria-label").a11y_cntrl(false)},onSkip:function onSkip(){if(!this.isStepLocking)return;this.onKill()},onKill:function onKill(){this.$el.off("onscreen",this.checkButtonAutoHideSync);if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.isStepLocked=false;this.isStepLocking=false;this.allowVisible=false;this.allowEnabled=false;this.isStepLockFinished=true;this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHide();this.checkButtonEnabled()},onRemove:function onRemove(){if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=true;this.remove()}});return TrickleButtonView});define("extensions/adapt-contrib-trickle/js/handlers/button",["core/js/adapt","./buttonView"],function(Adapt,ButtonView){var TrickleButtonHandler=Backbone.Controller.extend({buttonViews:null,initialize:function initialize(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady,remove:this.onRemove})},onAppDataReady:function onAppDataReady(){this.buttonViews={};this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:preRender":this.onPreRender,"trickle:postRender":this.onPostRender})},onPreRender:function onPreRender(view){if(!this.isTrickleEnabled(view.model))return;this.setupConfigDefaults(view.model);this.buttonViews[view.model.get("_id")]=new ButtonView({model:view.model})},onPostRender:function onPostRender(view){if(!this.isTrickleEnabled(view.model))return;view.$el.append(this.buttonViews[view.model.get("_id")].$el)},isTrickleEnabled:function isTrickleEnabled(model){var trickle=Adapt.trickle.getModelConfig(model);if(!trickle||!trickle._isEnabled)return false;if(trickle._onChildren&&model.get("_type")==="article")return false;return true},setupConfigDefaults:function setupConfigDefaults(model){if(model.get("_isTrickleButtonConfigured"))return;var defaults={_isEnabled:true,_styleBeforeCompletion:"hidden",_styleAfterClick:"hidden",_isFullWidth:true,_autoHide:false,_className:"",_hasIcon:false,text:"Continue",startText:"Begin",finalText:"Finish",_component:"trickle-button",_isLocking:true,_isVisible:false,_isDisabled:false};var trickle=Adapt.trickle.getModelConfig(model);trickle._button=_.extend(defaults,trickle._button);if(trickle._button._isFullWidth){trickle._stepLocking._isEnabled=true;trickle._button._styleAfterClick="hidden"}else{trickle._button._autoHide=false}Adapt.trickle.setModelConfig(model,trickle);model.set("_isTrickleButtonConfigured",true)},onRemove:function onRemove(){this.buttonViews={}}});return new TrickleButtonHandler});define("extensions/adapt-contrib-trickle/js/handlers/completion",["core/js/adapt"],function(Adapt){var completionAttribute="_isComplete";var TrickleCompletionHandler=Backbone.Controller.extend({isStepLocking:false,isCompleted:false,stepModel:null,initialize:function initialize(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function onAppDataReady(){this.getCompletionAttribute();this.setupEventListeners()},getCompletionAttribute:function getCompletionAttribute(){var trickle=Adapt.trickle.getModelConfig(Adapt.config);if(!trickle)return;if(!trickle._completionAttribute)return;completionAttribute=trickle._completionAttribute},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:descendants":this.onDescendants,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"remove":this.onRemove})},onDescendants:function onDescendants(view){view.descendantsParentFirst.forEach(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);if(!trickle)return;trickle._wasCompletedPreRender=descendant.get(completionAttribute)})},onStepLock:function onStepLock(view){var isModelComplete=view.model.get(completionAttribute);var trickle=Adapt.trickle.getModelConfig(view.model);if(!trickle._stepLocking._isCompletionRequired&&!trickle._stepLocking._isLockedOnRevisit){if(!isModelComplete)return;Adapt.trigger("trickle:continue",view);return}if(trickle._stepLocking._isCompletionRequired&&isModelComplete&&trickle._wasCompletedPreRender){Adapt.trigger("trickle:continue",view);return}Adapt.trigger("trickle:wait");if(isModelComplete){Adapt.trigger("trickle:unwait");return}view.model.set("_isTrickleAutoScrollComplete",false);this.isCompleted=false;this.isStepLocking=true;this.stepModel=view.model;this.listenTo(this.stepModel,"change:"+completionAttribute,this.onCompletion)},onCompletion:function onCompletion(model,value){if(value===false)return;this.stepCompleted()},stepCompleted:function stepCompleted(){if(!this.isStepLocking)return;if(this.isCompleted)return;this.isCompleted=true;this.stopListening(this.stepModel,"change:"+completionAttribute,this.onCompletion);Adapt.trigger("trickle:unwait")},onKill:function onKill(){this.onStepUnlock()},onRemove:function onRemove(){this.onStepUnlock()},onStepUnlock:function onStepUnlock(){this.stopListening(this.stepModel,"change:"+completionAttribute,this.onCompletion);this.isStepLocking=false;this.stepModel=null;this.isCompleted=false}});return new TrickleCompletionHandler});define("extensions/adapt-contrib-trickle/js/handlers/notify",["core/js/adapt"],function(Adapt){var TrickleNotifyHandler=Backbone.Controller.extend({isStepLocking:false,isNotifyOpen:false,initialize:function initialize(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function onAppDataReady(){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"notify:opened":this.onNotifyOpened,"notify:closed":this.onNotifyClosed,"trickle:stepunlock":this.onStepUnlock,"remove":this.onRemove})},onStepLock:function onStepLock(view){this.isStepLocking=true},onNotifyOpened:function onNotifyOpened(){if(!this.isStepLocking)return;this.isNotifyOpen=true;Adapt.trigger("trickle:overlay");Adapt.trigger("trickle:wait")},onNotifyClosed:function onNotifyClosed(){if(!this.isStepLocking)return;if(!this.isNotifyOpen)return;this.isNotifyOpen=false;Adapt.trigger("trickle:unoverlay");Adapt.trigger("trickle:unwait")},onStepUnlock:function onStepUnlock(){this.isStepLocking=false},onRemove:function onRemove(){this.onStepUnlock()}});return new TrickleNotifyHandler});define("extensions/adapt-contrib-trickle/js/handlers/resize",["core/js/adapt"],function(Adapt){var TrickleBodyResizeHandler=Backbone.Controller.extend({isStepLocking:false,stepView:null,initialize:function initialize(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady,"adapt:initialize":this.onAdaptInitialized})},onAppDataReady:function onAppDataReady(){this.onResize=this.onResize.bind(this);this.preventWrapperScroll=this.preventWrapperScroll.bind(this);this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"trickle:resize":this.onTrickleResize,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,"remove":this.onRemove})},onAdaptInitialized:function onAdaptInitialized(){this.wrapper=document.getElementById("wrapper");this.wrapper.addEventListener("scroll",this.preventWrapperScroll)},onStepLock:function onStepLock(view){this.isStepLocking=true;this.stepView=view;$(window).on("resize",this.onResize);$(".page").on("resize",this.onResize);Adapt.trigger("trickle:resize")},preventWrapperScroll:function preventWrapperScroll(event){if(!this.isStepLocking)return;var top=this.wrapper.scrollTop;if(top===0)return;this.wrapper.scrollTop=0;window.scrollTo(0,window.pageYOffset+top)},onResize:function onResize(){if(!this.isStepLocking)return;Adapt.trigger("trickle:resize")},onTrickleResize:function onTrickleResize(){if(!this.isStepLocking)return;var offset=this.stepView.$el.offset();var height=this.stepView.$el.height();var $wrapper=$(this.wrapper);var bottom=offset["top"]+height;$wrapper.css("height",bottom)},onStepUnlock:function onStepUnlock(view){this.isStepLocking=false;this.stepView=null;$(window).off("resize",this.onResize);$(".page").off("resize",this.onResize)},onKill:function onKill(){this.onFinished();this.onStepUnlock()},onFinished:function onFinished(){this.wrapper.removeEventListener("scroll",this.preventWrapperScroll);$(this.wrapper).css("height","")},onRemove:function onRemove(){this.onStepUnlock();this.stepView=null}});return new TrickleBodyResizeHandler});define("extensions/adapt-contrib-trickle/js/handlers/tutor",["core/js/adapt"],function(Adapt){var TrickleTutorHandler=Backbone.Controller.extend({stepLockedId:null,isStepLocking:false,isTutorOpen:false,initialize:function initialize(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function onAppDataReady(){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"tutor:opened":this.onTutorOpened,"tutor:closed":this.onTutorClosed,"trickle:stepunlock":this.onStepUnlock,"remove":this.onRemove})},onStepLock:function onStepLock(view){if(view){this.stepLockedId=view.model.get("_id")}this.isStepLocking=true},onTutorOpened:function onTutorOpened(view,alertObject){if(!this.isStepLocking)return;if(!this.isOriginStepLocked(view))return;this.isTutorOpen=true;Adapt.trigger("trickle:overlay");Adapt.trigger("trickle:wait")},isOriginStepLocked:function isOriginStepLocked(view){if(!view||!this.stepLockedId)return true;var parents=view.model.getAncestorModels();var hasStepLockedParent=_.find(parents,function(ancestor){return ancestor.get("_id")===this.stepLockedId},this);if(!hasStepLockedParent)return false;return true},onTutorClosed:function onTutorClosed(view,alertObject){if(!this.isStepLocking)return;if(!this.isTutorOpen)return;if(!this.isOriginStepLocked(view))return;this.isTutorOpen=false;Adapt.trigger("trickle:unoverlay");Adapt.trigger("trickle:unwait")},onStepUnlock:function onStepUnlock(){this.isStepLocking=false;this.stepLockedId=null},onRemove:function onRemove(){this.onStepUnlock()}});return new TrickleTutorHandler});define("extensions/adapt-contrib-trickle/js/handlers/visibility",["core/js/adapt"],function(Adapt){var TrickleVisibilityHandler=Backbone.Controller.extend({isStepLocking:false,trickleModel:null,initialize:function initialize(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function onAppDataReady(){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"trickle:visibility":this.onVisibility,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,"remove":this.onRemove})},onStepLock:function onStepLock(view){this.isStepLocking=true;this.trickleModel=view.model;Adapt.trigger("trickle:visibility")},onVisibility:function onVisibility(){if(!this.isStepLocking)return;if(!Adapt.trickle.pageView)return;var descendantsParentFirst=Adapt.trickle.pageView.descendantsParentFirst;var trickleModelId=this.trickleModel.get("_id");var trickleType=this.trickleModel.get("_type");var atIndex=_.findIndex(descendantsParentFirst,function(descendant){if(descendant.get("_id")===trickleModelId)return true});descendantsParentFirst.forEach(function(descendant,index){var components=descendant.findDescendantModels("components");if(index<=atIndex){descendant.set("_isVisible",true,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})});return}if(trickleType==="article"&&descendant.get("_type")==="block"){if(descendant.get("_parentId")===trickleModelId){descendant.set("_isVisible",true,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})});return}}descendant.set("_isVisible",false,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",false,{pluginName:"trickle"})})})},onStepUnlock:function onStepUnlock(view){this.isStepLocking=false;this.trickleModel=null},onKill:function onKill(){this.onFinished();this.onStepUnlock()},onFinished:function onFinished(){var descendantsParentFirst=Adapt.trickle.pageView.descendantsParentFirst;descendantsParentFirst.forEach(function(descendant){descendant.set("_isVisible",true,{pluginName:"trickle"});var components=descendant.findDescendantModels("components");components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})})})},onRemove:function onRemove(){this.onStepUnlock()}});return new TrickleVisibilityHandler});define("extensions/adapt-contrib-trickle/js/handlers/done",["core/js/adapt"],function(Adapt){var TrickleDone=Backbone.Controller.extend({initialize:function initialize(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function onAppDataReady(){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.onDone=_.debounce(this.onDone.bind(this),50);this.listenTo(Adapt,{"trickle:steplock":this.onDone,"trickle:stepunlock":this.onDone,"trickle:continue":this.onDone,"trickle:finished":this.onDone})},onDone:function onDone(){Adapt.trigger("trickle:done")}});return new TrickleDone});define("extensions/adapt-contrib-trickle/js/adapt-contrib-trickle",["core/js/adapt","./pageView","./handlers/button","./handlers/completion","./handlers/notify","./handlers/resize","./handlers/tutor","./handlers/visibility","./handlers/done"],function(Adapt,PageView){var Trickle=Backbone.Controller.extend({model:null,pageView:null,initialize:function initialize(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady})},onAppDataReady:function onAppDataReady(){this.getCourseModel();if(!this.isCourseEnabled())return;this.setupListeners()},getCourseModel:function getCourseModel(){this.model=Adapt.course},isCourseEnabled:function isCourseEnabled(){var trickleConfig=this.getModelConfig(this.model);if(trickleConfig&&trickleConfig._isEnabled===false)return false;return true},getModelConfig:function getModelConfig(model){return model.get("_trickle")},getCompletionAttribute:function getCompletionAttribute(){var trickle=this.getModelConfig(Adapt.config);if(!trickle)return"_isComplete";return trickle._completionAttribute||"_isComplete"},setModelConfig:function setModelConfig(model,config){return model.set("_trickle",config)},setupListeners:function setupListeners(){this.listenTo(Adapt,"pageView:preRender",this.onPagePreRender)},onPagePreRender:function onPagePreRender(view){this.pageView=new PageView({model:view.model,el:view.el})},scroll:function scroll(fromModel){if(!this.shouldScrollPage(fromModel))return;fromModel.set("_isTrickleAutoScrollComplete",true);var trickle=Adapt.trickle.getModelConfig(fromModel);var isAutoScrollOff=!trickle._autoScroll;var hasTrickleButton=trickle._button._isEnabled;if(isAutoScrollOff&&!hasTrickleButton){return}var scrollTo=trickle._scrollTo;if(scrollTo===undefined)scrollTo="@block +1";var scrollToId="";switch(scrollTo.substr(0,1)){case"@":var relativeModel=fromModel.findRelativeModel(scrollTo,{filter:function filter(model){return model.get("_isAvailable")}});if(relativeModel===undefined)return;scrollToId=relativeModel.get("_id");break;case".":scrollToId=scrollTo.substr(1,scrollTo.length-1);break;default:scrollToId=scrollTo;}if(scrollToId==="")return;if(hasTrickleButton){Adapt.a11y.focusFirst($("."+scrollToId))}if(isAutoScrollOff)return;var duration=fromModel.get("_trickle")._scrollDuration||500;Adapt.scrollTo("."+scrollToId,{duration:duration})},shouldScrollPage:function shouldScrollPage(fromModel){var trickle=Adapt.trickle.getModelConfig(fromModel);if(!trickle||!trickle._isEnabled)return false;var hasScrolled=fromModel.get("_isTrickleAutoScrollComplete");if(hasScrolled)return false;var isArticleWithOnChildren=fromModel.get("_type")==="article"&&trickle._onChildren;if(isArticleWithOnChildren)return false;return true}});return Adapt.trickle=new Trickle});define("extensions/adapt-contrib-tutor/js/adapt-contrib-tutor",["core/js/adapt"],function(Adapt){Adapt.on("questionView:showFeedback",function(view){var alertObject={title:view.model.get("feedbackTitle"),body:view.model.get("feedbackMessage")};var attributes={};var classes=[];if(view.model.has("_isCorrect")){if(view.model.get("_isCorrect")){classes.push("is-correct")}else{if(view.model.has("_isAtLeastOneCorrectSelection")){if(view.model.get("_isAtLeastOneCorrectSelection")){classes.push("is-partially-correct")}else{classes.push("is-incorrect")}}else{classes.push("is-incorrect")}}}if(view.model.has("_component")){classes.push("is-component is-"+view.model.get("_component").toLowerCase())}else if(view.model.has("_extension")){classes.push("is-extension is-"+view.model.get("_extension").toLowerCase())}attributes["data-adapt-id"]=view.model.get("_id");alertObject._classes=classes.join(" ");alertObject._attributes=attributes;Adapt.once("notify:closed",function(){Adapt.trigger("tutor:closed",view,alertObject)});Adapt.trigger("notify:popup",alertObject);Adapt.trigger("tutor:opened",view,alertObject)})});define("extensions/adapt-favicons-master/js/adapt-favicons",["coreJS/adapt"],function(Adapt){Adapt.once("adapt:initialize",function(){var template=Handlebars.templates["favicons"];$("head").append(template({_favicons:Adapt.course.get("_favicons")}))})});define("extensions/adapt-goTop/js/adapt-goTop",["core/js/adapt"],function(Adapt){var goTopView=Backbone.View.extend({tagName:"div",className:"goTop",events:{"click .goTop-button":"goTop"},initialize:function initialize(){this.listenTo(Adapt,"remove",this.remove);var template=Handlebars.templates.goTop;$("#wrapper").append(this.$el.html(template()));this.startScrollListener()},startScrollListener:function startScrollListener(){if(!Adapt.course.get("_goTop")._scrollListener._isEnabled)return;var context=this;$(window).on("scroll.goTop",function(){context.checkIfBottom()})},stopScrollListener:function stopScrollListener(){$(window).off("scroll.goTop")},checkIfBottom:_.throttle(function(){var viewportTop=$(window).scrollTop();if(viewportTop>=Adapt.course.get("_goTop")._scrollListener._offset){$(".goTop").show()}else{$(".goTop").hide()}},100),goTop:function goTop(){var $page=$("."+Adapt.location._currentId);Adapt.scrollTo($page,{duration:400})}});Adapt.on("router:page router:menu",function(){$(window).off("scroll.goTop")});Adapt.on("pageView:ready",function(){var model=Adapt.course.get("_goTop");if(!model||!model._isEnabled)return;new goTopView});return goTopView});(function(root,factory){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){factory(exports)}else if(typeof define==="function"&&define.amd){define("extensions/adapt-intro/js/intro",["exports"],factory)}else{factory(root)}})(this,function(exports){var VERSION="2.3.0";function IntroJs(obj){this._targetElement=obj;this._introItems=[];this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",hidePrev:false,hideNext:false,tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:true,exitOnOverlayClick:false,showStepNumbers:true,keyboardNavigation:true,showButtons:true,showBullets:true,showProgress:false,scrollToElement:true,overlayOpacity:0.8,scrollPadding:30,positionPrecedence:["bottom","top","right","left"],disableInteraction:false,hintPosition:"top-middle",hintButtonLabel:"Got it",hintAnimation:true}}function _introForElement(targetElm){var introItems=[],self=this;if(this._options.steps){for(var i=0,stepsLength=this._options.steps.length;i<stepsLength;i++){var currentItem=_cloneObject(this._options.steps[i]);currentItem.step=introItems.length+1;if(typeof currentItem.element==="string"){currentItem.element=document.querySelector(currentItem.element)}if(typeof currentItem.element==="undefined"||currentItem.element==null){var floatingElementQuery=document.querySelector(".introjsFloatingElement");if(floatingElementQuery==null){floatingElementQuery=document.createElement("div");floatingElementQuery.className="introjsFloatingElement";document.body.appendChild(floatingElementQuery)}currentItem.element=floatingElementQuery;currentItem.position="floating"}if(currentItem.element!=null){introItems.push(currentItem)}}}else{var allIntroSteps=targetElm.querySelectorAll("*[data-intro]");if(allIntroSteps.length<1){return false}for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];if(currentElement.style.display=="none"){continue}var step=parseInt(currentElement.getAttribute("data-step"),10);if(step>0){introItems[step-1]={element:currentElement,intro:currentElement.getAttribute("data-intro"),step:parseInt(currentElement.getAttribute("data-step"),10),tooltipClass:currentElement.getAttribute("data-tooltipClass"),highlightClass:currentElement.getAttribute("data-highlightClass"),position:currentElement.getAttribute("data-position")||this._options.tooltipPosition}}}var nextStep=0;for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];if(currentElement.getAttribute("data-step")==null){while(true){if(typeof introItems[nextStep]=="undefined"){break}else{nextStep++}}introItems[nextStep]={element:currentElement,intro:currentElement.getAttribute("data-intro"),step:nextStep+1,tooltipClass:currentElement.getAttribute("data-tooltipClass"),highlightClass:currentElement.getAttribute("data-highlightClass"),position:currentElement.getAttribute("data-position")||this._options.tooltipPosition}}}}var tempIntroItems=[];for(var z=0;z<introItems.length;z++){introItems[z]&&tempIntroItems.push(introItems[z])}introItems=tempIntroItems;introItems.sort(function(a,b){return a.step-b.step});self._introItems=introItems;if(_addOverlayLayer.call(self,targetElm)){_nextStep.call(self);var skipButton=targetElm.querySelector(".introjs-skipbutton"),nextStepButton=targetElm.querySelector(".introjs-nextbutton");self._onKeyDown=function(e){if(e.keyCode===27&&self._options.exitOnEsc==true){if(self._introExitCallback!=undefined){self._introExitCallback.call(self)}_exitIntro.call(self,targetElm)}else if(e.keyCode===37){_previousStep.call(self)}else if(e.keyCode===39){_nextStep.call(self)}else if(e.keyCode===13){var target=e.target||e.srcElement;if(target&&target.className.indexOf("introjs-prevbutton")>0){_previousStep.call(self)}else if(target&&target.className.indexOf("introjs-skipbutton")>0){if(self._introItems.length-1==self._currentStep&&typeof self._introCompleteCallback==="function"){self._introCompleteCallback.call(self)}if(self._introExitCallback!=undefined){self._introExitCallback.call(self)}_exitIntro.call(self,targetElm)}else{_nextStep.call(self)}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}};self._onResize=function(e){_setHelperLayerPosition.call(self,document.querySelector(".introjs-helperLayer"));_setHelperLayerPosition.call(self,document.querySelector(".introjs-tooltipReferenceLayer"))};if(window.addEventListener){if(this._options.keyboardNavigation){window.addEventListener("keydown",self._onKeyDown,true)}window.addEventListener("resize",self._onResize,true)}else if(document.attachEvent){if(this._options.keyboardNavigation){document.attachEvent("onkeydown",self._onKeyDown)}document.attachEvent("onresize",self._onResize)}}return false}function _cloneObject(object){if(object==null||_typeof(object)!="object"||typeof object.nodeType!="undefined"){return object}var temp={};for(var key in object){if(typeof jQuery!="undefined"&&object[key]instanceof jQuery){temp[key]=object[key]}else{temp[key]=_cloneObject(object[key])}}return temp}function _goToStep(step){this._currentStep=step-2;if(typeof this._introItems!=="undefined"){_nextStep.call(this)}}function _nextStep(){this._direction="forward";if(typeof this._currentStep==="undefined"){this._currentStep=0}else{++this._currentStep}if(this._introItems.length<=this._currentStep){if(typeof this._introCompleteCallback==="function"){this._introCompleteCallback.call(this)}_exitIntro.call(this,this._targetElement);return}var nextStep=this._introItems[this._currentStep];if(typeof this._introBeforeChangeCallback!=="undefined"){this._introBeforeChangeCallback.call(this,nextStep.element)}_showElement.call(this,nextStep)}function _previousStep(){this._direction="backward";if(this._currentStep===0){return false}var nextStep=this._introItems[--this._currentStep];if(typeof this._introBeforeChangeCallback!=="undefined"){this._introBeforeChangeCallback.call(this,nextStep.element)}_showElement.call(this,nextStep)}function _exitIntro(targetElement){var overlayLayer=targetElement.querySelector(".introjs-overlay");if(overlayLayer==null){return}overlayLayer.style.opacity=0;setTimeout(function(){if(overlayLayer.parentNode){overlayLayer.parentNode.removeChild(overlayLayer)}},500);var helperLayer=targetElement.querySelector(".introjs-helperLayer");if(helperLayer){helperLayer.parentNode.removeChild(helperLayer)}var referenceLayer=targetElement.querySelector(".introjs-tooltipReferenceLayer");if(referenceLayer){referenceLayer.parentNode.removeChild(referenceLayer)}var disableInteractionLayer=targetElement.querySelector(".introjs-disableInteraction");if(disableInteractionLayer){disableInteractionLayer.parentNode.removeChild(disableInteractionLayer)}var floatingElement=document.querySelector(".introjsFloatingElement");if(floatingElement){floatingElement.parentNode.removeChild(floatingElement)}var showElement=document.querySelector(".introjs-showElement");if(showElement){showElement.className=showElement.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"")}var fixParents=document.querySelectorAll(".introjs-fixParent");if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"")}}if(window.removeEventListener){window.removeEventListener("keydown",this._onKeyDown,true)}else if(document.detachEvent){document.detachEvent("onkeydown",this._onKeyDown)}this._currentStep=undefined}function _placeTooltip(targetElement,tooltipLayer,arrowLayer,helperNumberLayer,hintMode){var tooltipCssClass="",currentStepObj,tooltipOffset,targetOffset,windowSize,currentTooltipPosition;hintMode=hintMode||false;tooltipLayer.style.top=null;tooltipLayer.style.right=null;tooltipLayer.style.bottom=null;tooltipLayer.style.left=null;tooltipLayer.style.marginLeft=null;tooltipLayer.style.marginTop=null;arrowLayer.style.display="inherit";if(typeof helperNumberLayer!="undefined"&&helperNumberLayer!=null){helperNumberLayer.style.top=null;helperNumberLayer.style.left=null}if(!this._introItems[this._currentStep])return;currentStepObj=this._introItems[this._currentStep];if(typeof currentStepObj.tooltipClass==="string"){tooltipCssClass=currentStepObj.tooltipClass}else{tooltipCssClass=this._options.tooltipClass}tooltipLayer.className=("introjs-tooltip "+tooltipCssClass).replace(/^\s+|\s+$/g,"");currentTooltipPosition=this._introItems[this._currentStep].position;if(currentTooltipPosition=="auto"||this._options.tooltipPosition=="auto"){if(currentTooltipPosition!="floating"){currentTooltipPosition=_determineAutoPosition.call(this,targetElement,tooltipLayer,currentTooltipPosition)}}targetOffset=_getOffset(targetElement);tooltipOffset=_getOffset(tooltipLayer);windowSize=_getWinSize();switch(currentTooltipPosition){case"top":arrowLayer.className="introjs-arrow bottom";if(hintMode){var tooltipLayerStyleLeft=0}else{var tooltipLayerStyleLeft=15}_checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer);tooltipLayer.style.bottom=targetOffset.height+20+"px";break;case"right":tooltipLayer.style.left=targetOffset.width+20+"px";if(targetOffset.top+tooltipOffset.height>windowSize.height){arrowLayer.className="introjs-arrow left-bottom";tooltipLayer.style.top="-"+(tooltipOffset.height-targetOffset.height-20)+"px"}else{arrowLayer.className="introjs-arrow left"}break;case"left":if(!hintMode&&this._options.showStepNumbers==true){tooltipLayer.style.top="15px"}if(targetOffset.top+tooltipOffset.height>windowSize.height){tooltipLayer.style.top="-"+(tooltipOffset.height-targetOffset.height-20)+"px";arrowLayer.className="introjs-arrow right-bottom"}else{arrowLayer.className="introjs-arrow right"}tooltipLayer.style.right=targetOffset.width+20+"px";break;case"floating":arrowLayer.style.display="none";tooltipLayer.style.left="50%";tooltipLayer.style.top="50%";tooltipLayer.style.marginLeft="-"+tooltipOffset.width/2+"px";tooltipLayer.style.marginTop="-"+tooltipOffset.height/2+"px";if(typeof helperNumberLayer!="undefined"&&helperNumberLayer!=null){helperNumberLayer.style.left="-"+(tooltipOffset.width/2+18)+"px";helperNumberLayer.style.top="-"+(tooltipOffset.height/2+18)+"px"}break;case"bottom-right-aligned":arrowLayer.className="introjs-arrow top-right";var tooltipLayerStyleRight=0;_checkLeft(targetOffset,tooltipLayerStyleRight,tooltipOffset,tooltipLayer);tooltipLayer.style.top=targetOffset.height+20+"px";break;case"bottom-middle-aligned":arrowLayer.className="introjs-arrow top-middle";var tooltipLayerStyleLeftRight=targetOffset.width/2-tooltipOffset.width/2;if(hintMode){tooltipLayerStyleLeftRight+=5}if(_checkLeft(targetOffset,tooltipLayerStyleLeftRight,tooltipOffset,tooltipLayer)){tooltipLayer.style.right=null;_checkRight(targetOffset,tooltipLayerStyleLeftRight,tooltipOffset,windowSize,tooltipLayer)}tooltipLayer.style.top=targetOffset.height+20+"px";break;case"bottom-left-aligned":case"bottom":default:arrowLayer.className="introjs-arrow top";var tooltipLayerStyleLeft=0;_checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer);tooltipLayer.style.top=targetOffset.height+20+"px";break;}}function _checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer){if(targetOffset.left+tooltipLayerStyleLeft+tooltipOffset.width>windowSize.width){tooltipLayer.style.left=windowSize.width-tooltipOffset.width-targetOffset.left+"px";return false}tooltipLayer.style.left=tooltipLayerStyleLeft+"px";return true}function _checkLeft(targetOffset,tooltipLayerStyleRight,tooltipOffset,tooltipLayer){if(targetOffset.left+targetOffset.width-tooltipLayerStyleRight-tooltipOffset.width<0){tooltipLayer.style.left=-targetOffset.left+"px";return false}tooltipLayer.style.right=tooltipLayerStyleRight+"px";return true}function _determineAutoPosition(targetElement,tooltipLayer,desiredTooltipPosition){var possiblePositions=this._options.positionPrecedence.slice();var windowSize=_getWinSize();var tooltipHeight=_getOffset(tooltipLayer).height+10;var tooltipWidth=_getOffset(tooltipLayer).width+20;var targetOffset=_getOffset(targetElement);var calculatedPosition="floating";if(targetOffset.left+tooltipWidth>windowSize.width||targetOffset.left+targetOffset.width/2-tooltipWidth<0){_removeEntry(possiblePositions,"bottom");_removeEntry(possiblePositions,"top")}else{if(targetOffset.height+targetOffset.top+tooltipHeight>windowSize.height){_removeEntry(possiblePositions,"bottom")}if(targetOffset.top-tooltipHeight<0){_removeEntry(possiblePositions,"top")}}if(targetOffset.width+targetOffset.left+tooltipWidth>windowSize.width){_removeEntry(possiblePositions,"right")}if(targetOffset.left-tooltipWidth<0){_removeEntry(possiblePositions,"left")}if(possiblePositions.length>0){calculatedPosition=possiblePositions[0]}if(desiredTooltipPosition&&desiredTooltipPosition!="auto"){if(possiblePositions.indexOf(desiredTooltipPosition)>-1){calculatedPosition=desiredTooltipPosition}}return calculatedPosition}function _removeEntry(stringArray,stringToRemove){if(stringArray.indexOf(stringToRemove)>-1){stringArray.splice(stringArray.indexOf(stringToRemove),1)}}function _setHelperLayerPosition(helperLayer){if(helperLayer){if(!this._introItems[this._currentStep])return;var currentElement=this._introItems[this._currentStep],elementPosition=_getOffset(currentElement.element),widthHeightPadding=10;if(_isFixed(currentElement.element)){helperLayer.className+=" introjs-fixedTooltip"}else{helperLayer.className=helperLayer.className.replace(" introjs-fixedTooltip","")}if(currentElement.position=="floating"){widthHeightPadding=0}helperLayer.setAttribute("style","width: "+(elementPosition.width+widthHeightPadding)+"px; "+"height:"+(elementPosition.height+widthHeightPadding)+"px; "+"top:"+(elementPosition.top-5)+"px;"+"left: "+(elementPosition.left-5)+"px;")}}function _disableInteraction(){var disableInteractionLayer=document.querySelector(".introjs-disableInteraction");if(disableInteractionLayer===null){disableInteractionLayer=document.createElement("div");disableInteractionLayer.className="introjs-disableInteraction";this._targetElement.appendChild(disableInteractionLayer)}_setHelperLayerPosition.call(this,disableInteractionLayer)}function _setAnchorAsButton(anchor){anchor.setAttribute("role","button");anchor.tabIndex=0}function _showElement(targetElement){if(typeof this._introChangeCallback!=="undefined"){this._introChangeCallback.call(this,targetElement.element)}var self=this,oldHelperLayer=document.querySelector(".introjs-helperLayer"),oldReferenceLayer=document.querySelector(".introjs-tooltipReferenceLayer"),highlightClass="introjs-helperLayer",elementPosition=_getOffset(targetElement.element);if(typeof targetElement.highlightClass==="string"){highlightClass+=" "+targetElement.highlightClass}if(typeof this._options.highlightClass==="string"){highlightClass+=" "+this._options.highlightClass}if(oldHelperLayer!=null){var oldHelperNumberLayer=oldReferenceLayer.querySelector(".introjs-helperNumberLayer"),oldtooltipLayer=oldReferenceLayer.querySelector(".introjs-tooltiptext"),oldArrowLayer=oldReferenceLayer.querySelector(".introjs-arrow"),oldtooltipContainer=oldReferenceLayer.querySelector(".introjs-tooltip"),skipTooltipButton=oldReferenceLayer.querySelector(".introjs-skipbutton"),prevTooltipButton=oldReferenceLayer.querySelector(".introjs-prevbutton"),nextTooltipButton=oldReferenceLayer.querySelector(".introjs-nextbutton");oldHelperLayer.className=highlightClass;oldtooltipContainer.style.opacity=0;oldtooltipContainer.style.display="none";if(oldHelperNumberLayer!=null){var lastIntroItem=this._introItems[targetElement.step-2>=0?targetElement.step-2:0];if(lastIntroItem!=null&&this._direction=="forward"&&lastIntroItem.position=="floating"||this._direction=="backward"&&targetElement.position=="floating"){oldHelperNumberLayer.style.opacity=0}}_setHelperLayerPosition.call(self,oldHelperLayer);_setHelperLayerPosition.call(self,oldReferenceLayer);var fixParents=document.querySelectorAll(".introjs-fixParent");if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"")};}var oldShowElement=document.querySelector(".introjs-showElement");if(oldShowElement){oldShowElement.className=oldShowElement.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"")}if(self._lastShowElementTimer){clearTimeout(self._lastShowElementTimer)}self._lastShowElementTimer=setTimeout(function(){if(oldHelperNumberLayer!=null){oldHelperNumberLayer.innerHTML=targetElement.step}oldtooltipLayer.innerHTML=targetElement.intro;oldtooltipContainer.style.display="block";_placeTooltip.call(self,targetElement.element,oldtooltipContainer,oldArrowLayer,oldHelperNumberLayer);oldReferenceLayer.querySelector(".introjs-bullets li > a.active").className="";oldReferenceLayer.querySelector(".introjs-bullets li > a[data-stepnumber=\""+targetElement.step+"\"]").className="active";oldReferenceLayer.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+_getProgress.call(self)+"%;");oldtooltipContainer.style.opacity=1;if(oldHelperNumberLayer)oldHelperNumberLayer.style.opacity=1;if(nextTooltipButton.tabIndex===-1){skipTooltipButton.focus()}else{nextTooltipButton.focus()}},350)}else{var helperLayer=document.createElement("div"),referenceLayer=document.createElement("div"),arrowLayer=document.createElement("div"),tooltipLayer=document.createElement("div"),tooltipTextLayer=document.createElement("div"),bulletsLayer=document.createElement("div"),progressLayer=document.createElement("div"),buttonsLayer=document.createElement("div");helperLayer.className=highlightClass;referenceLayer.className="introjs-tooltipReferenceLayer";_setHelperLayerPosition.call(self,helperLayer);_setHelperLayerPosition.call(self,referenceLayer);this._targetElement.appendChild(helperLayer);this._targetElement.appendChild(referenceLayer);arrowLayer.className="introjs-arrow";tooltipTextLayer.className="introjs-tooltiptext";tooltipTextLayer.innerHTML=targetElement.intro;bulletsLayer.className="introjs-bullets";if(this._options.showBullets===false){bulletsLayer.style.display="none"}var ulContainer=document.createElement("ul");for(var i=0,stepsLength=this._introItems.length;i<stepsLength;i++){var innerLi=document.createElement("li");var anchorLink=document.createElement("a");anchorLink.onclick=function(){self.goToStep(this.getAttribute("data-stepnumber"))};if(i===targetElement.step-1)anchorLink.className="active";_setAnchorAsButton(anchorLink);anchorLink.innerHTML="&nbsp;";anchorLink.setAttribute("data-stepnumber",this._introItems[i].step);innerLi.appendChild(anchorLink);ulContainer.appendChild(innerLi)}bulletsLayer.appendChild(ulContainer);progressLayer.className="introjs-progress";if(this._options.showProgress===false){progressLayer.style.display="none"}var progressBar=document.createElement("div");progressBar.className="introjs-progressbar";progressBar.setAttribute("style","width:"+_getProgress.call(this)+"%;");progressLayer.appendChild(progressBar);buttonsLayer.className="introjs-tooltipbuttons";if(this._options.showButtons===false){buttonsLayer.style.display="none"}tooltipLayer.className="introjs-tooltip";tooltipLayer.appendChild(tooltipTextLayer);tooltipLayer.appendChild(bulletsLayer);tooltipLayer.appendChild(progressLayer);if(this._options.showStepNumbers==true){var helperNumberLayer=document.createElement("span");helperNumberLayer.className="introjs-helperNumberLayer";helperNumberLayer.innerHTML=targetElement.step;referenceLayer.appendChild(helperNumberLayer)}tooltipLayer.appendChild(arrowLayer);referenceLayer.appendChild(tooltipLayer);var nextTooltipButton=document.createElement("a");nextTooltipButton.onclick=function(){if(self._introItems.length-1!=self._currentStep){_nextStep.call(self)}};_setAnchorAsButton(nextTooltipButton);nextTooltipButton.innerHTML=this._options.nextLabel;var prevTooltipButton=document.createElement("a");prevTooltipButton.onclick=function(){if(self._currentStep!=0){_previousStep.call(self)}};_setAnchorAsButton(prevTooltipButton);prevTooltipButton.innerHTML=this._options.prevLabel;var skipTooltipButton=document.createElement("a");skipTooltipButton.className="introjs-button introjs-skipbutton";_setAnchorAsButton(skipTooltipButton);skipTooltipButton.innerHTML=this._options.skipLabel;skipTooltipButton.onclick=function(){if(self._introItems.length-1==self._currentStep&&typeof self._introCompleteCallback==="function"){self._introCompleteCallback.call(self)}if(self._introItems.length-1!=self._currentStep&&typeof self._introExitCallback==="function"){self._introExitCallback.call(self)}_exitIntro.call(self,self._targetElement)};buttonsLayer.appendChild(skipTooltipButton);if(this._introItems.length>1){buttonsLayer.appendChild(prevTooltipButton);buttonsLayer.appendChild(nextTooltipButton)}tooltipLayer.appendChild(buttonsLayer);_placeTooltip.call(self,targetElement.element,tooltipLayer,arrowLayer,helperNumberLayer)}if(this._options.disableInteraction===true){_disableInteraction.call(self)}prevTooltipButton.removeAttribute("tabIndex");nextTooltipButton.removeAttribute("tabIndex");if(this._currentStep==0&&this._introItems.length>1){nextTooltipButton.className="introjs-button introjs-nextbutton";if(this._options.hidePrev==true){prevTooltipButton.className="introjs-button introjs-prevbutton introjs-hidden";nextTooltipButton.className+=" introjs-fullbutton"}else{prevTooltipButton.className="introjs-button introjs-prevbutton introjs-disabled"}prevTooltipButton.tabIndex="-1";skipTooltipButton.innerHTML=this._options.skipLabel}else if(this._introItems.length-1==this._currentStep||this._introItems.length==1){skipTooltipButton.innerHTML=this._options.doneLabel;prevTooltipButton.className="introjs-button introjs-prevbutton";if(this._options.hideNext==true){nextTooltipButton.className="introjs-button introjs-nextbutton introjs-hidden";prevTooltipButton.className+=" introjs-fullbutton"}else{nextTooltipButton.className="introjs-button introjs-nextbutton introjs-disabled"}nextTooltipButton.tabIndex="-1"}else{prevTooltipButton.className="introjs-button introjs-prevbutton";nextTooltipButton.className="introjs-button introjs-nextbutton";skipTooltipButton.innerHTML=this._options.skipLabel}nextTooltipButton.focus();targetElement.element.className+=" introjs-showElement";var currentElementPosition=_getPropValue(targetElement.element,"position");if(currentElementPosition!=="absolute"&&currentElementPosition!=="relative"&&currentElementPosition!=="fixed"){targetElement.element.className+=" introjs-relativePosition"}var parentElm=targetElement.element.parentNode;while(parentElm!=null){if(!parentElm.tagName||parentElm.tagName.toLowerCase()==="body")break;var zIndex=_getPropValue(parentElm,"z-index");var opacity=parseFloat(_getPropValue(parentElm,"opacity"));var transform=_getPropValue(parentElm,"transform")||_getPropValue(parentElm,"-webkit-transform")||_getPropValue(parentElm,"-moz-transform")||_getPropValue(parentElm,"-ms-transform")||_getPropValue(parentElm,"-o-transform");if(/[0-9]+/.test(zIndex)||opacity<1||transform!=="none"&&transform!==undefined){parentElm.className+=" introjs-fixParent"}parentElm=parentElm.parentNode}if(!_elementInViewport(targetElement.element)&&this._options.scrollToElement===true){var rect=targetElement.element.getBoundingClientRect(),winHeight=_getWinSize().height,top=rect.bottom-(rect.bottom-rect.top),bottom=rect.bottom-winHeight;if(top<0||targetElement.element.clientHeight>winHeight){window.scrollBy(0,top-this._options.scrollPadding)}else{window.scrollBy(0,bottom+70+this._options.scrollPadding)}}if(typeof this._introAfterChangeCallback!=="undefined"){this._introAfterChangeCallback.call(this,targetElement.element)}}function _getPropValue(element,propName){var propValue="";if(element.currentStyle){propValue=element.currentStyle[propName]}else if(document.defaultView&&document.defaultView.getComputedStyle){propValue=document.defaultView.getComputedStyle(element,null).getPropertyValue(propName)}if(propValue&&propValue.toLowerCase){return propValue.toLowerCase()}else{return propValue}};function _isFixed(element){var p=element.parentNode;if(!p||p.nodeName==="HTML"){return false}if(_getPropValue(element,"position")=="fixed"){return true}return _isFixed(p)};function _getWinSize(){if(window.innerWidth!=undefined){return{width:window.innerWidth,height:window.innerHeight}}else{var D=document.documentElement;return{width:D.clientWidth,height:D.clientHeight}}}function _elementInViewport(el){var rect=el.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom+80<=window.innerHeight&&rect.right<=window.innerWidth}function _addOverlayLayer(targetElm){var overlayLayer=document.createElement("div"),styleText="",self=this;overlayLayer.className="introjs-overlay";if(!targetElm.tagName||targetElm.tagName.toLowerCase()==="body"){styleText+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;";overlayLayer.setAttribute("style",styleText)}else{var elementPosition=_getOffset(targetElm);if(elementPosition){styleText+="width: "+elementPosition.width+"px; height:"+elementPosition.height+"px; top:"+elementPosition.top+"px;left: "+elementPosition.left+"px;";overlayLayer.setAttribute("style",styleText)}}targetElm.appendChild(overlayLayer);overlayLayer.onclick=function(){if(self._options.exitOnOverlayClick==true){if(self._introExitCallback!=undefined){self._introExitCallback.call(self)}_exitIntro.call(self,targetElm)}};setTimeout(function(){styleText+="opacity: "+self._options.overlayOpacity.toString()+";";overlayLayer.setAttribute("style",styleText)},10);return true};function _removeHintTooltip(){var tooltip=this._targetElement.querySelector(".introjs-hintReference");if(tooltip){var step=tooltip.getAttribute("data-step");tooltip.parentNode.removeChild(tooltip);return step}};function _populateHints(targetElm){var self=this;this._introItems=[];if(this._options.hints){for(var i=0,l=this._options.hints.length;i<l;i++){var currentItem=_cloneObject(this._options.hints[i]);if(typeof currentItem.element==="string"){currentItem.element=document.querySelector(currentItem.element)}currentItem.hintPosition=currentItem.hintPosition||this._options.hintPosition;currentItem.hintAnimation=currentItem.hintAnimation||this._options.hintAnimation;if(currentItem.element!=null){this._introItems.push(currentItem)}}}else{var hints=targetElm.querySelectorAll("*[data-hint]");if(hints.length<1){return false}for(var i=0,l=hints.length;i<l;i++){var currentElement=hints[i];var hintAnimation=currentElement.getAttribute("data-hintAnimation");if(hintAnimation){hintAnimation=hintAnimation=="true"}else{hintAnimation=this._options.hintAnimation}this._introItems.push({element:currentElement,hint:currentElement.getAttribute("data-hint"),hintPosition:currentElement.getAttribute("data-hintPosition")||this._options.hintPosition,hintAnimation:hintAnimation,tooltipClass:currentElement.getAttribute("data-tooltipClass"),position:currentElement.getAttribute("data-position")||this._options.tooltipPosition})}}_addHints.call(this);if(document.addEventListener){document.addEventListener("click",_removeHintTooltip.bind(this),false);window.addEventListener("resize",_reAlignHints.bind(this),true)}else if(document.attachEvent){document.attachEvent("onclick",_removeHintTooltip.bind(this));document.attachEvent("onresize",_reAlignHints.bind(this))}};function _reAlignHints(){for(var i=0,l=this._introItems.length;i<l;i++){var item=this._introItems[i];if(typeof item.targetElement=="undefined")continue;_alignHintPosition.call(this,item.hintPosition,item.element,item.targetElement)}}function _hideHint(stepId){_removeHintTooltip.call(this);var hint=this._targetElement.querySelector(".introjs-hint[data-step=\""+stepId+"\"]");if(hint){hint.className+=" introjs-hidehint"}if(typeof this._hintCloseCallback!=="undefined"){this._hintCloseCallback.call(this,stepId)}};function _hideHints(){var hints=this._targetElement.querySelectorAll(".introjs-hint");if(hints&&hints.length>0){for(var i=0;i<hints.length;i++){_hideHint.call(this,hints[i].getAttribute("data-step"))}}};function _addHints(){var self=this;var oldHintsWrapper=document.querySelector(".introjs-hints");if(oldHintsWrapper!=null){hintsWrapper=oldHintsWrapper}else{var hintsWrapper=document.createElement("div");hintsWrapper.className="introjs-hints"}for(var i=0,l=this._introItems.length;i<l;i++){var item=this._introItems[i];if(document.querySelector(".introjs-hint[data-step=\""+i+"\"]"))continue;var hint=document.createElement("a");_setAnchorAsButton(hint);(function(hint,item,i){hint.onclick=function(e){var evt=e?e:window.event;if(evt.stopPropagation)evt.stopPropagation();if(evt.cancelBubble!=null)evt.cancelBubble=true;_hintClick.call(self,hint,item,i)}})(hint,item,i);hint.className="introjs-hint";if(!item.hintAnimation){hint.className+=" introjs-hint-no-anim"}if(_isFixed(item.element)){hint.className+=" introjs-fixedhint"}var hintDot=document.createElement("div");hintDot.className="introjs-hint-dot";var hintPulse=document.createElement("div");hintPulse.className="introjs-hint-pulse";hint.appendChild(hintDot);hint.appendChild(hintPulse);hint.setAttribute("data-step",i);item.targetElement=item.element;item.element=hint;_alignHintPosition.call(this,item.hintPosition,hint,item.targetElement);hintsWrapper.appendChild(hint)}document.body.appendChild(hintsWrapper);if(typeof this._hintsAddedCallback!=="undefined"){this._hintsAddedCallback.call(this)}};function _alignHintPosition(position,hint,element){var offset=_getOffset.call(this,element);switch(position){default:case"top-left":hint.style.left=offset.left+"px";hint.style.top=offset.top+"px";break;case"top-right":hint.style.left=offset.left+offset.width+"px";hint.style.top=offset.top+"px";break;case"bottom-left":hint.style.left=offset.left+"px";hint.style.top=offset.top+offset.height+"px";break;case"bottom-right":hint.style.left=offset.left+offset.width+"px";hint.style.top=offset.top+offset.height+"px";break;case"bottom-middle":hint.style.left=offset.left+offset.width/2+"px";hint.style.top=offset.top+offset.height+"px";break;case"top-middle":hint.style.left=offset.left+offset.width/2+"px";hint.style.top=offset.top+"px";break;}};function _hintClick(hintElement,item,stepId){if(typeof this._hintClickCallback!=="undefined"){this._hintClickCallback.call(this,hintElement,item,stepId)}var removedStep=_removeHintTooltip.call(this);if(parseInt(removedStep,10)==stepId){return}var tooltipLayer=document.createElement("div");var tooltipTextLayer=document.createElement("div");var arrowLayer=document.createElement("div");var referenceLayer=document.createElement("div");tooltipLayer.className="introjs-tooltip";tooltipLayer.onclick=function(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}};tooltipTextLayer.className="introjs-tooltiptext";var tooltipWrapper=document.createElement("p");tooltipWrapper.innerHTML=item.hint;var closeButton=document.createElement("a");closeButton.className="introjs-button";closeButton.innerHTML=this._options.hintButtonLabel;closeButton.onclick=_hideHint.bind(this,stepId);tooltipTextLayer.appendChild(tooltipWrapper);tooltipTextLayer.appendChild(closeButton);arrowLayer.className="introjs-arrow";tooltipLayer.appendChild(arrowLayer);tooltipLayer.appendChild(tooltipTextLayer);this._currentStep=hintElement.getAttribute("data-step");referenceLayer.className="introjs-tooltipReferenceLayer introjs-hintReference";referenceLayer.setAttribute("data-step",hintElement.getAttribute("data-step"));_setHelperLayerPosition.call(this,referenceLayer);referenceLayer.appendChild(tooltipLayer);document.body.appendChild(referenceLayer);_placeTooltip.call(this,hintElement,tooltipLayer,arrowLayer,null,true)};function _getOffset(element){var elementPosition={};elementPosition.width=element.offsetWidth;elementPosition.height=element.offsetHeight;var _x=0;var _y=0;while(element&&!isNaN(element.offsetLeft)&&!isNaN(element.offsetTop)){_x+=element.offsetLeft;_y+=element.offsetTop;element=element.offsetParent}elementPosition.top=_y;elementPosition.left=_x;return elementPosition};function _getProgress(){var currentStep=parseInt(this._currentStep+1,10);return currentStep/this._introItems.length*100};function _mergeOptions(obj1,obj2){var obj3={};for(var attrname in obj1){obj3[attrname]=obj1[attrname]}for(var attrname in obj2){obj3[attrname]=obj2[attrname]}return obj3};var introJs=function introJs(targetElm){if(_typeof(targetElm)==="object"){return new IntroJs(targetElm)}else if(typeof targetElm==="string"){var targetElement=document.querySelector(targetElm);if(targetElement){return new IntroJs(targetElement)}else{throw new Error("There is no element with given selector.")}}else{return new IntroJs(document.body)}};introJs.version=VERSION;introJs.fn=IntroJs.prototype={clone:function clone(){return new IntroJs(this)},setOption:function setOption(option,value){this._options[option]=value;return this},setOptions:function setOptions(options){this._options=_mergeOptions(this._options,options);return this},start:function start(){_introForElement.call(this,this._targetElement);return this},goToStep:function goToStep(step){_goToStep.call(this,step);return this},nextStep:function nextStep(){_nextStep.call(this);return this},previousStep:function previousStep(){_previousStep.call(this);return this},exit:function exit(){_exitIntro.call(this,this._targetElement);return this},refresh:function refresh(){_setHelperLayerPosition.call(this,document.querySelector(".introjs-helperLayer"));_setHelperLayerPosition.call(this,document.querySelector(".introjs-tooltipReferenceLayer"));_reAlignHints.call(this);return this},onbeforechange:function onbeforechange(providedCallback){if(typeof providedCallback==="function"){this._introBeforeChangeCallback=providedCallback}else{throw new Error("Provided callback for onbeforechange was not a function")}return this},onchange:function onchange(providedCallback){if(typeof providedCallback==="function"){this._introChangeCallback=providedCallback}else{throw new Error("Provided callback for onchange was not a function.")}return this},onafterchange:function onafterchange(providedCallback){if(typeof providedCallback==="function"){this._introAfterChangeCallback=providedCallback}else{throw new Error("Provided callback for onafterchange was not a function")}return this},oncomplete:function oncomplete(providedCallback){if(typeof providedCallback==="function"){this._introCompleteCallback=providedCallback}else{throw new Error("Provided callback for oncomplete was not a function.")}return this},onhintsadded:function onhintsadded(providedCallback){if(typeof providedCallback==="function"){this._hintsAddedCallback=providedCallback}else{throw new Error("Provided callback for onhintsadded was not a function.")}return this},onhintclick:function onhintclick(providedCallback){if(typeof providedCallback==="function"){this._hintClickCallback=providedCallback}else{throw new Error("Provided callback for onhintclick was not a function.")}return this},onhintclose:function onhintclose(providedCallback){if(typeof providedCallback==="function"){this._hintCloseCallback=providedCallback}else{throw new Error("Provided callback for onhintclose was not a function.")}return this},onexit:function onexit(providedCallback){if(typeof providedCallback==="function"){this._introExitCallback=providedCallback}else{throw new Error("Provided callback for onexit was not a function.")}return this},addHints:function addHints(){_populateHints.call(this,this._targetElement);return this},hideHint:function hideHint(stepId){_hideHint.call(this,stepId);return this},hideHints:function hideHints(){_hideHints.call(this);return this}};exports.introJs=introJs;return introJs});define("extensions/adapt-intro/js/adapt-intro",["coreJS/adapt","./intro"],function(Adapt,introJs){var IntroView=Backbone.View.extend({initialize:function initialize(){var data=this.model.toJSON();var template=Handlebars.templates.intro;this.setElement(template(data)).$el.appendTo($(".navigation-inner"));this.listenTo(Adapt,{"navigation:openIntro":this.startIntro})},getElements:function getElements(path){if(!path._isEnabled||!path._steps[0])return;for(i=0;i<path._steps.length;i++){this.assignIntro(path._steps[i]._element,path._steps[i].text,i+1,path._steps[i]._position)}},startIntro:function startIntro(){var introPath=Adapt.course.attributes._intro;this.getElements(introPath);introJs().setOptions(introPath._options).start()},assignIntro:function assignIntro(className,text,introOrder,introPosition){var htmlElement=document.getElementsByClassName(className)[0];if(!htmlElement)return;var introText=document.createAttribute("data-intro");introText.value=text;var step=document.createAttribute("data-step");step.value=introOrder;var position=document.createAttribute("data-position");position.value=introPosition;htmlElement.setAttributeNode(step);htmlElement.setAttributeNode(position);htmlElement.setAttributeNode(introText);console.log(htmlElement)}});Adapt.on("pageView:preRender",function(){if(!Adapt.course.get("_intro")||!Adapt.course.get("_intro")._isEnabled)return;showOrCreate()});Adapt.on("menuView:preRender",function(){if(!Adapt.course.get("_intro")||!Adapt.course.get("_intro")._isEnabled)return;if(!this.course.attributes._intro._showOnMenu){$(".navigation-intro").hide()}else{showOrCreate()}});function showOrCreate(){if($(".navigation-intro").length){$(".navigation-intro").show()}else{new IntroView({model:new Backbone.Model})}}});define("extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt",["core/js/adapt"],function(Adapt){var PageIncompletePrompt=Backbone.Controller.extend({PLUGIN_NAME:"_pageIncompletePrompt",handleRoute:true,inPage:false,inPopup:false,isChangingLanguage:false,pageModel:null,model:null,_ignoreAccessibilityNavigation:false,initialize:function initialize(){this.setupEventListeners()},setupEventListeners:function setupEventListeners(){this.listenTo(Adapt,{"app:languageChanged":this.onLanguageChanging,"pageView:ready":this.onPageViewReady,"pageIncompletePrompt:leavePage":this.onLeavePage,"pageIncompletePrompt:cancel":this.onLeaveCancel,"router:navigate":this.onRouterNavigate});this.listenToOnce(Adapt,"app:dataLoaded",function(){this.setupModel();this.listenTo(Adapt,"accessibility:toggle",this.onAccessibilityToggle)})},onLanguageChanging:function onLanguageChanging(){this.isChangingLanguage=true;this.setupModel();Adapt.once("router:page",function(){this.isChangingLanguage=false}.bind(this))},setupModel:function setupModel(){this.model=Adapt.course.get(this.PLUGIN_NAME)},onPageViewReady:function onPageViewReady(){this.inPage=true;this.pageModel=Adapt.findById(Adapt.location._currentId)},onLeavePage:function onLeavePage(){if(!this.inPopup)return;this.inPopup=false;this.stopListening(Adapt,"notify:cancelled");this.enableRouterNavigation(true);this.handleRoute=false;this.inPage=false;window.location.href=this.href;this.handleRoute=true},onLeaveCancel:function onLeaveCancel(){if(!this.inPopup)return;this.inPopup=false;this.stopListening(Adapt,"notify:cancelled");this.enableRouterNavigation(true);this.handleRoute=true},onRouterNavigate:function onRouterNavigate(routeArguments){if(!this.isEnabled()||this.pageModel.get("_isComplete"))return;this.href=window.location.href;var id=routeArguments[0];if(id){if(id===Adapt.location._currentId)return;var model=Adapt.findById(id);var parent=model&&model.findAncestor("contentObjects");if(parent&&parent.get("_id")===this.pageModel.get("_id")){return}}if(this._ignoreAccessibilityNavigation){this._ignoreAccessibilityNavigation=false;return}this.enableRouterNavigation(false);this.showPrompt()},onAccessibilityToggle:function onAccessibilityToggle(){if(Adapt.device.touch){this._ignoreAccessibilityNavigation=false;return}this._ignoreAccessibilityNavigation=true},showPrompt:function showPrompt(){var classes="is-pageincomplete ";classes+=this.model._classes||"";var promptObject={title:this.model.title,body:this.model.message,_classes:classes,_prompts:[{promptText:this.model._buttons.yes,_callbackEvent:"pageIncompletePrompt:leavePage"},{promptText:this.model._buttons.no,_callbackEvent:"pageIncompletePrompt:cancel"}],_showIcon:true};var pipConfig=this.pageModel.get("_pageIncompletePrompt");if(pipConfig&&pipConfig._buttons){promptObject.title=pipConfig.title;promptObject.body=pipConfig.message;promptObject._classes=pipConfig._classes;promptObject._prompts[0].promptText=pipConfig._buttons.yes;promptObject._prompts[1].promptText=pipConfig._buttons.no}this.listenToOnce(Adapt,"notify:cancelled",this.onLeaveCancel);Adapt.trigger("notify:prompt",promptObject);this.inPopup=true},isEnabled:function isEnabled(){if(!Adapt.location._currentId)return false;if(!this.handleRoute)return false;if(!this.inPage)return false;if(this.inPopup)return false;if(this.isChangingLanguage)return false;switch(Adapt.location._contentType){case"menu":case"course":this.inPage=false;return false;}var pageModel=Adapt.findById(Adapt.location._currentId);if(pageModel.get("_isOptional"))return false;var isEnabledForCourse=this.model&&!!this.model._isEnabled;var isEnabledForPage=pageModel.get("_pageIncompletePrompt")&&!!pageModel.get("_pageIncompletePrompt")._isEnabled;return isEnabledForCourse&&isEnabledForPage!==false||isEnabledForPage},enableRouterNavigation:function enableRouterNavigation(value){Adapt.router.set("_canNavigate",value,{pluginName:this.PLUGIN_NAME})}});return new PageIncompletePrompt});define("extensions/adapt-search/js/searchDrawerItemView",["core/js/adapt"],function(Adapt){var SearchDrawerItemView=Backbone.View.extend({className:"search",events:{"click .js-search-textbox-change":"search","keyup .js-search-textbox-change":"search"},initialize:function initialize(options){this.listenTo(Adapt,"drawer:empty",this.remove);this.render();this.search=_.debounce(this.search.bind(this),1000);if(options.query){this.$(".js-search-textbox-change").val(options.query)}},render:function render(){var data=this.model.toJSON();var template=Handlebars.templates["searchBox"];$(this.el).html(template(data));return this},search:function search(event){if(event&&event.preventDefault)event.preventDefault();var searchVal=this.$(".js-search-textbox-change").val();Adapt.trigger("search:filterTerms",searchVal)}});return SearchDrawerItemView});define("extensions/adapt-search/js/search-algorithm",["core/js/adapt"],function(Adapt){var searchDefaults={_searchAttributes:[{"_attributeName":"_search","_level":1,"_allowTextPreview":false},{"_attributeName":"_keywords","_level":1,"_allowTextPreview":false},{"_attributeName":"keywords","_level":1,"_allowTextPreview":false},{"_attributeName":"displayTitle","_level":2,"_allowTextPreview":true},{"_attributeName":"title","_level":2,"_allowTextPreview":false},{"_attributeName":"body","_level":3,"_allowTextPreview":true},{"_attributeName":"alt","_level":4,"_allowTextPreview":false},{"_attributeName":"_alt","_level":4,"_allowTextPreview":false},{"_attributeName":"_items","_level":5,"_allowTextPreview":false},{"_attributeName":"items","_level":5,"_allowTextPreview":false},{"_attributeName":"text","_level":5,"_allowTextPreview":true}],_hideComponents:["blank"],_hideTypes:[],_ignoreWords:["a","an","and","are","as","at","be","by","for","from","has","he","in","is","it","its","of","on","that","the","to","was","were","will","wish",""],_matchOn:{_contentWordBeginsPhraseWord:false,_contentWordContainsPhraseWord:false,_contentWordEqualsPhraseWord:true,_phraseWordBeginsContentWord:true},_scoreQualificationThreshold:20,_minimumWordLength:2,_frequencyImportance:5};var wordCharacters=["A-Z","0-9","a-z","\xAA","\xB5","\xBA","\xC0-\xD6","\xD8-\xF6","\xF8-\u02C1","\u02C6-\u02D1","\u02E0-\u02E4","\u02EC","\u02EE","\u0370-\u0374","\u0376","\u0377","\u037A-\u037D","\u0386","\u0388-\u038A","\u038C","\u038E-\u03A1","\u03A3-\u03F5","\u03F7-\u0481","\u048A-\u0527","\u0531-\u0556","\u0559","\u0561-\u0587","\u05D0-\u05EA","\u05F0-\u05F2","\u0620-\u064A","\u066E","\u066F","\u0671-\u06D3","\u06D5","\u06E5","\u06E6","\u06EE","\u06EF","\u06FA-\u06FC","\u06FF","\u0710","\u0712-\u072F","\u074D-\u07A5","\u07B1","\u07CA-\u07EA","\u07F4","\u07F5","\u07FA","\u0800-\u0815","\u081A","\u0824","\u0828","\u0840-\u0858","\u08A0","\u08A2-\u08AC","\u0904-\u0939","\u093D","\u0950","\u0958-\u0961","\u0971-\u0977","\u0979-\u097F","\u0985-\u098C","\u098F","\u0990","\u0993-\u09A8","\u09AA-\u09B0","\u09B2","\u09B6-\u09B9","\u09BD","\u09CE","\u09DC","\u09DD","\u09DF-\u09E1","\u09F0","\u09F1","\u0A05-\u0A0A","\u0A0F","\u0A10","\u0A13-\u0A28","\u0A2A-\u0A30","\u0A32","\u0A33","\u0A35","\u0A36","\u0A38","\u0A39","\u0A59-\u0A5C","\u0A5E","\u0A72-\u0A74","\u0A85-\u0A8D","\u0A8F-\u0A91","\u0A93-\u0AA8","\u0AAA-\u0AB0","\u0AB2","\u0AB3","\u0AB5-\u0AB9","\u0ABD","\u0AD0","\u0AE0","\u0AE1","\u0B05-\u0B0C","\u0B0F","\u0B10","\u0B13-\u0B28","\u0B2A-\u0B30","\u0B32","\u0B33","\u0B35-\u0B39","\u0B3D","\u0B5C","\u0B5D","\u0B5F-\u0B61","\u0B71","\u0B83","\u0B85-\u0B8A","\u0B8E-\u0B90","\u0B92-\u0B95","\u0B99","\u0B9A","\u0B9C","\u0B9E","\u0B9F","\u0BA3","\u0BA4","\u0BA8-\u0BAA","\u0BAE-\u0BB9","\u0BD0","\u0C05-\u0C0C","\u0C0E-\u0C10","\u0C12-\u0C28","\u0C2A-\u0C33","\u0C35-\u0C39","\u0C3D","\u0C58","\u0C59","\u0C60","\u0C61","\u0C85-\u0C8C","\u0C8E-\u0C90","\u0C92-\u0CA8","\u0CAA-\u0CB3","\u0CB5-\u0CB9","\u0CBD","\u0CDE","\u0CE0","\u0CE1","\u0CF1","\u0CF2","\u0D05-\u0D0C","\u0D0E-\u0D10","\u0D12-\u0D3A","\u0D3D","\u0D4E","\u0D60","\u0D61","\u0D7A-\u0D7F","\u0D85-\u0D96","\u0D9A-\u0DB1","\u0DB3-\u0DBB","\u0DBD","\u0DC0-\u0DC6","\u0E01-\u0E30","\u0E32","\u0E33","\u0E40-\u0E46","\u0E81","\u0E82","\u0E84","\u0E87","\u0E88","\u0E8A","\u0E8D","\u0E94-\u0E97","\u0E99-\u0E9F","\u0EA1-\u0EA3","\u0EA5","\u0EA7","\u0EAA","\u0EAB","\u0EAD-\u0EB0","\u0EB2","\u0EB3","\u0EBD","\u0EC0-\u0EC4","\u0EC6","\u0EDC-\u0EDF","\u0F00","\u0F40-\u0F47","\u0F49-\u0F6C","\u0F88-\u0F8C","\u1000-\u102A","\u103F","\u1050-\u1055","\u105A-\u105D","\u1061","\u1065","\u1066","\u106E-\u1070","\u1075-\u1081","\u108E","\u10A0-\u10C5","\u10C7","\u10CD","\u10D0-\u10FA","\u10FC-\u1248","\u124A-\u124D","\u1250-\u1256","\u1258","\u125A-\u125D","\u1260-\u1288","\u128A-\u128D","\u1290-\u12B0","\u12B2-\u12B5","\u12B8-\u12BE","\u12C0","\u12C2-\u12C5","\u12C8-\u12D6","\u12D8-\u1310","\u1312-\u1315","\u1318-\u135A","\u1380-\u138F","\u13A0-\u13F4","\u1401-\u166C","\u166F-\u167F","\u1681-\u169A","\u16A0-\u16EA","\u1700-\u170C","\u170E-\u1711","\u1720-\u1731","\u1740-\u1751","\u1760-\u176C","\u176E-\u1770","\u1780-\u17B3","\u17D7","\u17DC","\u1820-\u1877","\u1880-\u18A8","\u18AA","\u18B0-\u18F5","\u1900-\u191C","\u1950-\u196D","\u1970-\u1974","\u1980-\u19AB","\u19C1-\u19C7","\u1A00-\u1A16","\u1A20-\u1A54","\u1AA7","\u1B05-\u1B33","\u1B45-\u1B4B","\u1B83-\u1BA0","\u1BAE","\u1BAF","\u1BBA-\u1BE5","\u1C00-\u1C23","\u1C4D-\u1C4F","\u1C5A-\u1C7D","\u1CE9-\u1CEC","\u1CEE-\u1CF1","\u1CF5","\u1CF6","\u1D00-\u1DBF","\u1E00-\u1F15","\u1F18-\u1F1D","\u1F20-\u1F45","\u1F48-\u1F4D","\u1F50-\u1F57","\u1F59","\u1F5B","\u1F5D","\u1F5F-\u1F7D","\u1F80-\u1FB4","\u1FB6-\u1FBC","\u1FBE","\u1FC2-\u1FC4","\u1FC6-\u1FCC","\u1FD0-\u1FD3","\u1FD6-\u1FDB","\u1FE0-\u1FEC","\u1FF2-\u1FF4","\u1FF6-\u1FFC","\u2071","\u207F","\u2090-\u209C","\u2102","\u2107","\u210A-\u2113","\u2115","\u2119-\u211D","\u2124","\u2126","\u2128","\u212A-\u212D","\u212F-\u2139","\u213C-\u213F","\u2145-\u2149","\u214E","\u2183","\u2184","\u2C00-\u2C2E","\u2C30-\u2C5E","\u2C60-\u2CE4","\u2CEB-\u2CEE","\u2CF2","\u2CF3","\u2D00-\u2D25","\u2D27","\u2D2D","\u2D30-\u2D67","\u2D6F","\u2D80-\u2D96","\u2DA0-\u2DA6","\u2DA8-\u2DAE","\u2DB0-\u2DB6","\u2DB8-\u2DBE","\u2DC0-\u2DC6","\u2DC8-\u2DCE","\u2DD0-\u2DD6","\u2DD8-\u2DDE","\u2E2F","\u3005","\u3006","\u3031-\u3035","\u303B","\u303C","\u3041-\u3096","\u309D-\u309F","\u30A1-\u30FA","\u30FC-\u30FF","\u3105-\u312D","\u3131-\u318E","\u31A0-\u31BA","\u31F0-\u31FF","\u3400-\u4DB5","\u4E00-\u9FCC","\uA000-\uA48C","\uA4D0-\uA4FD","\uA500-\uA60C","\uA610-\uA61F","\uA62A","\uA62B","\uA640-\uA66E","\uA67F-\uA697","\uA6A0-\uA6E5","\uA717-\uA71F","\uA722-\uA788","\uA78B-\uA78E","\uA790-\uA793","\uA7A0-\uA7AA","\uA7F8-\uA801","\uA803-\uA805","\uA807-\uA80A","\uA80C-\uA822","\uA840-\uA873","\uA882-\uA8B3","\uA8F2-\uA8F7","\uA8FB","\uA90A-\uA925","\uA930-\uA946","\uA960-\uA97C","\uA984-\uA9B2","\uA9CF","\uAA00-\uAA28","\uAA40-\uAA42","\uAA44-\uAA4B","\uAA60-\uAA76","\uAA7A","\uAA80-\uAAAF","\uAAB1","\uAAB5","\uAAB6","\uAAB9-\uAABD","\uAAC0","\uAAC2","\uAADB-\uAADD","\uAAE0-\uAAEA","\uAAF2-\uAAF4","\uAB01-\uAB06","\uAB09-\uAB0E","\uAB11-\uAB16","\uAB20-\uAB26","\uAB28-\uAB2E","\uABC0-\uABE2","\uAC00-\uD7A3","\uD7B0-\uD7C6","\uD7CB-\uD7FB","\uF900-\uFA6D","\uFA70-\uFAD9","\uFB00-\uFB06","\uFB13-\uFB17","\uFB1D","\uFB1F-\uFB28","\uFB2A-\uFB36","\uFB38-\uFB3C","\uFB3E","\uFB40","\uFB41","\uFB43","\uFB44","\uFB46-\uFBB1","\uFBD3-\uFD3D","\uFD50-\uFD8F","\uFD92-\uFDC7","\uFDF0-\uFDFB","\uFE70-\uFE74","\uFE76-\uFEFC","\uFF21-\uFF3A","\uFF41-\uFF5A","\uFF66-\uFFBE","\uFFC2-\uFFC7","\uFFCA-\uFFCF","\uFFD2-\uFFD7","\uFFDA-\uFFDC"];wordCharacters=wordCharacters.join("");var search=_.extend({model:null,_searchableModels:null,_wordIndex:null,_regularExpressions:{matchNotWordBoundaries:new RegExp("["+wordCharacters+"]+","g"),trimReplaceNonWordCharacters:new RegExp("^([^"+wordCharacters+"])+|([^"+wordCharacters+"])+$","g"),trimReplaceWhitespace:/^\s+|\s+$/g,escapeRegExp:function escapeRegExp(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},initialize:function initialize(){this.setupListeners()},setupListeners:function setupListeners(){this.listenTo(Adapt,{"app:dataReady":this.onDataReady,"app:languageChanged":this.clearSearchResults})},clearSearchResults:function clearSearchResults(){Adapt.trigger("search:filterTerms","")},onDataReady:function onDataReady(){var config=Adapt.course.get("_search");if(!config||config._isEnabled===false)return;this.setupConfig();this._searchableModels=this.collectModelTexts();this.makeModelTextProfiles();this.indexTextProfiles();Adapt.trigger("search-algorithm:ready")},setupConfig:function setupConfig(){var model=Adapt.course.get("_search")||{};var modelWithDefaults=_.extend(searchDefaults,model);Adapt.course.set("_search",modelWithDefaults);this.model=new Backbone.Model(modelWithDefaults)},collectModelTexts:function collectModelTexts(){var searchAttributes=this.model.get("_searchAttributes");var hideComponents=this.model.get("_hideComponents");var hideTypes=this.model.get("_hideTypes");var regularExpressions=this._regularExpressions;function combineAdaptModels(){var rtn=[].concat(Adapt.contentObjects.models).concat(Adapt.articles.models).concat(Adapt.blocks.models).concat(Adapt.components.models);var filtered=_.filter(rtn,function(model){var type=model.get("_type"),displayTitle,title;if(_.contains(hideTypes,type))return false;if(type=="component"){var component=model.get("_component");if(_.contains(hideComponents,component))return false}if(model.has("displayTitle"))displayTitle=model.get("displayTitle").replace(regularExpressions.trimReplaceWhitespace,"");if(model.has("title"))title=model.get("title").replace(regularExpressions.trimReplaceWhitespace,"");if(!displayTitle&&!title)return false;return true});return filtered}function getSearchableModels(){var adaptModels=combineAdaptModels();var searchable=[];for(var i=0,l=adaptModels.length;i<l;i++){var model=adaptModels[i];if(!isModelSearchable(model))continue;var json=model.toJSON();var searchProfile={"_raw":recursivelyCollectModelTexts(json)};model.set("_searchProfile",searchProfile);searchable.push(model)}return new Backbone.Collection(searchable)}function isModelSearchable(model){var trail=model.getAncestorModels(true);var config=model.get("_search");if(config&&config._isEnabled===false)return false;var firstDisabledTrailItem=_.find(trail,function(item){var config=item.get("_search");if(!config)return false;if(config&&config._isEnabled!==false)return false;return true});return firstDisabledTrailItem===undefined}function recursivelyCollectModelTexts(json,level){var texts=[];for(var i=0,l=searchAttributes.length;i<l;i++){var attributeObject=searchAttributes[i];if(!json[attributeObject._attributeName])continue;switch(_typeof(json[attributeObject._attributeName])){case"object":if(json[attributeObject._attributeName]instanceof Array){for(var sa=0,sal=json[attributeObject._attributeName].length;sa<sal;sa++){switch(_typeof(json[attributeObject._attributeName][sa])){case"object":texts=texts.concat(recursivelyCollectModelTexts(json[attributeObject._attributeName][sa],attributeObject._level));break;case"string":addString(json[attributeObject._attributeName][sa],attributeObject._level,attributeObject);}}}else{texts=texts.concat(recursivelyCollectModelTexts(json[attributeObject._attributeName],attributeObject._level))}break;case"string":addString(json[attributeObject._attributeName],level,attributeObject);break;}}return texts;function addString(string,level,attributeObject){var textLevel=level||attributeObject._level;var text=$("<div>"+string.replace(regularExpressions.trimReplaceWhitespace,"")+"</div>").text();text=text.replace(regularExpressions.trimReplaceWhitespace,"");if(!text)return;texts.push({score:1/textLevel,text:text,searchAttribute:attributeObject})}}return getSearchableModels()},makeModelTextProfiles:function makeModelTextProfiles(){var ignoreWords=this.model.get("_ignoreWords")instanceof Array?this.model.get("_ignoreWords"):this.model.get("_ignoreWords").split(",");var regularExpressions=this._regularExpressions;var searchAttributes=this.model.get("_searchAttributes");var minimumWordLength=this.model.get("_minimumWordLength");var scores=_.uniq(_.pluck(searchAttributes,"_level"));scores=_.map(scores,function(l){return 1/l});for(var i=0,l=this._searchableModels.models.length;i<l;i++){var item=this._searchableModels.models[i];var profile=item.get("_searchProfile");makeModelPhraseProfile(profile);makeModelPhraseWordAndWordProfile(profile)}function makeModelPhraseProfile(profile){profile._phrases=[];var phrases=_.groupBy(profile._raw,function(phrase){return phrase.text});for(var p in phrases){var bestItem=_.max(phrases[p],function(item){return item.score});profile._phrases.push({searchAttribute:bestItem.searchAttribute,phrase:bestItem.text,score:bestItem.score,words:[]})}return profile}function makeModelPhraseWordAndWordProfile(profile){profile._words=[];for(var l=0,ll=scores.length;l<ll;l++){var score=scores[l];var phrases=_.where(profile._phrases,{score:score});var scoreWords=[];for(var i=0,pl=phrases.length;i<pl;i++){var phraseObject=phrases[i];var chunks=phraseObject.phrase.match(regularExpressions.matchNotWordBoundaries);var words=_.map(chunks,function(chunk){return chunk.replace(regularExpressions.trimReplaceNonWordCharacters,"")});phraseObject.words=_.countBy(words,function(word){return word.toLowerCase()});phraseObject.words=_.omit(phraseObject.words,ignoreWords);scoreWords=scoreWords.concat(words)}scoreWords=_.filter(scoreWords,function(word){return word.length>=minimumWordLength});scoreWords=_.countBy(scoreWords,function(word){return word.toLowerCase()});scoreWords=_.omit(scoreWords,ignoreWords);for(var word in scoreWords){profile._words.push({word:word,score:score,count:scoreWords[word]})}}return profile}},indexTextProfiles:function indexTextProfiles(){this._wordIndex={};for(var i=0,il=this._searchableModels.models.length;i<il;i++){var item=this._searchableModels.models[i];var id=item.get("_id");var searchProfile=item.get("_searchProfile");for(var w=0,wl=searchProfile._words.length;w<wl;w++){var word=searchProfile._words[w].word;if(Object.prototype.hasOwnProperty&&!this._wordIndex.hasOwnProperty(word)){this._wordIndex[word]=[]}else{this._wordIndex[word]=this._wordIndex[word]||[]}this._wordIndex[word].push(id)}}for(var _word in this._wordIndex){this._wordIndex[_word]=_.uniq(this._wordIndex[_word])}},find:function find(findPhrase){var regularExpressions=this._regularExpressions;var wordIndex=this._wordIndex;var ignoreWords=this.model.get("_ignoreWords")instanceof Array?this.model.get("_ignoreWords"):this.model.get("_ignoreWords").split(",");var scoreQualificationThreshold=this.model.get("_scoreQualificationThreshold");var minimumWordLength=this.model.get("_minimumWordLength");var frequencyImportance=this.model.get("_frequencyImportance");var matchOn=this.model.get("_matchOn")||{};var json=this._searchableModels.toJSON();function getFindPhraseWords(findPhrase){var findChunks=findPhrase.match(regularExpressions.matchNotWordBoundaries);var findWords=_.map(findChunks,function(chunk){return chunk.replace(regularExpressions.trimReplaceNonWordCharacters,"")});findWords=_.countBy(findWords,function(word){return word.toLowerCase()});findWords=_.omit(findWords,ignoreWords);findWords=_.omit(findWords,function(count,item){return item.length<minimumWordLength});return findWords}function getMatchingIdScoreObjects(findWords){var matchingIdScoreObjects={};for(var findWord in findWords){for(var indexWord in wordIndex){var rIndexWordBegins=new RegExp("^"+regularExpressions.escapeRegExp(indexWord),"g");var rFindWordContains=new RegExp(regularExpressions.escapeRegExp(findWord),"g");var rFindWordBegins=new RegExp("^"+regularExpressions.escapeRegExp(findWord),"g");var isIndexBeginsMatch=matchOn._contentWordBeginsPhraseWord===false?false:rIndexWordBegins.test(findWord);var isFindContainsMatch=matchOn._contentWordContainsPhraseWord===false?false:rFindWordContains.test(indexWord);var isFindBeginsMatch=matchOn._phraseWordBeginsContentWord===false?false:rFindWordBegins.test(indexWord);var isFullMatch=matchOn._contentWordEqualsPhraseWord==false?false:findWord==indexWord;var isPartMatch=isIndexBeginsMatch||isFindContainsMatch||isFindBeginsMatch;if(!isFullMatch&&!isPartMatch)continue;var partMatchRatio=1;if(isPartMatch&&!isFullMatch){if(findWord.length>indexWord.length)partMatchRatio=indexWord.length/findWord.length;else partMatchRatio=findWord.length/indexWord.length}updateIdScoreObjectsForWord(matchingIdScoreObjects,indexWord,isFullMatch,partMatchRatio)}}return _.values(matchingIdScoreObjects)}function updateIdScoreObjectsForWord(matchingIdScoreObjects,word,isFullMatch,partMatchRatio){for(var i=0,l=wordIndex[word].length;i<l;i++){var id=wordIndex[word][i];var model=_.findWhere(json,{_id:id});if(matchingIdScoreObjects[id]===undefined){matchingIdScoreObjects[id]={score:0,foundWords:{},foundPhrases:null,model:Adapt.findById(id)}}if(matchingIdScoreObjects[id].foundWords[word]===undefined)matchingIdScoreObjects[id].foundWords[word]=0;var allPhraseWordRatingObjects=_.where(model._searchProfile._words,{word:word});var wordFrequency=_.reduce(allPhraseWordRatingObjects,function(memo,item){return memo+item.count},0);var wordFrequencyHitScore=_.reduce(allPhraseWordRatingObjects,function(memo,item){var frequencyBonus=item.score*item.count/frequencyImportance;return memo+item.score+frequencyBonus},0);matchingIdScoreObjects[id].foundWords[word]+=wordFrequency;if(isFullMatch){matchingIdScoreObjects[id].score+=wordFrequencyHitScore}else{matchingIdScoreObjects[id].score+=wordFrequencyHitScore*partMatchRatio}}}function filterAndSortQualifyingMatches(matchingIdScoreObjects){var allowedScoreObjects=_.filter(matchingIdScoreObjects,function(item){return isModelSearchable(item.model)});var qualifyingScoreThreshold=1/scoreQualificationThreshold;var qualifyingMatches=_.filter(allowedScoreObjects,function(item){return item.score>=qualifyingScoreThreshold});qualifyingMatches=_.sortBy(qualifyingMatches,function(item){return 1/item.score});return qualifyingMatches}function isModelSearchable(model){var trail=model.getAncestorModels(true);var config=model.get("_search");if(config&&config._isEnabled===false)return false;if(model.get("_isLocked"))return false;var firstDisabledTrailItem=_.find(trail,function(item){var config=item.get("_search");if(item.get("_isLocked"))return true;if(config&&config._isEnabled===false)return true;return false});return firstDisabledTrailItem===undefined}function mapSearchPhrasesToMatchingWords(matchingIdScoreObjects){for(var i=0,l=matchingIdScoreObjects.length;i<l;i++){var matchingPhrases=[];var scoreObject=matchingIdScoreObjects[i];var foundWords=_.keys(scoreObject.foundWords);var modelPhrases=scoreObject.model.get("_searchProfile")._phrases;for(var p=0,lp=modelPhrases.length;p<lp;p++){var modelPhrase=modelPhrases[p];if(!modelPhrase.searchAttribute._allowTextPreview)continue;if(_.intersection(foundWords,_.keys(modelPhrase.words)).length>0){matchingPhrases.push(modelPhrase)}}scoreObject.foundPhrases=matchingPhrases}}var findWords=getFindPhraseWords(findPhrase);var matchingIdScoreObjects=getMatchingIdScoreObjects(findWords);mapSearchPhrasesToMatchingWords(matchingIdScoreObjects);var qualifyingMatchedScoreObjects=filterAndSortQualifyingMatches(matchingIdScoreObjects);return qualifyingMatchedScoreObjects}},Backbone.Events);search.initialize();window.search=search;return search});define("extensions/adapt-search/js/searchResultsView",["require","backbone","core/js/adapt","./search-algorithm"],function(require){var Backbone=require("backbone");var Adapt=require("core/js/adapt");var SearchAlgorithm=require("./search-algorithm");var replaceTagsRegEx=/\<{1}[^\>]+\>/g;var replaceEscapedTagsRegEx=/&lt;[^&gt;]+&gt;/g;var replaceEndTagsRegEx=/\<{1}\/{1}[^\>]+\>/g;var replaceEscapedEndTagsRegEx=/&lt;\/[^&gt;]+&gt;/g;var SearchResultsView=Backbone.View.extend({className:"search__items-container is-inactive",events:{"click [data-id]":"navigateToResultPage"},initialize:function initialize(options){this.listenTo(Adapt,{"drawer:empty":this.remove,"search:termsFiltered":this.updateResults});this.render();if(options.searchObject){this.updateResults(options.searchObject)}},render:function render(){var template=Handlebars.templates["searchResults"];$(this.el).html(template());return this},updateResults:function updateResults(searchObject){this.$el.removeClass("is-inactive");var formattedResults=this.formatResults(searchObject);this.renderResults(formattedResults)},formatResults:function formatResults(searchObject){var self=this;var resultsLimit=Math.min(5,searchObject.searchResults.length);var formattedResults=_.map(_.first(searchObject.searchResults,resultsLimit),function(result){return self.formatResult(result)});searchObject.formattedResults=formattedResults;return searchObject},formatResult:function formatResult(result,query){var foundWords=_.keys(result.foundWords).join(" ");var title=result.model.get("title");var displayTitle=result.model.get("displayTitle");var body=result.model.get("body");var previewWords=this.model.get("_previewWords");var previewCharacters=this.model.get("_previewCharacters");var wordCharacters=search._regularExpressions.wordCharacters;title=title.replace(SearchAlgorithm._regularExpressions.trimReplaceWhitespace,"");displayTitle=displayTitle.replace(SearchAlgorithm._regularExpressions.trimReplaceWhitespace,"");body=body.replace(SearchAlgorithm._regularExpressions.trimReplaceWhitespace,"");title=this.stripTags(title);displayTitle=this.stripTags(displayTitle);body=this.stripTags(body);var searchTitle="";var textPreview="";if(!title){searchTitle=$("<div>"+displayTitle+"</div>").text()||"No title found"}else{searchTitle=$("<div>"+title+"</div>").text()}if(result.foundPhrases.length>0){var finder;var phrase=result.foundPhrases[0].phrase;phrase=this.stripTags(phrase);var lowerPhrase=phrase.toLowerCase();var lowerSearchTitle=searchTitle.toLowerCase();if(lowerPhrase==lowerSearchTitle&&result.foundPhrases.length>1){phrase=result.foundPhrases[1].phrase;phrase=this.stripTags(phrase);lowerPhrase=phrase.toLowerCase()}if(lowerPhrase==lowerSearchTitle){finder=new RegExp("(([^"+wordCharacters+"]*["+wordCharacters+"]{1}){1,"+previewWords+"}|.{0,"+previewCharacters+"})","i");if(body){textPreview=body.match(finder)[0]+"..."}}else{var wordMap=_.map(result.foundWords,function(count,word){return{word:word,count:count}});_.sortBy(wordMap,function(item){return item.count});var wordIndex=0;var wordInPhraseStartPosition=lowerPhrase.indexOf(wordMap[wordIndex].word);while(wordInPhraseStartPosition==-1){wordIndex++;if(wordIndex==wordMap.length)throw"search: cannot find word in phrase";wordInPhraseStartPosition=lowerPhrase.indexOf(wordMap[wordIndex].word)}var regex=new RegExp("(([^"+wordCharacters+"]*["+wordCharacters+"]{1}){1,"+previewWords+"}|.{0,"+previewCharacters+"})"+SearchAlgorithm._regularExpressions.escapeRegExp(wordMap[wordIndex].word)+"((["+wordCharacters+"]{1}[^"+wordCharacters+"]*){1,"+previewWords+"}|.{0,"+previewCharacters+"})","i");var snippet=phrase.match(regex)[0];var snippetIndexInPhrase=phrase.indexOf(snippet);if(snippet.length==phrase.length){textPreview=snippet}else if(snippetIndexInPhrase===0){textPreview=snippet+"..."}else if(snippetIndexInPhrase+snippet.length==phrase.length){textPreview="..."+snippet}else{textPreview="..."+snippet+"..."}}}else{finder=new RegExp("(([^"+wordCharacters+"]*["+wordCharacters+"]{1}){1,"+previewWords+"}|.{0,"+previewCharacters+"})","i");if(body){textPreview=body.match(finder)[0]+"..."}}var searchTitleTagged=tag(result.foundWords,searchTitle);var textPreviewTagged=tag(result.foundWords,textPreview);return{searchTitleTagged:searchTitleTagged,searchTitle:searchTitle,foundWords:foundWords,textPreview:textPreview,textPreviewTagged:textPreviewTagged,id:result.model.get("_id")};function tag(words,text){var initial="";_.each(words,function(count,word){var wordPos=text.toLowerCase().indexOf(word);if(wordPos<0)return;initial+=text.slice(0,wordPos);var highlighted=text.slice(wordPos,wordPos+word.length);initial+="<span class='is-found'>"+highlighted+"</span>";text=text.slice(wordPos+word.length,text.length)});initial+=text;return initial}},stripTags:function stripTags(text){text=$("<span>"+text+"</span>").html();return text.replace(replaceEndTagsRegEx," ").replace(replaceTagsRegEx,"").replace(replaceEscapedEndTagsRegEx," ").replace(replaceEscapedTagsRegEx,"")},renderResults:function renderResults(results){var template=Handlebars.templates["searchResultsContent"];this.$(".search__items-container-inner").html(template(results))},navigateToResultPage:function navigateToResultPage(event){event&&event.preventDefault();var blockID=$(event.currentTarget).attr("data-id");Adapt.navigateToElement("."+blockID);Adapt.trigger("drawer:closeDrawer")}});return SearchResultsView});define("extensions/adapt-search/js/adapt-search",["core/js/adapt","./searchDrawerItemView","./searchResultsView","./search-algorithm"],function(Adapt,SearchDrawerItemView,SearchResultsView,SearchAlgorithm){var lastSearchQuery=null;var lastSearchObject=null;var isSearchShown=false;var searchConfigDefault={_previewWords:15,_previewCharacters:30,_showHighlights:true,_showFoundWords:true,title:"Search",description:"Type in search words",placeholder:"",noResultsMessage:"Sorry, no results were found",awaitingResultsMessage:"Formulating results..."};Adapt.on("search-algorithm:ready",function(){Adapt.course.set("_search",_.extend(searchConfigDefault,Adapt.course.get("_search")));var searchConfig=Adapt.course.get("_search");searchConfig.title=searchConfig.title||"Search";searchConfig.description=searchConfig.description||"Description";var drawerObject={title:searchConfig.title,description:searchConfig.description,className:"is-search",drawerOrder:searchConfig._drawerOrder||0};Adapt.drawer.addItem(drawerObject,"resources:showSearch")});Adapt.on("resources:showSearch",function(){if(isSearchShown)return;var searchConfig=Adapt.course.get("_search");searchConfig=new Backbone.Model(searchConfig);var template=Handlebars.templates["searchSingleItem"];var $element=$(template(searchConfig.toJSON()));Adapt.drawer.triggerCustomView($element,true);Adapt.trigger("search:draw")});Adapt.on("drawer:openedItemView search:draw",function(){isSearchShown=true;var searchConfig=Adapt.course.get("_search");searchConfig=new Backbone.Model(searchConfig);var $searchDrawerButton=$(".is-search");if($searchDrawerButton.is(":not(div)")){var $replacementButton=$("<div></div>");$replacementButton.attr("class",$searchDrawerButton.attr("class"));$searchDrawerButton.children().appendTo($replacementButton);$searchDrawerButton.replaceWith($replacementButton)}if(lastSearchObject&&lastSearchObject.searchResults&&lastSearchObject.searchResults.length===0){lastSearchObject=null;lastSearchQuery=null}$(".drawer__holder .is-search").append(new SearchDrawerItemView({model:searchConfig,query:lastSearchQuery}).el);$(".drawer__holder .is-search").append(new SearchResultsView({model:searchConfig,searchObject:lastSearchObject}).el)});Adapt.on("drawer:closed",function(){isSearchShown=false});Adapt.on("search:filterTerms",function(query){var searchConfig=Adapt.course.get("_search");var searchObject;lastSearchQuery=query;if(query.length===0){searchObject=_.extend({},searchConfig,{query:query,searchResults:[],isAwaitingResults:false,isBlank:true})}else if(query.length<searchConfig._minimumWordLength){searchObject=_.extend({},searchConfig,{query:query,searchResults:[],isAwaitingResults:true,isBlank:false})}else{var results=SearchAlgorithm.find(query);searchObject=_.extend({},searchConfig,{query:query,searchResults:results,isAwaitingResults:false,isBlank:false})}lastSearchObject=searchObject;Adapt.trigger("search:termsFiltered",searchObject)});Adapt.once("drawer:noItems",function(){$(".nav-drawer-btn").removeClass("u-display-none")})});define("extensions/adapt-submitAll/js/adapt-submitAll",["core/js/adapt"],function(Adapt){var SubmitAll=Backbone.View.extend({events:{"click .buttons-action":"onSubmitAllButtonClicked"},initialize:function initialize(){this.model.get("_articleView").$el.addClass("noSubmitButtons");this.listenTo(Adapt,{"componentView:postRender":this.onComponentViewRendered,remove:function remove(){this.removeEventListeners();this.remove()}});_.bindAll(this,"onInteraction","_onInteractionDelegate");this.render()},render:function render(){var submitButtonLabels=Adapt.course.get("_buttons")._submit;this.$el.html(Handlebars.templates.submitAll({buttonText:submitButtonLabels.buttonText,ariaLabel:submitButtonLabels.ariaLabel}));this.$el.addClass("submitAll");var $containerDiv=this.getContainerDiv(this.model.get("_articleView").$el,this.model.get("_insertAfterBlock"));$containerDiv.after(this.$el);return this},getContainerDiv:function getContainerDiv($article,blockId){if(blockId){var $div=$article.find("."+blockId);if($div.length>0)return $div}return $article.find(".block").last()},enableSubmitAllButton:function enableSubmitAllButton(enable){var $submitAllButton=this.$el.find(".buttons-action");if(enable){$submitAllButton.removeClass("disabled").attr("disabled",false);return}$submitAllButton.addClass("disabled").attr("disabled",true)},canSubmit:function canSubmit(){return this.model.get("_componentViews").every(function(component){if(component.model.get("_isEnabled")&&component.canSubmit()){return true}})},removeEventListeners:function removeEventListeners(){this.model.get("_componentViews").forEach(function(view){if(view.model.get("_component")==="textinput"){view.$el.find("input").off("change.submitAll");return}view.$el.off("click.submitAll")})},onComponentViewRendered:function onComponentViewRendered(view){if(!view.$el.hasClass("question-component"))return;var parentArticleId=view.model.findAncestor("articles").get("_id");var submitAllArticleId=this.model.get("_articleView").model.get("_id");if(parentArticleId===submitAllArticleId){this.model.get("_componentViews").push(view);if(view.model.get("_component")==="textinput"){view.$el.find("input").on("change.submitAll",this.onInteraction);return}view.$el.on("click.submitAll",this.onInteraction)}},onInteraction:function onInteraction(){_.defer(this._onInteractionDelegate)},_onInteractionDelegate:function _onInteractionDelegate(){if(!!this.model.get("_isSubmitted"))return;this.enableSubmitAllButton(this.canSubmit())},onSubmitAllButtonClicked:function onSubmitAllButtonClicked(){this.model.get("_componentViews").forEach(function(view){$(".buttons-action",view.$el).trigger("click")});this.enableSubmitAllButton(false);this.model.set("_isSubmitted",true);Adapt.trigger("submitAll:submitted",this.model.get("_componentViews"))}});Adapt.on("articleView:postRender",function(view){var saData=view.model.get("_submitAll");if(saData&&saData._isEnabled){var model=new Backbone.Model(saData);model.set({_articleView:view,_componentViews:[]});new SubmitAll({model:model})}})});define("core/js/views/menuItemView",["core/js/views/adaptView"],function(AdaptView){var MenuItemView=function(_AdaptView5){"use strict";_inherits(MenuItemView,_AdaptView5);var _super44=_createSuper(MenuItemView);function MenuItemView(){_classCallCheck(this,MenuItemView);return _super44.apply(this,arguments)}_createClass(MenuItemView,[{key:"attributes",value:function attributes(){return AdaptView.resultExtend("attributes",{"role":"listitem","aria-labelledby":this.model.get("_id")+"-heading"},this)}},{key:"className",value:function className(){return["menu-item",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isVisited")?"is-visited":"",this.model.get("_isComplete")?"is-complete":"",this.model.get("_isLocked")?"is-locked":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}},{key:"preRender",value:function preRender(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()}},{key:"postRender",value:function postRender(){this.$el.imageready(this.setReadyStatus.bind(this))}}]);return MenuItemView}(AdaptView);MenuItemView.type="menuItem";return MenuItemView});define("core/js/views/menuView",["core/js/views/contentObjectView","core/js/views/menuItemView"],function(ContentObjectView,MenuItemView){var MenuView=function(_ContentObjectView2){"use strict";_inherits(MenuView,_ContentObjectView2);var _super45=_createSuper(MenuView);function MenuView(){_classCallCheck(this,MenuView);return _super45.apply(this,arguments)}return MenuView}(ContentObjectView);Object.assign(MenuView,{childContainer:".js-children",childView:MenuItemView,type:"menu",template:"menu"});return MenuView});define("menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenuItemView",["core/js/views/menuItemView"],function(MenuItemView){var BoxMenuItemView=MenuItemView.extend({events:{"click .js-btn-click":"onClickMenuItemButton"},onClickMenuItemButton:function onClickMenuItemButton(event){if(event&&event.preventDefault)event.preventDefault();if(this.model.get("_isLocked"))return;Backbone.history.navigate("#/id/"+this.model.get("_id"),{trigger:true})}},{className:"boxmenu-item",template:"boxMenuItem"});return BoxMenuItemView});define("menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu",["core/js/adapt","core/js/views/menuView","./adapt-contrib-boxMenuItemView"],function(Adapt,MenuView,BoxMenuItemView){var BoxMenuView=MenuView.extend({initialize:function initialize(){MenuView.prototype.initialize.apply(this);this.setStyles();this.listenTo(Adapt,{"device:changed":this.onDeviceResize})},onDeviceResize:function onDeviceResize(){this.setStyles()},setStyles:function setStyles(){this.setBackgroundImage();this.setBackgroundStyles();this.processHeader()},setBackgroundImage:function setBackgroundImage(){var config=this.model.get("_boxMenu");var backgroundImages=config&&config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{this.$el.removeClass("has-bg-image").css("background-image","")}},setBackgroundStyles:function setBackgroundStyles(){var config=this.model.get("_boxMenu");var styles=config&&config._backgroundStyles;if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},processHeader:function processHeader(){var config=this.model.get("_boxMenu");var header=config&&config._menuHeader;if(!header)return;var $header=this.$(".menu__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)},setHeaderBackgroundImage:function setHeaderBackgroundImage(config,$header){var backgroundImages=config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{$header.removeClass("has-bg-image").css("background-image","")}},setHeaderBackgroundStyles:function setHeaderBackgroundStyles(config,$header){var styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setHeaderMinimumHeight:function setHeaderMinimumHeight(config,$header){var minimumHeights=config._minimumHeights;if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{$header.removeClass("has-min-height").css("min-height","")}}},{childView:BoxMenuItemView,className:"boxmenu",template:"boxMenu"});Adapt.on("router:menu",function(model){$("#wrapper").append(new BoxMenuView({model:model}).$el)})});define("theme/adapt-contrib-vanilla/js/themeView",["core/js/adapt"],function(Adapt){var ThemeView=Backbone.View.extend({className:function className(){},initialize:function initialize(){this.setStyles();this.listenTo(Adapt,{"device:changed":this.onDeviceResize,"remove":this.remove})},onDeviceResize:function onDeviceResize(){this.setStyles()},remove:function remove(){Backbone.View.prototype.remove.call(this);this.onRemove()},setStyles:function setStyles(){this.setClasses();this.setBackgroundImage();this.setBackgroundStyles();this.setMinimumHeight();this.setCustomStyles()},setClasses:function setClasses(){this.$el.addClass(this.className())},setBackgroundImage:function setBackgroundImage(){var backgroundImages=this.model.get("_backgroundImage");if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{this.$el.removeClass("has-bg-image").css("background-image","")}},setBackgroundStyles:function setBackgroundStyles(){var styles=this.model.get("_backgroundStyles");if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setMinimumHeight:function setMinimumHeight(){var minimumHeights=this.model.get("_minimumHeights");if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){this.$el.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{this.$el.removeClass("has-min-height").css("min-height","")}},setCustomStyles:function setCustomStyles(){},onRemove:function onRemove(){}});return ThemeView});define("theme/adapt-contrib-vanilla/js/themePageView",["./themeView","core/js/adapt"],function(ThemeView,Adapt){var ThemePageView=ThemeView.extend({className:function className(){},setCustomStyles:function setCustomStyles(){this.processHeader()},processHeader:function processHeader(){var header=this.model.get("_pageHeader");if(!header)return;var $header=this.$(".page__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)},setHeaderBackgroundImage:function setHeaderBackgroundImage(config,$header){var backgroundImages=config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{$header.removeClass("has-bg-image").css("background-image","")}},setHeaderBackgroundStyles:function setHeaderBackgroundStyles(config,$header){var styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setHeaderMinimumHeight:function setHeaderMinimumHeight(config,$header){var minimumHeights=config._minimumHeights;if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{$header.removeClass("has-min-height").css("min-height","")}},onRemove:function onRemove(){}});return ThemePageView});define("theme/adapt-contrib-vanilla/js/themeArticleView",["./themeView","core/js/adapt"],function(ThemeView,Adapt){var ThemeArticleView=ThemeView.extend({className:function className(){},setCustomStyles:function setCustomStyles(){},onRemove:function onRemove(){}});return ThemeArticleView});define("theme/adapt-contrib-vanilla/js/themeBlockView",["./themeView","core/js/adapt"],function(ThemeView,Adapt){var ThemeBlockView=ThemeView.extend({className:function className(){return this.model.get("_isDividerBlock")?"is-divider-block":""},setCustomStyles:function setCustomStyles(){},onRemove:function onRemove(){}});return ThemeBlockView});define("theme/adapt-contrib-vanilla/js/theme",["core/js/adapt","./themePageView","./themeArticleView","./themeBlockView","./themeView"],function(Adapt,ThemePageView,ThemeArticleView,ThemeBlockView,ThemeView){function onDataReady(){$("html").addClass(Adapt.course.get("_courseStyle"))}function onPostRender(view){var model=view.model;var theme=model.get("_vanilla");if(!theme)return;switch(model.get("_type")){case"page":new ThemePageView({model:new Backbone.Model(theme),el:view.$el});break;case"article":new ThemeArticleView({model:new Backbone.Model(theme),el:view.$el});break;case"block":new ThemeBlockView({model:new Backbone.Model(theme),el:view.$el});break;default:new ThemeView({model:new Backbone.Model(theme),el:view.$el});}}Adapt.on({"app:dataReady":onDataReady,"pageView:postRender articleView:postRender blockView:postRender":onPostRender})});;define("plugins",["components/adapt-cmcq/js/adapt-cmcq","components/adapt-contrib-accordion/js/adapt-contrib-accordion","components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults","components/adapt-contrib-blank/js/adapt-contrib-blank","components/adapt-contrib-gmcq/js/adapt-contrib-gmcq","components/adapt-contrib-graphic/js/adapt-contrib-graphic","components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic","components/adapt-contrib-matching/js/adapt-contrib-matching","components/adapt-contrib-mcq/js/adapt-contrib-mcq","components/adapt-contrib-media/js/adapt-contrib-media","components/adapt-contrib-narrative/js/adapt-contrib-narrative","components/adapt-contrib-slider/js/adapt-contrib-slider","components/adapt-contrib-text/js/adapt-contrib-text","components/adapt-contrib-textInput/js/adapt-contrib-textInput","components/adapt-expose/js/adapt-expose","components/adapt-narrativeCode/js/adapt-narrativeCode","components/adapt-textWithCode/js/adapt-textWithCode","extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension","extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking","extensions/adapt-contrib-languagePicker/js/adapt-languagePicker","extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress","extensions/adapt-contrib-resources/js/adapt-contrib-resources","extensions/adapt-contrib-spoor/js/adapt-contrib-spoor","extensions/adapt-contrib-trickle/js/adapt-contrib-trickle","extensions/adapt-contrib-tutor/js/adapt-contrib-tutor","extensions/adapt-favicons-master/js/adapt-favicons","extensions/adapt-goTop/js/adapt-goTop","extensions/adapt-intro/js/adapt-intro","extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt","extensions/adapt-search/js/adapt-search","extensions/adapt-submitAll/js/adapt-submitAll","menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu","theme/adapt-contrib-vanilla/js/theme"],function(){});require(["core/js/adapt","core/js/templates","core/js/fixes","core/js/accessibility","core/js/data","core/js/offlineStorage","core/js/logging","core/js/tracking","core/js/device","core/js/drawer","core/js/notify","core/js/router","core/js/models/lockingModel","core/js/mpabc","core/js/helpers","core/js/scrolling","core/js/headings","core/js/navigation","plugins"],function(Adapt){$("body").append(Handlebars.templates.loading());Adapt.data.on("ready",function triggerInit(){Adapt.log.debug("Calling Adapt.init");Adapt.init();Adapt.off("adaptCollection:dataLoaded courseModel:dataLoaded")}).init()});define("core/js/app",function(){});
